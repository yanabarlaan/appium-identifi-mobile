'use strict';

require("source-map-support/register");

const path = require('path');

const log = require('fancy-log');

const _ = require('lodash');

const {
  exec
} = require('../utils');

const B = require('bluebird');

const fs = require('fs');

const rimraf = B.promisify(require('rimraf'));
const renameFile = B.promisify(fs.rename, {
  context: fs
});
const MAX_BUFFER_SIZE = 524288;
const REAL_DEVICE_FLAGS = ['IOS_REAL_DEVICE', 'REAL_DEVICE'];

function configure(gulp, opts) {
  if (_.isEmpty(opts.iosApps)) {
    return;
  }

  const relativeLocations = opts.iosApps.relativeLocations;
  const SDKS = {
    iphonesimulator: {
      name: 'iphonesimulator',
      buildPath: path.resolve('build', 'Release-iphonesimulator', opts.iosApps.appName),
      finalPath: relativeLocations.iphonesimulator
    },
    iphoneos: {
      name: 'iphoneos',
      buildPath: path.resolve('build', 'Release-iphoneos', opts.iosApps.appName),
      finalPath: relativeLocations.iphoneos
    }
  };
  let sdks = ['iphonesimulator'];
  let sdkVer;

  async function getIOSSDK() {
    if (!sdkVer) {
      try {
        const {
          stdout
        } = await exec('xcrun', ['--sdk', 'iphonesimulator', '--show-sdk-version']);
        sdkVer = stdout.trim();
      } catch (err) {
        log(`Unable to get max iOS SDK: ${err.message}`);
        throw err;
      }
    }

    return sdkVer;
  }

  function logErrorLines(str = '') {
    str = `${str}`;

    for (const line of str.split('\n')) {
      log.error(`    ${line}`);
    }
  }

  function logError(err, prefix = 'Failed:') {
    log.error(`${prefix}: ${err.message}`);
    log.error('Stdout:');
    logErrorLines(err.stdout);
    log.error('Stderr:');
    logErrorLines(err.stderr);
  }

  async function cleanApp(appRoot, sdk) {
    log(`Cleaning app for ${sdk} at app root '${appRoot}'`);

    try {
      const cmd = 'xcodebuild';
      const args = ['-sdk', sdk, 'clean'];
      log(`    Executing command '${cmd} ${args.join(' ')}'`);
      await exec(cmd, args, {
        cwd: appRoot,
        maxBuffer: MAX_BUFFER_SIZE
      });
    } catch (err) {
      logError(err, 'Failed cleaning app');
      throw err;
    }
  }

  gulp.task('ios-apps:sdks', function findSDKs(done) {
    for (const flag of REAL_DEVICE_FLAGS) {
      const value = process.env[flag];

      if (!_.isEmpty(value) && !!parseInt(value, 10)) {
        log(`Enabling real device build because '${flag}' environment variable set (value is '${value}')`);
        sdks.push('iphoneos');
      }
    }

    log(`SDKs to process: ${sdks.map(sdk => `'${sdk}'`).join(', ')}`);
    done();
  });
  gulp.task('ios-apps:clean', async function cleanAll() {
    log('Cleaning all sdks');
    const sdkVer = await getIOSSDK();

    for (const sdk of sdks) {
      await cleanApp('.', sdk + sdkVer);
    }

    log('Deleting all apps');
    const apps = [SDKS.iphonesimulator.buildPath, SDKS.iphonesimulator.finalPath, SDKS.iphoneos.buildPath, SDKS.iphoneos.finalPath];

    for (const app of apps) {
      log(`    Deleting app '${app}'`);
      await rimraf(app);
    }
  });

  async function buildApp(appRoot, sdk) {
    log(`Building app for ${sdk} at app root '${appRoot}'`);

    try {
      const cmd = 'xcodebuild';
      let args = ['-sdk', sdk];

      if (process.env.XCCONFIG_FILE) {
        args.push('-xcconfig', process.env.XCCONFIG_FILE);
      }

      log(`    Executing command '${cmd} ${args.join(' ')}'`);
      await exec(cmd, args, {
        cwd: appRoot,
        maxBuffer: MAX_BUFFER_SIZE
      });
    } catch (err) {
      logError(err, 'Failed building app');
      throw err;
    }
  }

  gulp.task('ios-apps:build', async function buildAll() {
    log('Building all apps');
    const sdkVer = await getIOSSDK();

    for (const sdk of sdks) {
      await buildApp('.', sdk + sdkVer);
    }
  });
  gulp.task('ios-apps:rename', async function iosAppsRename() {
    log('Renaming apps');

    for (const sdk of sdks) {
      log(`    Renaming for ${sdk}`);
      log(`        '${SDKS[sdk].buildPath}' => '${SDKS[sdk].finalPath}'`);
      await renameFile(SDKS[sdk].buildPath, SDKS[sdk].finalPath);
    }
  });
  gulp.task('ios-apps:install', gulp.series('ios-apps:sdks', 'ios-apps:clean', 'ios-apps:build', 'ios-apps:rename'));
}

module.exports = {
  configure
};require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGliL3Rhc2tzL2lvcy1hcHBzLmpzIiwibmFtZXMiOlsicGF0aCIsInJlcXVpcmUiLCJsb2ciLCJfIiwiZXhlYyIsIkIiLCJmcyIsInJpbXJhZiIsInByb21pc2lmeSIsInJlbmFtZUZpbGUiLCJyZW5hbWUiLCJjb250ZXh0IiwiTUFYX0JVRkZFUl9TSVpFIiwiUkVBTF9ERVZJQ0VfRkxBR1MiLCJjb25maWd1cmUiLCJndWxwIiwib3B0cyIsImlzRW1wdHkiLCJpb3NBcHBzIiwicmVsYXRpdmVMb2NhdGlvbnMiLCJTREtTIiwiaXBob25lc2ltdWxhdG9yIiwibmFtZSIsImJ1aWxkUGF0aCIsInJlc29sdmUiLCJhcHBOYW1lIiwiZmluYWxQYXRoIiwiaXBob25lb3MiLCJzZGtzIiwic2RrVmVyIiwiZ2V0SU9TU0RLIiwic3Rkb3V0IiwidHJpbSIsImVyciIsIm1lc3NhZ2UiLCJsb2dFcnJvckxpbmVzIiwic3RyIiwibGluZSIsInNwbGl0IiwiZXJyb3IiLCJsb2dFcnJvciIsInByZWZpeCIsInN0ZGVyciIsImNsZWFuQXBwIiwiYXBwUm9vdCIsInNkayIsImNtZCIsImFyZ3MiLCJqb2luIiwiY3dkIiwibWF4QnVmZmVyIiwidGFzayIsImZpbmRTREtzIiwiZG9uZSIsImZsYWciLCJ2YWx1ZSIsInByb2Nlc3MiLCJlbnYiLCJwYXJzZUludCIsInB1c2giLCJtYXAiLCJjbGVhbkFsbCIsImFwcHMiLCJhcHAiLCJidWlsZEFwcCIsIlhDQ09ORklHX0ZJTEUiLCJidWlsZEFsbCIsImlvc0FwcHNSZW5hbWUiLCJzZXJpZXMiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIuLi8uLi8uLiIsInNvdXJjZXMiOlsibGliL3Rhc2tzL2lvcy1hcHBzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcbmNvbnN0IGxvZyA9IHJlcXVpcmUoJ2ZhbmN5LWxvZycpO1xuY29uc3QgXyA9IHJlcXVpcmUoJ2xvZGFzaCcpO1xuY29uc3QgeyBleGVjIH0gPSByZXF1aXJlKCcuLi91dGlscycpO1xuY29uc3QgQiA9IHJlcXVpcmUoJ2JsdWViaXJkJyk7XG5jb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5jb25zdCByaW1yYWYgPSBCLnByb21pc2lmeShyZXF1aXJlKCdyaW1yYWYnKSk7XG5cblxuY29uc3QgcmVuYW1lRmlsZSA9IEIucHJvbWlzaWZ5KGZzLnJlbmFtZSwge2NvbnRleHQ6IGZzfSk7XG5cbmNvbnN0IE1BWF9CVUZGRVJfU0laRSA9IDUyNDI4ODtcblxuY29uc3QgUkVBTF9ERVZJQ0VfRkxBR1MgPSBbJ0lPU19SRUFMX0RFVklDRScsICdSRUFMX0RFVklDRSddO1xuXG5mdW5jdGlvbiBjb25maWd1cmUgKGd1bHAsIG9wdHMpIHtcbiAgaWYgKF8uaXNFbXB0eShvcHRzLmlvc0FwcHMpKSB7XG4gICAgLy8gbm90aGluZyB0byBkb1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIGV4dHJhY3QgdGhlIHBhdGhzIGZyb20gdGhlIGVuY2xvc2luZyBwYWNrYWdlIGNvbmZpZ3VyYXRpb25cbiAgY29uc3QgcmVsYXRpdmVMb2NhdGlvbnMgPSBvcHRzLmlvc0FwcHMucmVsYXRpdmVMb2NhdGlvbnM7XG5cbiAgLy8gZmlndXJlIG91dCB3aGVyZSB0aGluZ3Mgd2lsbCBnbyBpbiB0aGUgZW5kXG4gIGNvbnN0IFNES1MgPSB7XG4gICAgaXBob25lc2ltdWxhdG9yOiB7XG4gICAgICBuYW1lOiAnaXBob25lc2ltdWxhdG9yJyxcbiAgICAgIGJ1aWxkUGF0aDogcGF0aC5yZXNvbHZlKCdidWlsZCcsICdSZWxlYXNlLWlwaG9uZXNpbXVsYXRvcicsIG9wdHMuaW9zQXBwcy5hcHBOYW1lKSxcbiAgICAgIGZpbmFsUGF0aDogcmVsYXRpdmVMb2NhdGlvbnMuaXBob25lc2ltdWxhdG9yXG4gICAgfSxcbiAgICBpcGhvbmVvczoge1xuICAgICAgbmFtZTogJ2lwaG9uZW9zJyxcbiAgICAgIGJ1aWxkUGF0aDogcGF0aC5yZXNvbHZlKCdidWlsZCcsICdSZWxlYXNlLWlwaG9uZW9zJywgb3B0cy5pb3NBcHBzLmFwcE5hbWUpLFxuICAgICAgZmluYWxQYXRoOiByZWxhdGl2ZUxvY2F0aW9ucy5pcGhvbmVvc1xuICAgIH1cbiAgfTtcblxuICAvLyB0aGUgc2RrcyBhZ2FpbnN0IHdoaWNoIHdlIHdpbGwgYnVpbGRcbiAgbGV0IHNka3MgPSBbJ2lwaG9uZXNpbXVsYXRvciddO1xuXG4gIGxldCBzZGtWZXI7XG4gIGFzeW5jIGZ1bmN0aW9uIGdldElPU1NESyAoKSB7XG4gICAgaWYgKCFzZGtWZXIpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHtzdGRvdXR9ID0gYXdhaXQgZXhlYygneGNydW4nLCBbJy0tc2RrJywgJ2lwaG9uZXNpbXVsYXRvcicsICctLXNob3ctc2RrLXZlcnNpb24nXSk7XG4gICAgICAgIHNka1ZlciA9IHN0ZG91dC50cmltKCk7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgcmVxdWlyZS1hdG9taWMtdXBkYXRlc1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGxvZyhgVW5hYmxlIHRvIGdldCBtYXggaU9TIFNESzogJHtlcnIubWVzc2FnZX1gKTtcbiAgICAgICAgdGhyb3cgZXJyO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gc2RrVmVyO1xuICB9XG5cbiAgZnVuY3Rpb24gbG9nRXJyb3JMaW5lcyAoc3RyID0gJycpIHtcbiAgICBzdHIgPSBgJHtzdHJ9YDtcbiAgICBmb3IgKGNvbnN0IGxpbmUgb2Ygc3RyLnNwbGl0KCdcXG4nKSkge1xuICAgICAgbG9nLmVycm9yKGAgICAgJHtsaW5lfWApO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGxvZ0Vycm9yIChlcnIsIHByZWZpeCA9ICdGYWlsZWQ6Jykge1xuICAgIGxvZy5lcnJvcihgJHtwcmVmaXh9OiAke2Vyci5tZXNzYWdlfWApO1xuICAgIGxvZy5lcnJvcignU3Rkb3V0OicpO1xuICAgIGxvZ0Vycm9yTGluZXMoZXJyLnN0ZG91dCk7XG4gICAgbG9nLmVycm9yKCdTdGRlcnI6Jyk7XG4gICAgbG9nRXJyb3JMaW5lcyhlcnIuc3RkZXJyKTtcbiAgfVxuXG4gIGFzeW5jIGZ1bmN0aW9uIGNsZWFuQXBwIChhcHBSb290LCBzZGspIHtcbiAgICBsb2coYENsZWFuaW5nIGFwcCBmb3IgJHtzZGt9IGF0IGFwcCByb290ICcke2FwcFJvb3R9J2ApO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjbWQgPSAneGNvZGVidWlsZCc7XG4gICAgICBjb25zdCBhcmdzID0gWyctc2RrJywgc2RrLCAnY2xlYW4nXTtcbiAgICAgIGxvZyhgICAgIEV4ZWN1dGluZyBjb21tYW5kICcke2NtZH0gJHthcmdzLmpvaW4oJyAnKX0nYCk7XG4gICAgICBhd2FpdCBleGVjKGNtZCwgYXJncywge2N3ZDogYXBwUm9vdCwgbWF4QnVmZmVyOiBNQVhfQlVGRkVSX1NJWkV9KTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGxvZ0Vycm9yKGVyciwgJ0ZhaWxlZCBjbGVhbmluZyBhcHAnKTtcbiAgICAgIHRocm93IGVycjtcbiAgICB9XG4gIH1cblxuICBndWxwLnRhc2soJ2lvcy1hcHBzOnNka3MnLCBmdW5jdGlvbiBmaW5kU0RLcyAoZG9uZSkge1xuICAgIC8vIGRldGVybWluZSBpZiB0aGUgcmVhbCBkZXZpY2Ugc2RrIHNob3VsZCBiZSB1c2VkLCB0b29cbiAgICBmb3IgKGNvbnN0IGZsYWcgb2YgUkVBTF9ERVZJQ0VfRkxBR1MpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gcHJvY2Vzcy5lbnZbZmxhZ107XG4gICAgICBpZiAoIV8uaXNFbXB0eSh2YWx1ZSkgJiYgISFwYXJzZUludCh2YWx1ZSwgMTApKSB7XG4gICAgICAgIGxvZyhgRW5hYmxpbmcgcmVhbCBkZXZpY2UgYnVpbGQgYmVjYXVzZSAnJHtmbGFnfScgZW52aXJvbm1lbnQgdmFyaWFibGUgc2V0ICh2YWx1ZSBpcyAnJHt2YWx1ZX0nKWApO1xuICAgICAgICBzZGtzLnB1c2goJ2lwaG9uZW9zJyk7XG4gICAgICB9XG4gICAgfVxuICAgIGxvZyhgU0RLcyB0byBwcm9jZXNzOiAke3Nka3MubWFwKChzZGspID0+IGAnJHtzZGt9J2ApLmpvaW4oJywgJyl9YCk7XG4gICAgZG9uZSgpO1xuICB9KTtcblxuICBndWxwLnRhc2soJ2lvcy1hcHBzOmNsZWFuJywgYXN5bmMgZnVuY3Rpb24gY2xlYW5BbGwgKCkge1xuICAgIGxvZygnQ2xlYW5pbmcgYWxsIHNka3MnKTtcbiAgICBjb25zdCBzZGtWZXIgPSBhd2FpdCBnZXRJT1NTREsoKTtcbiAgICBmb3IgKGNvbnN0IHNkayBvZiBzZGtzKSB7XG4gICAgICBhd2FpdCBjbGVhbkFwcCgnLicsIHNkayArIHNka1Zlcik7XG4gICAgfVxuXG4gICAgbG9nKCdEZWxldGluZyBhbGwgYXBwcycpO1xuICAgIGNvbnN0IGFwcHMgPSBbXG4gICAgICBTREtTLmlwaG9uZXNpbXVsYXRvci5idWlsZFBhdGgsXG4gICAgICBTREtTLmlwaG9uZXNpbXVsYXRvci5maW5hbFBhdGgsXG4gICAgICBTREtTLmlwaG9uZW9zLmJ1aWxkUGF0aCxcbiAgICAgIFNES1MuaXBob25lb3MuZmluYWxQYXRoLFxuICAgIF07XG4gICAgZm9yIChjb25zdCBhcHAgb2YgYXBwcykge1xuICAgICAgbG9nKGAgICAgRGVsZXRpbmcgYXBwICcke2FwcH0nYCk7XG4gICAgICBhd2FpdCByaW1yYWYoYXBwKTtcbiAgICB9XG4gIH0pO1xuXG4gIGFzeW5jIGZ1bmN0aW9uIGJ1aWxkQXBwIChhcHBSb290LCBzZGspIHtcbiAgICBsb2coYEJ1aWxkaW5nIGFwcCBmb3IgJHtzZGt9IGF0IGFwcCByb290ICcke2FwcFJvb3R9J2ApO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjbWQgPSAneGNvZGVidWlsZCc7XG4gICAgICBsZXQgYXJncyA9IFsnLXNkaycsIHNka107XG4gICAgICBpZiAocHJvY2Vzcy5lbnYuWENDT05GSUdfRklMRSkge1xuICAgICAgICBhcmdzLnB1c2goJy14Y2NvbmZpZycsIHByb2Nlc3MuZW52LlhDQ09ORklHX0ZJTEUpO1xuICAgICAgfVxuXG4gICAgICBsb2coYCAgICBFeGVjdXRpbmcgY29tbWFuZCAnJHtjbWR9ICR7YXJncy5qb2luKCcgJyl9J2ApO1xuICAgICAgYXdhaXQgZXhlYyhjbWQsIGFyZ3MsIHtjd2Q6IGFwcFJvb3QsIG1heEJ1ZmZlcjogTUFYX0JVRkZFUl9TSVpFfSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBsb2dFcnJvcihlcnIsICdGYWlsZWQgYnVpbGRpbmcgYXBwJyk7XG4gICAgICB0aHJvdyBlcnI7XG4gICAgfVxuICB9XG5cbiAgZ3VscC50YXNrKCdpb3MtYXBwczpidWlsZCcsIGFzeW5jIGZ1bmN0aW9uIGJ1aWxkQWxsICgpIHtcbiAgICBsb2coJ0J1aWxkaW5nIGFsbCBhcHBzJyk7XG4gICAgY29uc3Qgc2RrVmVyID0gYXdhaXQgZ2V0SU9TU0RLKCk7XG4gICAgZm9yIChjb25zdCBzZGsgb2Ygc2Rrcykge1xuICAgICAgYXdhaXQgYnVpbGRBcHAoJy4nLCBzZGsgKyBzZGtWZXIpO1xuICAgIH1cbiAgfSk7XG5cbiAgZ3VscC50YXNrKCdpb3MtYXBwczpyZW5hbWUnLCBhc3luYyBmdW5jdGlvbiBpb3NBcHBzUmVuYW1lICgpIHtcbiAgICBsb2coJ1JlbmFtaW5nIGFwcHMnKTtcbiAgICBmb3IgKGNvbnN0IHNkayBvZiBzZGtzKSB7XG4gICAgICBsb2coYCAgICBSZW5hbWluZyBmb3IgJHtzZGt9YCk7XG4gICAgICBsb2coYCAgICAgICAgJyR7U0RLU1tzZGtdLmJ1aWxkUGF0aH0nID0+ICcke1NES1Nbc2RrXS5maW5hbFBhdGh9J2ApO1xuICAgICAgYXdhaXQgcmVuYW1lRmlsZShTREtTW3Nka10uYnVpbGRQYXRoLCBTREtTW3Nka10uZmluYWxQYXRoKTtcbiAgICB9XG4gIH0pO1xuXG4gIGd1bHAudGFzaygnaW9zLWFwcHM6aW5zdGFsbCcsIGd1bHAuc2VyaWVzKCdpb3MtYXBwczpzZGtzJywgJ2lvcy1hcHBzOmNsZWFuJywgJ2lvcy1hcHBzOmJ1aWxkJywgJ2lvcy1hcHBzOnJlbmFtZScpKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGNvbmZpZ3VyZSxcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBOzs7O0FBRUEsTUFBTUEsSUFBSSxHQUFHQyxPQUFPLENBQUMsTUFBRCxDQUFwQjs7QUFDQSxNQUFNQyxHQUFHLEdBQUdELE9BQU8sQ0FBQyxXQUFELENBQW5COztBQUNBLE1BQU1FLENBQUMsR0FBR0YsT0FBTyxDQUFDLFFBQUQsQ0FBakI7O0FBQ0EsTUFBTTtFQUFFRztBQUFGLElBQVdILE9BQU8sQ0FBQyxVQUFELENBQXhCOztBQUNBLE1BQU1JLENBQUMsR0FBR0osT0FBTyxDQUFDLFVBQUQsQ0FBakI7O0FBQ0EsTUFBTUssRUFBRSxHQUFHTCxPQUFPLENBQUMsSUFBRCxDQUFsQjs7QUFDQSxNQUFNTSxNQUFNLEdBQUdGLENBQUMsQ0FBQ0csU0FBRixDQUFZUCxPQUFPLENBQUMsUUFBRCxDQUFuQixDQUFmO0FBR0EsTUFBTVEsVUFBVSxHQUFHSixDQUFDLENBQUNHLFNBQUYsQ0FBWUYsRUFBRSxDQUFDSSxNQUFmLEVBQXVCO0VBQUNDLE9BQU8sRUFBRUw7QUFBVixDQUF2QixDQUFuQjtBQUVBLE1BQU1NLGVBQWUsR0FBRyxNQUF4QjtBQUVBLE1BQU1DLGlCQUFpQixHQUFHLENBQUMsaUJBQUQsRUFBb0IsYUFBcEIsQ0FBMUI7O0FBRUEsU0FBU0MsU0FBVCxDQUFvQkMsSUFBcEIsRUFBMEJDLElBQTFCLEVBQWdDO0VBQzlCLElBQUliLENBQUMsQ0FBQ2MsT0FBRixDQUFVRCxJQUFJLENBQUNFLE9BQWYsQ0FBSixFQUE2QjtJQUUzQjtFQUNEOztFQUdELE1BQU1DLGlCQUFpQixHQUFHSCxJQUFJLENBQUNFLE9BQUwsQ0FBYUMsaUJBQXZDO0VBR0EsTUFBTUMsSUFBSSxHQUFHO0lBQ1hDLGVBQWUsRUFBRTtNQUNmQyxJQUFJLEVBQUUsaUJBRFM7TUFFZkMsU0FBUyxFQUFFdkIsSUFBSSxDQUFDd0IsT0FBTCxDQUFhLE9B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
