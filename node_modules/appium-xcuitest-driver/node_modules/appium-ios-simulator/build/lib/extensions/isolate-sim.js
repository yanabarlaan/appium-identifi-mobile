"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.extensions = void 0;
exports.getAllUdids = getAllUdids;

require("source-map-support/register");

var _nodeSimctl = _interopRequireDefault(require("node-simctl"));

var _logger = _interopRequireDefault(require("../logger"));

var _lodash = _interopRequireDefault(require("lodash"));

let extensions = {};
exports.extensions = extensions;

async function getAllUdids(simctl) {
  let devices = await simctl.getDevices();
  return _lodash.default.chain(devices).values().flatten().map('udid').value();
}

extensions.isolateSim = async function isolateSim() {
  _logger.default.debug('Isolating the requested simulator by deleting all others');

  const simctl = new _nodeSimctl.default();
  const udids = await getAllUdids(simctl);

  for (const udid of _lodash.default.without(udids, this.udid)) {
    simctl.udid = udid;
    await simctl.deleteDevice();
  }
};require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGliL2V4dGVuc2lvbnMvaXNvbGF0ZS1zaW0uanMiLCJuYW1lcyI6WyJleHRlbnNpb25zIiwiZ2V0QWxsVWRpZHMiLCJzaW1jdGwiLCJkZXZpY2VzIiwiZ2V0RGV2aWNlcyIsIl8iLCJjaGFpbiIsInZhbHVlcyIsImZsYXR0ZW4iLCJtYXAiLCJ2YWx1ZSIsImlzb2xhdGVTaW0iLCJsb2ciLCJkZWJ1ZyIsIlNpbWN0bCIsInVkaWRzIiwidWRpZCIsIndpdGhvdXQiLCJkZWxldGVEZXZpY2UiXSwic291cmNlUm9vdCI6Ii4uLy4uLy4uIiwic291cmNlcyI6WyJsaWIvZXh0ZW5zaW9ucy9pc29sYXRlLXNpbS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgU2ltY3RsIGZyb20gJ25vZGUtc2ltY3RsJztcbmltcG9ydCBsb2cgZnJvbSAnLi4vbG9nZ2VyJztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5cblxubGV0IGV4dGVuc2lvbnMgPSB7fTtcblxuYXN5bmMgZnVuY3Rpb24gZ2V0QWxsVWRpZHMgKHNpbWN0bCkge1xuICBsZXQgZGV2aWNlcyA9IGF3YWl0IHNpbWN0bC5nZXREZXZpY2VzKCk7XG5cbiAgcmV0dXJuIF8uY2hhaW4oZGV2aWNlcylcbiAgICAudmFsdWVzKClcbiAgICAuZmxhdHRlbigpXG4gICAgLm1hcCgndWRpZCcpXG4gICAgLnZhbHVlKCk7XG59XG5cbmV4dGVuc2lvbnMuaXNvbGF0ZVNpbSA9IGFzeW5jIGZ1bmN0aW9uIGlzb2xhdGVTaW0gKCkge1xuICBsb2cuZGVidWcoJ0lzb2xhdGluZyB0aGUgcmVxdWVzdGVkIHNpbXVsYXRvciBieSBkZWxldGluZyBhbGwgb3RoZXJzJyk7XG4gIGNvbnN0IHNpbWN0bCA9IG5ldyBTaW1jdGwoKTtcbiAgY29uc3QgdWRpZHMgPSBhd2FpdCBnZXRBbGxVZGlkcyhzaW1jdGwpO1xuXG4gIGZvciAoY29uc3QgdWRpZCBvZiBfLndpdGhvdXQodWRpZHMsIHRoaXMudWRpZCkpIHtcbiAgICBzaW1jdGwudWRpZCA9IHVkaWQ7XG4gICAgYXdhaXQgc2ltY3RsLmRlbGV0ZURldmljZSgpO1xuICB9XG59O1xuXG5cbmV4cG9ydCB7IGV4dGVuc2lvbnMsIGdldEFsbFVkaWRzIH07XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUdBLElBQUlBLFVBQVUsR0FBRyxFQUFqQjs7O0FBRUEsZUFBZUMsV0FBZixDQUE0QkMsTUFBNUIsRUFBb0M7RUFDbEMsSUFBSUMsT0FBTyxHQUFHLE1BQU1ELE1BQU0sQ0FBQ0UsVUFBUCxFQUFwQjtFQUVBLE9BQU9DLGVBQUEsQ0FBRUMsS0FBRixDQUFRSCxPQUFSLEVBQ0pJLE1BREksR0FFSkMsT0FGSSxHQUdKQyxHQUhJLENBR0EsTUFIQSxFQUlKQyxLQUpJLEVBQVA7QUFLRDs7QUFFRFYsVUFBVSxDQUFDVyxVQUFYLEdBQXdCLGVBQWVBLFVBQWYsR0FBNkI7RUFDbkRDLGVBQUEsQ0FBSUMsS0FBSixDQUFVLDBEQUFWOztFQUNBLE1BQU1YLE1BQU0sR0FBRyxJQUFJWSxtQkFBSixFQUFmO0VBQ0EsTUFBTUMsS0FBSyxHQUFHLE1BQU1kLFdBQVcsQ0FBQ0MsTUFBRCxDQUEvQjs7RUFFQSxLQUFLLE1BQU1jLElBQVgsSUFBbUJYLGVBQUEsQ0FBRVksT0FBRixDQUFVRixLQUFWLEVBQWlCLEtBQUtDLElBQXRCLENBQW5CLEVBQWdEO0lBQzlDZCxNQUFNLENBQUNjLElBQVAsR0FBY0EsSUFBZDtJQUNBLE1BQU1kLE1BQU0sQ0FBQ2dCLFlBQVAsRUFBTjtFQUNEO0FBQ0YsQ0FURCJ9
