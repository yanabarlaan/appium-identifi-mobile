"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("source-map-support/register");

var _simulatorXcode = _interopRequireDefault(require("./simulator-xcode-8"));

var _lodash = _interopRequireDefault(require("lodash"));

var _path = _interopRequireDefault(require("path"));

var _support = require("@appium/support");

var _asyncLock = _interopRequireDefault(require("async-lock"));

var _logger = _interopRequireDefault(require("./logger"));

var _asyncbox = require("asyncbox");

var _utils = require("./utils.js");

var _defaultsUtils = require("./defaults-utils");

var _bluebird = _interopRequireDefault(require("bluebird"));

var _events = require("events");

var _appiumXcode = require("appium-xcode");

var _teen_process = require("teen_process");

const SIMULATOR_SHUTDOWN_TIMEOUT = 15 * 1000;
const startupLock = new _asyncLock.default();
const preferencesPlistGuard = new _asyncLock.default();
const ENROLLMENT_NOTIFICATION_RECEIVER = 'com.apple.BiometricKit.enrollmentChanged';
const DOMAIN_KEYBOARD_PREFERENCES = 'com.apple.keyboard.preferences';

function compileSimulatorPreferences(opts = {}) {
  const {
    connectHardwareKeyboard,
    tracePointer,
    pasteboardAutomaticSync,
    scaleFactor
  } = opts;
  const commonPreferences = {
    RotateWindowWhenSignaledByGuest: true,
    StartLastDeviceOnLaunch: false,
    DetachOnWindowClose: false,
    AttachBootedOnStart: true
  };
  const devicePreferences = opts.devicePreferences ? _lodash.default.cloneDeep(opts.devicePreferences) : {};

  if (scaleFactor) {
    devicePreferences.SimulatorWindowLastScale = parseFloat(scaleFactor);
  }

  if (_lodash.default.isBoolean(connectHardwareKeyboard) || _lodash.default.isNil(connectHardwareKeyboard)) {
    devicePreferences.ConnectHardwareKeyboard = connectHardwareKeyboard !== null && connectHardwareKeyboard !== void 0 ? connectHardwareKeyboard : false;
    commonPreferences.ConnectHardwareKeyboard = connectHardwareKeyboard !== null && connectHardwareKeyboard !== void 0 ? connectHardwareKeyboard : false;
  }

  if (_lodash.default.isBoolean(tracePointer)) {
    commonPreferences.ShowSingleTouches = tracePointer;
    commonPreferences.ShowPinches = tracePointer;
    commonPreferences.ShowPinchPivotPoint = tracePointer;
    commonPreferences.HighlightEdgeGestures = tracePointer;
  }

  switch (_lodash.default.lowerCase(pasteboardAutomaticSync)) {
    case 'on':
      commonPreferences.PasteboardAutomaticSync = true;
      break;

    case 'off':
      commonPreferences.PasteboardAutomaticSync = false;
      break;

    case 'system':
      break;

    default:
      _logger.default.info(`['on', 'off' or 'system'] are available as the pasteboard automatic sync option. Defaulting to 'off'`);

      commonPreferences.PasteboardAutomaticSync = false;
  }

  return [devicePreferences, commonPreferences];
}

class SimulatorXcode9 extends _simulatorXcode.default {
  constructor(udid, xcodeVersion) {
    super(udid, xcodeVersion);
  }

  async run(opts = {}) {
    opts = _lodash.default.cloneDeep(opts);

    _lodash.default.defaultsDeep(opts, {
      isHeadless: false,
      startupTimeout: this.startupTimeout
    });

    const [devicePreferences, commonPreferences] = compileSimulatorPreferences(opts);
    await this.updatePreferences(devicePreferences, commonPreferences);
    const timer = new _support.timing.Timer().start();
    const shouldWaitForBoot = await startupLock.acquire(this.uiClientBundleId, async () => {
      const isServerRunning = await this.isRunning();
      const uiClientPid = await this.getUIClientPid();

      if (opts.isHeadless) {
        if (isServerRunning && !uiClientPid) {
          _logger.default.info(`Simulator with UDID '${this.udid}' is already booted in headless mode.`);

          return false;
        }

        if (await this.killUIClient({
          pid: uiClientPid
        })) {
          _logger.default.info(`Detected the Simulator UI client was running and killed it. Verifying the current Simulator state`);
        }

        try {
          await (0, _asyncbox.waitForCondition)(async () => await this.isShutdown(), {
            waitMs: 5000,
            intervalMs: 100
          });
        } catch (e) {
          if (!(await this.isRunning())) {
            throw new Error(`Simulator with UDID '${this.udid}' cannot be transitioned to headless mode`);
          }

          return false;
        }

        _logger.default.info(`Booting Simulator with UDID '${this.udid}' in headless mode. ` + `All UI-related capabilities are going to be ignored`);

        await this.boot();
      } else {
        if (isServerRunning && uiClientPid) {
          _logger.default.info(`Both Simulator with UDID '${this.udid}' and the UI client are currently running`);

          return false;
        }

        if (isServerRunning) {
          _logger.default.info(`Simulator '${this.udid}' is booted while its UI is not visible. ` + `Trying to restart it with the Simulator window visible`);

          await this.shutdown({
            timeout: SIMULATOR_SHUTDOWN_TIMEOUT
          });
        }

        await this.launchWindow(uiClientPid, opts);
      }

      return true;
    });

    if (shouldWaitForBoot) {
      await this.waitForBoot(opts.startupTimeout);

      _logger.default.info(`Simulator with UDID ${this.udid} booted in ${timer.getDuration().asSeconds.toFixed(3)}s`);
    }

    (async () => {
      try {
        await this.disableKeyboardIntroduction();
      } catch (e) {
        _logger.default.info(`Cannot disable Simulator keyboard introduction. Original error: ${e.message}`);
      }
    })();
  }

  async startUIClient(opts = {}) {
    opts = _lodash.default.cloneDeep(opts);

    _lodash.default.defaultsDeep(opts, {
      startupTimeout: this.startupTimeout
    });

    const simulatorApp = _path.default.resolve(await (0, _appiumXcode.getPath)(), 'Applications', this.simulatorApp);

    const args = ['-Fn', simulatorApp];

    _logger.default.info(`Starting Simulator UI: ${_support.util.quote(['open', ...args])}`);

    try {
      await (0, _teen_process.exec)('open', args, {
        timeout: opts.startupTimeout
      });
    } catch (err) {
      throw new Error(`Got an unexpected error while opening Simulator UI: ` + err.stderr || err.stdout || err.message);
    }
  }

  async disableKeyboardIntroduction() {
    const argChunks = (0, _defaultsUtils.generateDefaultsCommandArgs)({
      DidShowContinuousPathIntroduction: 1
    }, true);
    await _bluebird.default.all(argChunks.map(args => this.simctl.spawnProcess(['defaults', 'write', DOMAIN_KEYBOARD_PREFERENCES, ...args])));
  }

  async launchWindow(isUiClientRunning, opts = {}) {
    await this.boot();

    if (!isUiClientRunning) {
      await this.startUIClient(opts);
    }
  }

  async boot() {
    const bootEventsEmitter = new _events.EventEmitter();
    await this.simctl.startBootMonitor({
      onError: err => bootEventsEmitter.emit('failure', err),
      onFinished: () => bootEventsEmitter.emit('finish'),
      shouldPreboot: true
    });

    try {
      await new _bluebird.default((resolve, reject) => {
        setTimeout(resolve, 3000);
        bootEventsEmitter.once('failure', err => {
          if (_lodash.default.includes(err === null || err === void 0 ? void 0 : err.message, 'state: Booted')) {
            resolve();
          } else {
            reject(err);
          }
        });
        bootEventsEmitter.once('finish', resolve);
      });
    } finally {
      bootEventsEmitter.removeAllListeners();
    }
  }

  verifyDevicePreferences(prefs = {}) {
    if (_lodash.default.isEmpty(prefs)) {
      return;
    }

    if (!_lodash.default.isUndefined(prefs.SimulatorWindowLastScale)) {
      if (!_lodash.default.isNumber(prefs.SimulatorWindowLastScale) || prefs.SimulatorWindowLastScale <= 0) {
        _logger.default.errorAndThrow(`SimulatorWindowLastScale is expected to be a positive float value. ` + `'${prefs.SimulatorWindowLastScale}' is assigned instead.`);
      }
    }

    if (!_lodash.default.isUndefined(prefs.SimulatorWindowCenter)) {
      const verificationPattern = /{-?\d+(\.\d+)?,-?\d+(\.\d+)?}/;

      if (!_lodash.default.isString(prefs.SimulatorWindowCenter) || !verificationPattern.test(prefs.SimulatorWindowCenter)) {
        _logger.default.errorAndThrow(`SimulatorWindowCenter is expected to match "{floatXPosition,floatYPosition}" format (without spaces). ` + `'${prefs.SimulatorWindowCenter}' is assigned instead.`);
      }
    }

    if (!_lodash.default.isUndefined(prefs.SimulatorWindowOrientation)) {
      const acceptableValues = ['Portrait', 'LandscapeLeft', 'PortraitUpsideDown', 'LandscapeRight'];

      if (acceptableValues.indexOf(prefs.SimulatorWindowOrientation) === -1) {
        _logger.default.errorAndThrow(`SimulatorWindowOrientation is expected to be one of ${acceptableValues}. ` + `'${prefs.SimulatorWindowOrientation}' is assigned instead.`);
      }
    }

    if (!_lodash.default.isUndefined(prefs.SimulatorWindowRotationAngle)) {
      if (!_lodash.default.isNumber(prefs.SimulatorWindowRotationAngle)) {
        _logger.default.errorAndThrow(`SimulatorWindowRotationAngle is expected to be a valid number. ` + `'${prefs.SimulatorWindowRotationAngle}' is assigned instead.`);
      }
    }
  }

  async updatePreferences(devicePrefs = {}, commonPrefs = {}) {
    if (!_lodash.default.isEmpty(devicePrefs)) {
      _logger.default.debug(`Setting preferences of ${this.udid} Simulator to ${JSON.stringify(devicePrefs)}`);
    }

    if (!_lodash.default.isEmpty(commonPrefs)) {
      _logger.default.debug(`Setting common Simulator preferences to ${JSON.stringify(commonPrefs)}`);
    }

    const homeFolderPath = process.env.HOME;

    if (!homeFolderPath) {
      _logger.default.warn(`Cannot get the path to HOME folder from the process environment. ` + `Ignoring Simulator preferences update.`);

      return false;
    }

    this.verifyDevicePreferences(devicePrefs);

    const plistPath = _path.default.resolve(homeFolderPath, 'Library', 'Preferences', 'com.apple.iphonesimulator.plist');

    return await preferencesPlistGuard.acquire(SimulatorXcode9.name, async () => {
      const defaults = new _defaultsUtils.NSUserDefaults(plistPath);

      const prefsToUpdate = _lodash.default.clone(commonPrefs);

      try {
        if (!_lodash.default.isEmpty(devicePrefs)) {
          let existingDevicePrefs;
          const udidKey = this.udid.toUpperCase();

          if (await _support.fs.exists(plistPath)) {
            const currentPlistContent = await defaults.asJson();

            if (_lodash.default.isPlainObject(currentPlistContent.DevicePreferences) && _lodash.default.isPlainObject(currentPlistContent.DevicePreferences[udidKey])) {
              existingDevicePrefs = currentPlistContent.DevicePreferences[udidKey];
            }
          }

          Object.assign(prefsToUpdate, {
            DevicePreferences: {
              [udidKey]: Object.assign({}, existingDevicePrefs || {}, devicePrefs)
            }
          });
        }

        await defaults.update(prefsToUpdate);

        _logger.default.debug(`Updated ${this.udid} Simulator preferences at '${plistPath}' with ` + JSON.stringify(prefsToUpdate));

        return true;
      } catch (e) {
        _logger.default.warn(`Cannot update ${this.udid} Simulator preferences at '${plistPath}'. ` + `Try to delete the file manually in order to reset it. Original error: ${e.message}`);

        return false;
      }
    });
  }

  async clean() {
    _logger.default.info(`Cleaning simulator ${this.udid}`);

    await this.simctl.eraseDevice(10000);
  }

  async _activateWindow() {
    let selfName;
    let selfSdk;
    let bootedDevicesCount = 0;

    for (const [sdk, deviceArr] of _lodash.default.toPairs(await this.simctl.getDevices())) {
      for (const {
        state,
        udid,
        name
      } of deviceArr) {
        if (state === 'Booted') {
          bootedDevicesCount++;
        }

        if (!selfName && udid === this.udid) {
          selfSdk = sdk;
          selfName = name;
        }
      }
    }

    if (bootedDevicesCount < 2) {
      return await super._activateWindow();
    }

    return `
      tell application "System Events"
        tell process "Simulator"
          set frontmost to false
          set frontmost to true
          click (menu item 1 where (its name contains "${selfName} " and its name contains "${selfSdk}")) of menu 1 of menu bar item "Window" of menu bar 1
        end tell
      end tell
    `;
  }

  async isBiometricEnrolled() {
    const {
      stdout
    } = await this.simctl.spawnProcess(['notifyutil', '-g', ENROLLMENT_NOTIFICATION_RECEIVER]);
    const match = new RegExp(`${_lodash.default.escapeRegExp(ENROLLMENT_NOTIFICATION_RECEIVER)}\\s+([01])`).exec(stdout);

    if (!match) {
      throw new Error(`Cannot parse biometric enrollment state from '${stdout}'`);
    }

    _logger.default.info(`Current biometric enrolled state for ${this.udid} Simulator: ${match[1]}`);

    return match[1] === '1';
  }

  async enrollBiometric(isEnabled = true) {
    _logger.default.debug(`Setting biometric enrolled state for ${this.udid} Simulator to '${isEnabled ? 'enabled' : 'disabled'}'`);

    await this.simctl.spawnProcess(['notifyutil', '-s', ENROLLMENT_NOTIFICATION_RECEIVER, isEnabled ? '1' : '0']);
    await this.simctl.spawnProcess(['notifyutil', '-p', ENROLLMENT_NOTIFICATION_RECEIVER]);

    if ((await this.isBiometricEnrolled()) !== isEnabled) {
      throw new Error(`Cannot set biometric enrolled state for ${this.udid} Simulator to '${isEnabled ? 'enabled' : 'disabled'}'`);
    }
  }

  async sendBiometricMatch(shouldMatch = true, biometricName = 'touchId') {
    const domainComponent = (0, _utils.toBiometricDomainComponent)(biometricName);
    const domain = `com.apple.BiometricKit_Sim.${domainComponent}.${shouldMatch ? '' : 'no'}match`;
    await this.simctl.spawnProcess(['notifyutil', '-p', domain]);

    _logger.default.info(`Sent notification ${domain} to ${shouldMatch ? 'match' : 'not match'} ${biometricName} biometric ` + `for ${this.udid} Simulator`);
  }

  async getLaunchDaemonsRoot() {
    const devRoot = await (0, _utils.getDeveloperRoot)();
    return _path.default.resolve(devRoot, 'Platforms/iPhoneOS.platform/Developer/Library/CoreSimulator/Profiles/Runtimes/iOS.simruntime/Contents/Resources/RuntimeRoot/System/Library/LaunchDaemons');
  }

  async configureLocalization(opts = {}) {
    if (_lodash.default.isEmpty(opts)) {
      return false;
    }

    const {
      language,
      locale,
      keyboard
    } = opts;
    const globalPrefs = {};
    let keyboardId = null;

    if (_lodash.default.isPlainObject(keyboard)) {
      const {
        name,
        layout,
        hardware
      } = keyboard;

      if (!name) {
        throw new Error(`The 'keyboard' field must have a valid name set`);
      }

      if (!layout) {
        throw new Error(`The 'keyboard' field must have a valid layout set`);
      }

      keyboardId = `${name}@sw=${layout}`;

      if (hardware) {
        keyboardId += `;@hw=${hardware}`;
      }

      globalPrefs.AppleKeyboards = [keyboardId];
    }

    if (_lodash.default.isPlainObject(language)) {
      const {
        name
      } = language;

      if (!name) {
        throw new Error(`The 'language' field must have a valid name set`);
      }

      globalPrefs.AppleLanguages = [name];
    }

    if (_lodash.default.isPlainObject(locale)) {
      const {
        name,
        calendar
      } = locale;

      if (!name) {
        throw new Error(`The 'locale' field must have a valid name set`);
      }

      let localeId = name;

      if (calendar) {
        localeId += `@calendar=${calendar}`;
      }

      globalPrefs.AppleLocale = localeId;
    }

    if (_lodash.default.isEmpty(globalPrefs)) {
      return false;
    }

    const argChunks = (0, _defaultsUtils.generateDefaultsCommandArgs)(globalPrefs, true);
    await _bluebird.default.all(argChunks.map(args => this.simctl.spawnProcess(['defaults', 'write', '.GlobalPreferences.plist', ...args])));

    if (keyboardId) {
      const argChunks = (0, _defaultsUtils.generateDefaultsCommandArgs)({
        KeyboardsCurrentAndNext: [keyboardId],
        KeyboardLastUsed: keyboardId,
        KeyboardLastUsedForLanguage: {
          [keyboard.name]: keyboardId
        }
      }, true);
      await _bluebird.default.all(argChunks.map(args => this.simctl.spawnProcess(['defaults', 'write', 'com.apple.Preferences', ...args])));
    }

    return true;
  }

}

var _default = SimulatorXcode9;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGliL3NpbXVsYXRvci14Y29kZS05LmpzIiwibmFtZXMiOlsiU0lNVUxBVE9SX1NIVVRET1dOX1RJTUVPVVQiLCJzdGFydHVwTG9jayIsIkFzeW5jTG9jayIsInByZWZlcmVuY2VzUGxpc3RHdWFyZCIsIkVOUk9MTE1FTlRfTk9USUZJQ0FUSU9OX1JFQ0VJVkVSIiwiRE9NQUlOX0tFWUJPQVJEX1BSRUZFUkVOQ0VTIiwiY29tcGlsZVNpbXVsYXRvclByZWZlcmVuY2VzIiwib3B0cyIsImNvbm5lY3RIYXJkd2FyZUtleWJvYXJkIiwidHJhY2VQb2ludGVyIiwicGFzdGVib2FyZEF1dG9tYXRpY1N5bmMiLCJzY2FsZUZhY3RvciIsImNvbW1vblByZWZlcmVuY2VzIiwiUm90YXRlV2luZG93V2hlblNpZ25hbGVkQnlHdWVzdCIsIlN0YXJ0TGFzdERldmljZU9uTGF1bmNoIiwiRGV0YWNoT25XaW5kb3dDbG9zZSIsIkF0dGFjaEJvb3RlZE9uU3RhcnQiLCJkZXZpY2VQcmVmZXJlbmNlcyIsIl8iLCJjbG9uZURlZXAiLCJTaW11bGF0b3JXaW5kb3dMYXN0U2NhbGUiLCJwYXJzZUZsb2F0IiwiaXNCb29sZWFuIiwiaXNOaWwiLCJDb25uZWN0SGFyZHdhcmVLZXlib2FyZCIsIlNob3dTaW5nbGVUb3VjaGVzIiwiU2hvd1BpbmNoZXMiLCJTaG93UGluY2hQaXZvdFBvaW50IiwiSGlnaGxpZ2h0RWRnZUdlc3R1cmVzIiwibG93ZXJDYXNlIiwiUGFzdGVib2FyZEF1dG9tYXRpY1N5bmMiLCJsb2ciLCJpbmZvIiwiU2ltdWxhdG9yWGNvZGU5IiwiU2ltdWxhdG9yWGNvZGU4IiwiY29uc3RydWN0b3IiLCJ1ZGlkIiwieGNvZGVWZXJzaW9uIiwicnVuIiwiZGVmYXVsdHNEZWVwIiwiaXNIZWFkbGVzcyIsInN0YXJ0dXBUaW1lb3V0IiwidXBkYXRlUHJlZmVyZW5jZXMiLCJ0aW1lciIsInRpbWluZyIsIlRpbWVyIiwic3RhcnQiLCJzaG91bGRXYWl0Rm9yQm9vdCIsImFjcXVpcmUiLCJ1aUNsaWVudEJ1bmRsZUlkIiwiaXNTZXJ2ZXJSdW5uaW5nIiwiaXNSdW5uaW5nIiwidWlDbGllbnRQaWQiLCJnZXRVSUNsaWVudFBpZCIsImtpbGxVSUNsaWVudCIsInBpZCIsIndhaXRGb3JDb25kaXRpb24iLCJpc1NodXRkb3duIiwid2FpdE1zIiwiaW50ZXJ2YWxNcyIsImUiLCJFcnJvciIsImJvb3QiLCJzaHV0ZG93biIsInRpbWVvdXQiLCJsYXVuY2hXaW5kb3ciLCJ3YWl0Rm9yQm9vdCIsImdldER1cmF0aW9uIiwiYXNTZWNvbmRzIiwidG9GaXhlZCIsImRpc2FibGVLZXlib2FyZEludHJvZHVjdGlvbiIsIm1lc3NhZ2UiLCJzdGFydFVJQ2xpZW50Iiwic2ltdWxhdG9yQXBwIiwicGF0aCIsInJlc29sdmUiLCJnZXRYY29kZVBhdGgiLCJhcmdzIiwidXRpbCIsInF1b3RlIiwiZXhlYyIsImVyciIsInN0ZGVyciIsInN0ZG91dCIsImFyZ0NodW5rcyIsImdlbmVyYXRlRGVmYXVsdHNDb21tYW5kQXJncyIsIkRpZFNob3dDb250aW51b3VzUGF0aEludHJvZHVjdGlvbiIsIkIiLCJhbGwiLCJtYXAiLCJzaW1jdGwiLCJzcGF3blByb2Nlc3MiLCJpc1VpQ2xpZW50UnVubmluZyIsImJvb3RFdmVudHNFbWl0dGVyIiwiRXZlbnRFbWl0dGVyIiwic3RhcnRCb290TW9uaXRvciIsIm9uRXJyb3IiLCJlbWl0Iiwib25GaW5pc2hlZCIsInNob3VsZFByZWJvb3QiLCJyZWplY3QiLCJzZXRUaW1lb3V0Iiwib25jZSIsImluY2x1ZGVzIiwicmVtb3ZlQWxsTGlzdGVuZXJzIiwidmVyaWZ5RGV2aWNlUHJlZmVyZW5jZXMiLCJwcmVmcyIsImlzRW1wdHkiLCJpc1VuZGVmaW5lZCIsImlzTnVtYmVyIiwiZXJyb3JBbmRUaHJvdyIsIlNpbXVsYXRvcldpbmRvd0NlbnRlciIsInZlcmlmaWNhdGlvblBhdHRlcm4iLCJpc1N0cmluZyIsInRlc3QiLCJTaW11bGF0b3JXaW5kb3dPcmllbnRhdGlvbiIsImFjY2VwdGFibGVWYWx1ZXMiLCJpbmRleE9mIiwiU2ltdWxhdG9yV2luZG93Um90YXRpb25BbmdsZSIsImRldmljZVByZWZzIiwiY29tbW9uUHJlZnMiLCJkZWJ1ZyIsIkpTT04iLCJzdHJpbmdpZnkiLCJob21lRm9sZGVyUGF0aCIsInByb2Nlc3MiLCJlbnYiLCJIT01FIiwid2FybiIsInBsaXN0UGF0aCIsIm5hbWUiLCJkZWZhdWx0cyIsIk5TVXNlckRlZmF1bHRzIiwicHJlZnNUb1VwZGF0ZSIsImNsb25lIiwiZXhpc3RpbmdEZXZpY2VQcmVmcyIsInVkaWRLZXkiLCJ0b1VwcGVyQ2FzZSIsImZzIiwiZXhpc3RzIiwiY3VycmVudFBsaXN0Q29udGVudCIsImFzSnNvbiIsImlzUGxhaW5PYmplY3QiLCJEZXZpY2VQcmVmZXJlbmNlcyIsIk9iamVjdCIsImFzc2lnbiIsInVwZGF0ZSIsImNsZWFuIiwiZXJhc2VEZXZpY2UiLCJfYWN0aXZhdGVXaW5kb3ciLCJzZWxmTmFtZSIsInNlbGZTZGsiLCJib290ZWREZXZpY2VzQ291bnQiLCJzZGsiLCJkZXZpY2VBcnIiLCJ0b1BhaXJzIiwiZ2V0RGV2aWNlcyIsInN0YXRlIiwiaXNCaW9tZXRyaWNFbnJvbGxlZCIsIm1hdGNoIiwiUmVnRXhwIiwiZXNjYXBlUmVnRXhwIiwiZW5yb2xsQmlvbWV0cmljIiwiaXNFbmFibGVkIiwic2VuZEJpb21ldHJpY01hdGNoIiwic2hvdWxkTWF0Y2giLCJiaW9tZXRyaWNOYW1lIiwiZG9tYWluQ29tcG9uZW50IiwidG9CaW9tZXRyaWNEb21haW5Db21wb25lbnQiLCJkb21haW4iLCJnZXRMYXVuY2hEYWVtb25zUm9vdCIsImRldlJvb3QiLCJnZXREZXZlbG9wZXJSb290IiwiY29uZmlndXJlTG9jYWxpemF0aW9uIiwibGFuZ3VhZ2UiLCJsb2NhbGUiLCJrZXlib2FyZCIsImdsb2JhbFByZWZzIiwia2V5Ym9hcmRJZCIsImxheW91dCIsImhhcmR3YXJlIiwiQXBwbGVLZXlib2FyZHMiLCJBcHBsZUxhbmd1YWdlcyIsImNhbGVuZGFyIiwibG9jYWxlSWQiLCJBcHBsZUxvY2FsZSIsIktleWJvYXJkc0N1cnJlbnRBbmROZXh0IiwiS2V5Ym9hcmRMYXN0VXNlZCIsIktleWJvYXJkTGFzdFVzZWRGb3JMYW5ndWFnZSJdLCJzb3VyY2VSb290IjoiLi4vLi4iLCJzb3VyY2VzIjpbImxpYi9zaW11bGF0b3IteGNvZGUtOS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgU2ltdWxhdG9yWGNvZGU4IGZyb20gJy4vc2ltdWxhdG9yLXhjb2RlLTgnO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IHsgZnMsIHRpbWluZywgdXRpbCB9IGZyb20gJ0BhcHBpdW0vc3VwcG9ydCc7XG5pbXBvcnQgQXN5bmNMb2NrIGZyb20gJ2FzeW5jLWxvY2snO1xuaW1wb3J0IGxvZyBmcm9tICcuL2xvZ2dlcic7XG5pbXBvcnQgeyB3YWl0Rm9yQ29uZGl0aW9uIH0gZnJvbSAnYXN5bmNib3gnO1xuaW1wb3J0IHsgdG9CaW9tZXRyaWNEb21haW5Db21wb25lbnQsIGdldERldmVsb3BlclJvb3QgfSBmcm9tICcuL3V0aWxzLmpzJztcbmltcG9ydCB7IE5TVXNlckRlZmF1bHRzLCBnZW5lcmF0ZURlZmF1bHRzQ29tbWFuZEFyZ3MgfSBmcm9tICcuL2RlZmF1bHRzLXV0aWxzJztcbmltcG9ydCBCIGZyb20gJ2JsdWViaXJkJztcbmltcG9ydCB7IEV2ZW50RW1pdHRlciB9IGZyb20gJ2V2ZW50cyc7XG5pbXBvcnQgeyBnZXRQYXRoIGFzIGdldFhjb2RlUGF0aCB9IGZyb20gJ2FwcGl1bS14Y29kZSc7XG5pbXBvcnQgeyBleGVjIH0gZnJvbSAndGVlbl9wcm9jZXNzJztcblxuY29uc3QgU0lNVUxBVE9SX1NIVVRET1dOX1RJTUVPVVQgPSAxNSAqIDEwMDA7XG5jb25zdCBzdGFydHVwTG9jayA9IG5ldyBBc3luY0xvY2soKTtcbmNvbnN0IHByZWZlcmVuY2VzUGxpc3RHdWFyZCA9IG5ldyBBc3luY0xvY2soKTtcbmNvbnN0IEVOUk9MTE1FTlRfTk9USUZJQ0FUSU9OX1JFQ0VJVkVSID0gJ2NvbS5hcHBsZS5CaW9tZXRyaWNLaXQuZW5yb2xsbWVudENoYW5nZWQnO1xuY29uc3QgRE9NQUlOX0tFWUJPQVJEX1BSRUZFUkVOQ0VTID0gJ2NvbS5hcHBsZS5rZXlib2FyZC5wcmVmZXJlbmNlcyc7XG5cbi8qKlxuICogQ3JlYXRlcyBkZXZpY2UgYW5kIGNvbW1vbiBTaW11bGF0b3IgcHJlZmVyZW5jZXMsIHdoaWNoIGNvdWxkXG4gKiBiZSBsYXRlciBhcHBsaWVkIHVzaW5nIGBkZWZhdWx0c2AgQ0xJIHV0aWxpdHkuXG4gKlxuICogQHBhcmFtIHtSdW5PcHRpb25zfSBvcHRzXG4gKiBAcmV0dXJucyB7b2JqZWN0W119IFRoZSBmaXJzdCBhcnJheSBpdGVtIGlzIHRoZSByZXN1bHRpbmcgZGV2aWNlIHByZWZlcmVuY2VzXG4gKiBvYmplY3QgYW5kIHRoZSBzZWNvbmQgb25lIGlzIGNvbW1vbiBwcmVmZXJlbmNlcyBvYmplY3RcbiAqL1xuZnVuY3Rpb24gY29tcGlsZVNpbXVsYXRvclByZWZlcmVuY2VzIChvcHRzID0ge30pIHtcbiAgY29uc3Qge1xuICAgIGNvbm5lY3RIYXJkd2FyZUtleWJvYXJkLFxuICAgIHRyYWNlUG9pbnRlcixcbiAgICBwYXN0ZWJvYXJkQXV0b21hdGljU3luYyxcbiAgICBzY2FsZUZhY3RvcixcbiAgfSA9IG9wdHM7XG4gIGNvbnN0IGNvbW1vblByZWZlcmVuY2VzID0ge1xuICAgIC8vIFRoaXMgb3B0aW9uIGlzIG5lY2Vzc2FyeSB0byBtYWtlIHRoZSBTaW11bGF0b3Igd2luZG93IGZvbGxvd1xuICAgIC8vIHRoZSBhY3R1YWwgWENVSURldmljZSBvcmllbnRhdGlvblxuICAgIFJvdGF0ZVdpbmRvd1doZW5TaWduYWxlZEJ5R3Vlc3Q6IHRydWUsXG4gICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FwcGl1bS9hcHBpdW0vaXNzdWVzLzE2NDE4XG4gICAgU3RhcnRMYXN0RGV2aWNlT25MYXVuY2g6IGZhbHNlLFxuICAgIERldGFjaE9uV2luZG93Q2xvc2U6IGZhbHNlLFxuICAgIEF0dGFjaEJvb3RlZE9uU3RhcnQ6IHRydWUsXG4gIH07XG4gIGNvbnN0IGRldmljZVByZWZlcmVuY2VzID0gb3B0cy5kZXZpY2VQcmVmZXJlbmNlcyA/IF8uY2xvbmVEZWVwKG9wdHMuZGV2aWNlUHJlZmVyZW5jZXMpIDoge307XG4gIGlmIChzY2FsZUZhY3Rvcikge1xuICAgIGRldmljZVByZWZlcmVuY2VzLlNpbXVsYXRvcldpbmRvd0xhc3RTY2FsZSA9IHBhcnNlRmxvYXQoc2NhbGVGYWN0b3IpO1xuICB9XG4gIGlmIChfLmlzQm9vbGVhbihjb25uZWN0SGFyZHdhcmVLZXlib2FyZCkgfHwgXy5pc05pbChjb25uZWN0SGFyZHdhcmVLZXlib2FyZCkpIHtcbiAgICBkZXZpY2VQcmVmZXJlbmNlcy5Db25uZWN0SGFyZHdhcmVLZXlib2FyZCA9IGNvbm5lY3RIYXJkd2FyZUtleWJvYXJkID8/IGZhbHNlO1xuICAgIGNvbW1vblByZWZlcmVuY2VzLkNvbm5lY3RIYXJkd2FyZUtleWJvYXJkID0gY29ubmVjdEhhcmR3YXJlS2V5Ym9hcmQgPz8gZmFsc2U7XG4gIH1cbiAgaWYgKF8uaXNCb29sZWFuKHRyYWNlUG9pbnRlcikpIHtcbiAgICBjb21tb25QcmVmZXJlbmNlcy5TaG93U2luZ2xlVG91Y2hlcyA9IHRyYWNlUG9pbnRlcjtcbiAgICBjb21tb25QcmVmZXJlbmNlcy5TaG93UGluY2hlcyA9IHRyYWNlUG9pbnRlcjtcbiAgICBjb21tb25QcmVmZXJlbmNlcy5TaG93UGluY2hQaXZvdFBvaW50ID0gdHJhY2VQb2ludGVyO1xuICAgIGNvbW1vblByZWZlcmVuY2VzLkhpZ2hsaWdodEVkZ2VHZXN0dXJlcyA9IHRyYWNlUG9pbnRlcjtcbiAgfVxuICBzd2l0Y2ggKF8ubG93ZXJDYXNlKHBhc3RlYm9hcmRBdXRvbWF0aWNTeW5jKSkge1xuICAgIGNhc2UgJ29uJzpcbiAgICAgIGNvbW1vblByZWZlcmVuY2VzLlBhc3RlYm9hcmRBdXRvbWF0aWNTeW5jID0gdHJ1ZTtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ29mZic6XG4gICAgICAvLyBJbXByb3ZlIGxhdW5jaGluZyBzaW11bGF0b3IgcGVyZm9ybWFuY2VcbiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9XZWJLaXQvd2Via2l0L2Jsb2IvbWFzdGVyL1Rvb2xzL1NjcmlwdHMvd2Via2l0cHkveGNvZGUvc2ltdWxhdGVkX2RldmljZS5weSNMNDEzXG4gICAgICBjb21tb25QcmVmZXJlbmNlcy5QYXN0ZWJvYXJkQXV0b21hdGljU3luYyA9IGZhbHNlO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSAnc3lzdGVtJzpcbiAgICAgIC8vIERvIG5vdCBhZGQgLVBhc3RlYm9hcmRBdXRvbWF0aWNTeW5jXG4gICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgbG9nLmluZm8oYFsnb24nLCAnb2ZmJyBvciAnc3lzdGVtJ10gYXJlIGF2YWlsYWJsZSBhcyB0aGUgcGFzdGVib2FyZCBhdXRvbWF0aWMgc3luYyBvcHRpb24uIERlZmF1bHRpbmcgdG8gJ29mZidgKTtcbiAgICAgIGNvbW1vblByZWZlcmVuY2VzLlBhc3RlYm9hcmRBdXRvbWF0aWNTeW5jID0gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIFtkZXZpY2VQcmVmZXJlbmNlcywgY29tbW9uUHJlZmVyZW5jZXNdO1xufVxuXG5jbGFzcyBTaW11bGF0b3JYY29kZTkgZXh0ZW5kcyBTaW11bGF0b3JYY29kZTgge1xuICBjb25zdHJ1Y3RvciAodWRpZCwgeGNvZGVWZXJzaW9uKSB7XG4gICAgc3VwZXIodWRpZCwgeGNvZGVWZXJzaW9uKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAdHlwZWRlZiB7T2JqZWN0fSBEZXZpY2VQcmVmZXJlbmNlc1xuICAgKiBAcHJvcGVydHkgez9udW1iZXJ9IFNpbXVsYXRvckV4dGVybmFsRGlzcGxheSAtIFRCRC4gRXhhbXBsZSB2YWx1ZTogMi4xMTRcbiAgICogQHByb3BlcnR5IHs/c3RyaW5nfSBDaHJvbWVUaW50IC0gVEJELiBFeGFtcGxlIHZhbHVlOiAnJ1xuICAgKiBAcHJvcGVydHkgez9udW1iZXJ9IFNpbXVsYXRvcldpbmRvd0xhc3RTY2FsZSAtIFNjYWxlIHZhbHVlIGZvciB0aGUgcGFydGljdWxhciBTaW11bGF0b3Igd2luZG93LlxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDEuMCBtZWFucyAxMDAlIHNjYWxlLlxuICAgKiBAcHJvcGVydHkgez9zdHJpbmd9IFNpbXVsYXRvcldpbmRvd09yaWVudGF0aW9uIC0gU2ltdWxhdG9yIHdpbmRvdyBvcmllbnRhdGlvbi4gUG9zc2libGUgdmFsdWVzIGFyZTpcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdQb3J0cmFpdCcsICdMYW5kc2NhcGVMZWZ0JywgJ1BvcnRyYWl0VXBzaWRlRG93bicgYW5kICdMYW5kc2NhcGVSaWdodCcuXG4gICAqIEBwcm9wZXJ0eSB7P251bWJlcn0gU2ltdWxhdG9yV2luZG93Um90YXRpb25BbmdsZSAtIFdpbmRvdyByb3RhdGlvbiBhbmdsZS4gVGhpcyB2YWx1ZSBpcyBleHBlY3RlZCB0byBiZSBpbiBzeW5jXG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHdpdGggX1NpbXVsYXRvcldpbmRvd09yaWVudGF0aW9uXy4gVGhlIGNvcnJlc3BvbmRpbmcgdmFsdWVzIGFyZTpcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgMCwgOTAsIDE4MCBhbmQgMjcwLlxuICAgKiBAcHJvcGVydHkgez9zdHJpbmd9IFNpbXVsYXRvcldpbmRvd0NlbnRlciAtIFRoZSBjb29yZGluYXRlcyBvZiBTaW11bGF0b3IncyB3aW5kb3cgY2VudGVyIGluIHBpeGVscyxcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgZXhhbXBsZSAney0xMjk0LjUsIDc3NS41fScuXG4gICAqIEBwcm9wZXJ0eSB7P2Jvb2xlYW59IENvbm5lY3RIYXJkd2FyZUtleWJvYXJkIC0gRXF1YWxzIHRvIDEgaWYgaGFyZHdhcmUga2V5Ym9hcmQgc2hvdWxkIGJlIGNvbm5lY3RlZC5cbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBPdGhlcndpc2UgMC5cbiAgICovXG5cbiAgLyoqXG4gICAqIEB0eXBlZGVmIHtPYmplY3R9IENvbW1vblByZWZlcmVuY2VzXG4gICAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gQ29ubmVjdEhhcmR3YXJlS2V5Ym9hcmQgLSBXaGV0aGVyIHRvIGNvbm5lY3QgaGFyZHdhcmUga2V5Ym9hcmRcbiAgICovXG5cbiAgLyoqXG4gICAqIEB0eXBlZGVmIHtPYmplY3R9IFJ1bk9wdGlvbnNcbiAgICogQHByb3BlcnR5IHtzdHJpbmd9IHNjYWxlRmFjdG9yOiBBbnkgcG9zaXRpdmUgZmxvYXQgdmFsdWUuIDEuMCBtZWFucyAxOjEgc2NhbGUuXG4gICAqIERlZmluZXMgdGhlIHdpbmRvdyBzY2FsZSB2YWx1ZSBmb3IgdGhlIFVJIGNsaWVudCB3aW5kb3cgZm9yIHRoZSBjdXJyZW50IFNpbXVsYXRvci5cbiAgICogRXF1YWxzIHRvIGBudWxsYCBieSBkZWZhdWx0LCB3aGljaCBrZWVwcyB0aGUgY3VycmVudCBzY2FsZSB1bmNoYW5nZWQuXG4gICAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gY29ubmVjdEhhcmR3YXJlS2V5Ym9hcmQ6IHdoZXRoZXIgdG8gY29ubmVjdCB0aGUgaGFyZHdhcmUga2V5Ym9hcmQgdG8gdGhlXG4gICAqIFNpbXVsYXRvciBVSSBjbGllbnQuIEVxdWFscyB0byBgZmFsc2VgIGJ5IGRlZmF1bHQuXG4gICAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBzdGFydHVwVGltZW91dDogbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyB0byB3YWl0IHVudGlsIFNpbXVsYXRvciBib290aW5nXG4gICAqIHByb2Nlc3MgaXMgY29tcGxldGVkLiBUaGUgZGVmYXVsdCB0aW1lb3V0IHdpbGwgYmUgdXNlZCBpZiBub3Qgc2V0IGV4cGxpY2l0bHkuXG4gICAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gaXNIZWFkbGVzczogd2hldGhlciB0byBzdGFydCB0aGUgU2ltdWxhdG9yIGluIGhlYWRsZXNzIG1vZGUgKHdpdGggVUlcbiAgICogY2xpZW50IGludmlzaWJsZSkuIGBmYWxzZWAgYnkgZGVmYXVsdC5cbiAgICogQHByb3BlcnR5IHs/Ym9vbGVhbn0gdHJhY2VQb2ludGVyIFtmYWxzZV0gLSBXaGV0aGVyIHRvIGhpZ2hsaWdodCB0b3VjaGVzIG9uIFNpbXVsYXRvclxuICAgKiBzY3JlZW4uIFRoaXMgaXMgaGVscGZ1bCB3aGlsZSBkZWJ1Z2dpbmcgYXV0b21hdGVkIHRlc3RzIG9yIHdoaWxlIG9ic2VydmluZyB0aGUgYXV0b21hdGlvblxuICAgKiByZWNvcmRpbmdzLlxuICAgKiBAcHJvcGVydHkge3N0cmluZ30gcGFzdGVib2FyZEF1dG9tYXRpY1N5bmMgWydvZmYnXSAtIFdoZXRoZXIgdG8gZGlzYWJsZSBwYXN0ZWJvYXJkIHN5bmMgd2l0aCB0aGVcbiAgICogU2ltdWxhdG9yIFVJIGNsaWVudCBvciByZXNwZWN0IHRoZSBzeXN0ZW0gd2lkZSBwcmVmZXJlbmNlLiAnb24nLCAnb2ZmJywgb3IgJ3N5c3RlbScgaXMgYXZhaWxhYmxlLlxuICAgKiBUaGUgc3luYyBpbmNyZWFzZXMgbGF1bmNoaW5nIHNpbXVsYXRvciBwcm9jZXNzIHRpbWUsIGJ1dCBpdCBhbGxvd3Mgc3lzdGVtIHRvIHN5bmMgcGFzdGVib2FyZFxuICAgKiB3aXRoIHNpbXVsYXRvcnMuIEZvbGxvd3Mgc3lzdGVtLXdpZGUgcHJlZmVyZW5jZSBpZiB0aGUgdmFsdWUgaXMgJ3N5c3RlbScuXG4gICAqIERlZmF1bHRzIHRvICdvZmYnLlxuICAgKiBAcHJvcGVydHkge0RldmljZVByZWZlcmVuY2VzfSBkZXZpY2VQcmVmZXJlbmNlczogcHJlZmVyZW5jZXMgb2YgdGhlIG5ld2x5IGNyZWF0ZWQgU2ltdWxhdG9yXG4gICAqIGRldmljZVxuICAgKi9cblxuICAvKipcbiAgICogRXhlY3V0ZXMgZ2l2ZW4gU2ltdWxhdG9yIHdpdGggb3B0aW9ucy4gVGhlIFNpbXVsYXRvciB3aWxsIG5vdCBiZSByZXN0YXJ0ZWQgaWZcbiAgICogaXQgaXMgYWxyZWFkeSBydW5uaW5nIGFuZCB0aGUgY3VycmVudCBVSSBzdGF0ZSBtYXRjaGVzIHRvIGBpc0hlYWRsZXNzYCBvcHRpb24uXG4gICAqIEBvdmVycmlkZVxuICAgKlxuICAgKiBAcGFyYW0ge1J1bk9wdGlvbnN9IG9wdHMgLSBPbmUgb3IgbW9yZSBvZiBhdmFpbGFibGUgU2ltdWxhdG9yIG9wdGlvbnNcbiAgICovXG4gIGFzeW5jIHJ1biAob3B0cyA9IHt9KSB7XG4gICAgb3B0cyA9IF8uY2xvbmVEZWVwKG9wdHMpO1xuICAgIF8uZGVmYXVsdHNEZWVwKG9wdHMsIHtcbiAgICAgIGlzSGVhZGxlc3M6IGZhbHNlLFxuICAgICAgc3RhcnR1cFRpbWVvdXQ6IHRoaXMuc3RhcnR1cFRpbWVvdXQsXG4gICAgfSk7XG5cbiAgICBjb25zdCBbZGV2aWNlUHJlZmVyZW5jZXMsIGNvbW1vblByZWZlcmVuY2VzXSA9IGNvbXBpbGVTaW11bGF0b3JQcmVmZXJlbmNlcyhvcHRzKTtcbiAgICBhd2FpdCB0aGlzLnVwZGF0ZVByZWZlcmVuY2VzKGRldmljZVByZWZlcmVuY2VzLCBjb21tb25QcmVmZXJlbmNlcyk7XG5cbiAgICBjb25zdCB0aW1lciA9IG5ldyB0aW1pbmcuVGltZXIoKS5zdGFydCgpO1xuICAgIGNvbnN0IHNob3VsZFdhaXRGb3JCb290ID0gYXdhaXQgc3RhcnR1cExvY2suYWNxdWlyZSh0aGlzLnVpQ2xpZW50QnVuZGxlSWQsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGlzU2VydmVyUnVubmluZyA9IGF3YWl0IHRoaXMuaXNSdW5uaW5nKCk7XG4gICAgICBjb25zdCB1aUNsaWVudFBpZCA9IGF3YWl0IHRoaXMuZ2V0VUlDbGllbnRQaWQoKTtcbiAgICAgIGlmIChvcHRzLmlzSGVhZGxlc3MpIHtcbiAgICAgICAgaWYgKGlzU2VydmVyUnVubmluZyAmJiAhdWlDbGllbnRQaWQpIHtcbiAgICAgICAgICBsb2cuaW5mbyhgU2ltdWxhdG9yIHdpdGggVURJRCAnJHt0aGlzLnVkaWR9JyBpcyBhbHJlYWR5IGJvb3RlZCBpbiBoZWFkbGVzcyBtb2RlLmApO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYXdhaXQgdGhpcy5raWxsVUlDbGllbnQoe3BpZDogdWlDbGllbnRQaWR9KSkge1xuICAgICAgICAgIGxvZy5pbmZvKGBEZXRlY3RlZCB0aGUgU2ltdWxhdG9yIFVJIGNsaWVudCB3YXMgcnVubmluZyBhbmQga2lsbGVkIGl0LiBWZXJpZnlpbmcgdGhlIGN1cnJlbnQgU2ltdWxhdG9yIHN0YXRlYCk7XG4gICAgICAgIH1cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAvLyBTdG9wcGluZyB0aGUgVUkgY2xpZW50IGtpbGxzIGFsbCBydW5uaW5nIHNlcnZlcnMgZm9yIHNvbWUgZWFybHkgWENvZGUgdmVyc2lvbnMuIFRoaXMgaXMgYSBrbm93biBidWdcbiAgICAgICAgICBhd2FpdCB3YWl0Rm9yQ29uZGl0aW9uKGFzeW5jICgpID0+IGF3YWl0IHRoaXMuaXNTaHV0ZG93bigpLCB7XG4gICAgICAgICAgICB3YWl0TXM6IDUwMDAsXG4gICAgICAgICAgICBpbnRlcnZhbE1zOiAxMDAsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBpZiAoIWF3YWl0IHRoaXMuaXNSdW5uaW5nKCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgU2ltdWxhdG9yIHdpdGggVURJRCAnJHt0aGlzLnVkaWR9JyBjYW5ub3QgYmUgdHJhbnNpdGlvbmVkIHRvIGhlYWRsZXNzIG1vZGVgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGxvZy5pbmZvKGBCb290aW5nIFNpbXVsYXRvciB3aXRoIFVESUQgJyR7dGhpcy51ZGlkfScgaW4gaGVhZGxlc3MgbW9kZS4gYCArXG4gICAgICAgICAgYEFsbCBVSS1yZWxhdGVkIGNhcGFiaWxpdGllcyBhcmUgZ29pbmcgdG8gYmUgaWdub3JlZGApO1xuICAgICAgICBhd2FpdCB0aGlzLmJvb3QoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGlmIChpc1NlcnZlclJ1bm5pbmcgJiYgdWlDbGllbnRQaWQpIHtcbiAgICAgICAgICBsb2cuaW5mbyhgQm90aCBTaW11bGF0b3Igd2l0aCBVRElEICcke3RoaXMudWRpZH0nIGFuZCB0aGUgVUkgY2xpZW50IGFyZSBjdXJyZW50bHkgcnVubmluZ2ApO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNTZXJ2ZXJSdW5uaW5nKSB7XG4gICAgICAgICAgbG9nLmluZm8oYFNpbXVsYXRvciAnJHt0aGlzLnVkaWR9JyBpcyBib290ZWQgd2hpbGUgaXRzIFVJIGlzIG5vdCB2aXNpYmxlLiBgICtcbiAgICAgICAgICAgIGBUcnlpbmcgdG8gcmVzdGFydCBpdCB3aXRoIHRoZSBTaW11bGF0b3Igd2luZG93IHZpc2libGVgKTtcbiAgICAgICAgICBhd2FpdCB0aGlzLnNodXRkb3duKHt0aW1lb3V0OiBTSU1VTEFUT1JfU0hVVERPV05fVElNRU9VVH0pO1xuICAgICAgICB9XG4gICAgICAgIGF3YWl0IHRoaXMubGF1bmNoV2luZG93KHVpQ2xpZW50UGlkLCBvcHRzKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0pO1xuXG4gICAgaWYgKHNob3VsZFdhaXRGb3JCb290KSB7XG4gICAgICBhd2FpdCB0aGlzLndhaXRGb3JCb290KG9wdHMuc3RhcnR1cFRpbWVvdXQpO1xuICAgICAgbG9nLmluZm8oYFNpbXVsYXRvciB3aXRoIFVESUQgJHt0aGlzLnVkaWR9IGJvb3RlZCBpbiAke3RpbWVyLmdldER1cmF0aW9uKCkuYXNTZWNvbmRzLnRvRml4ZWQoMyl9c2ApO1xuICAgIH1cblxuICAgIChhc3luYyAoKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCB0aGlzLmRpc2FibGVLZXlib2FyZEludHJvZHVjdGlvbigpO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBsb2cuaW5mbyhgQ2Fubm90IGRpc2FibGUgU2ltdWxhdG9yIGtleWJvYXJkIGludHJvZHVjdGlvbi4gT3JpZ2luYWwgZXJyb3I6ICR7ZS5tZXNzYWdlfWApO1xuICAgICAgfVxuICAgIH0pKCk7XG4gIH1cblxuICAvKipcbiAgICogQG92ZXJyaWRlXG4gICAqL1xuICBhc3luYyBzdGFydFVJQ2xpZW50IChvcHRzID0ge30pIHtcbiAgICBvcHRzID0gXy5jbG9uZURlZXAob3B0cyk7XG4gICAgXy5kZWZhdWx0c0RlZXAob3B0cywge1xuICAgICAgc3RhcnR1cFRpbWVvdXQ6IHRoaXMuc3RhcnR1cFRpbWVvdXQsXG4gICAgfSk7XG5cbiAgICBjb25zdCBzaW11bGF0b3JBcHAgPSBwYXRoLnJlc29sdmUoYXdhaXQgZ2V0WGNvZGVQYXRoKCksICdBcHBsaWNhdGlvbnMnLCB0aGlzLnNpbXVsYXRvckFwcCk7XG4gICAgY29uc3QgYXJncyA9IFsnLUZuJywgc2ltdWxhdG9yQXBwXTtcbiAgICBsb2cuaW5mbyhgU3RhcnRpbmcgU2ltdWxhdG9yIFVJOiAke3V0aWwucXVvdGUoWydvcGVuJywgLi4uYXJnc10pfWApO1xuICAgIHRyeSB7XG4gICAgICBhd2FpdCBleGVjKCdvcGVuJywgYXJncywge3RpbWVvdXQ6IG9wdHMuc3RhcnR1cFRpbWVvdXR9KTtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgR290IGFuIHVuZXhwZWN0ZWQgZXJyb3Igd2hpbGUgb3BlbmluZyBTaW11bGF0b3IgVUk6IGAgK1xuICAgICAgICBlcnIuc3RkZXJyIHx8IGVyci5zdGRvdXQgfHwgZXJyLm1lc3NhZ2UpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBEaXNhYmxlIGtleWJvYXJkIHR1dG9yaWFsIGFzICdjb20uYXBwbGUua2V5Ym9hcmQucHJlZmVyZW5jZXMnIGRvbWFpbiB2aWEgJ2RlZmF1bHRzJyBjb21tYW5kLlxuICAgKi9cbiAgYXN5bmMgZGlzYWJsZUtleWJvYXJkSW50cm9kdWN0aW9uICgpIHtcbiAgICBjb25zdCBhcmdDaHVua3MgPSBnZW5lcmF0ZURlZmF1bHRzQ29tbWFuZEFyZ3Moe1xuICAgIC8vIFRvIGRpc2FibGUgJ0RpZFNob3dDb250aW51b3VzUGF0aEludHJvZHVjdGlvbicgZm9yIGlPUyAxNSsgc2ltdWxhdG9ycyBzaW5jZSBjaGFuZ2luZyB0aGUgcHJlZmVyZW5jZSB2aWEgV0RBXG4gICAgLy8gZG9lcyBub3Qgd29yayBvbiB0aGVtLiBMb3dlciB0aGFuIHRoZSB2ZXJzaW9ucyBhbHNvIGNhbiBoYXZlIHRoaXMgcHJlZmVyZW5jZSwgYnV0IG5vdGhpbmcgaGFwcGVuLlxuICAgICAgRGlkU2hvd0NvbnRpbnVvdXNQYXRoSW50cm9kdWN0aW9uOiAxXG4gICAgfSwgdHJ1ZSk7XG4gICAgYXdhaXQgQi5hbGwoYXJnQ2h1bmtzLm1hcCgoYXJncykgPT4gdGhpcy5zaW1jdGwuc3Bhd25Qcm9jZXNzKFtcbiAgICAgICdkZWZhdWx0cycsICd3cml0ZScsIERPTUFJTl9LRVlCT0FSRF9QUkVGRVJFTkNFUywgLi4uYXJnc1xuICAgIF0pKSk7XG4gIH1cblxuICAvKioqXG4gICAqIEJvb3RzIHNpbXVsYXRvciBhbmQgb3BlbnMgc2ltdWxhdG9ycyBVSSBDbGllbnQgaWYgbm90IGFscmVhZHkgb3BlbmVkLlxuICAgKlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IGlzVWlDbGllbnRSdW5uaW5nIC0gcHJvY2VzcyBpZCBvZiBzaW11bGF0b3IgVUkgY2xpZW50LlxuICAgKiBAcGFyYW0ge1J1bk9wdGlvbnN9IG9wdHMgLSBhcmd1bWVudHMgdG8gc3RhcnQgc2ltdWxhdG9yIFVJIGNsaWVudCB3aXRoLlxuICAgKi9cbiAgYXN5bmMgbGF1bmNoV2luZG93IChpc1VpQ2xpZW50UnVubmluZywgb3B0cyA9IHt9KSB7XG4gICAgYXdhaXQgdGhpcy5ib290KCk7XG4gICAgaWYgKCFpc1VpQ2xpZW50UnVubmluZykge1xuICAgICAgYXdhaXQgdGhpcy5zdGFydFVJQ2xpZW50KG9wdHMpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBCb290cyBTaW11bGF0b3IgaWYgbm90IGFscmVhZHkgYm9vdGVkLlxuICAgKiBEb2VzIG5vdGhpbmcgaWYgaXQgaXMgYWxyZWFkeSBydW5uaW5nLlxuICAgKiBUaGlzIEFQSSBkb2VzIE5PVCB3YWl0IHVudGlsIFNpbXVsYXRvciBpcyBmdWxseSBib290ZWQuXG4gICAqXG4gICAqIEB0aHJvd3Mge0Vycm9yfSBJZiB0aGVyZSB3YXMgYSBmYWlsdXJlIHdoaWxlIGJvb3RpbmcgdGhlIFNpbXVsYXRvci5cbiAgICovXG4gIGFzeW5jIGJvb3QgKCkge1xuICAgIGNvbnN0IGJvb3RFdmVudHNFbWl0dGVyID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICAgIGF3YWl0IHRoaXMuc2ltY3RsLnN0YXJ0Qm9vdE1vbml0b3Ioe1xuICAgICAgb25FcnJvcjogKGVycikgPT4gYm9vdEV2ZW50c0VtaXR0ZXIuZW1pdCgnZmFpbHVyZScsIGVyciksXG4gICAgICBvbkZpbmlzaGVkOiAoKSA9PiBib290RXZlbnRzRW1pdHRlci5lbWl0KCdmaW5pc2gnKSxcbiAgICAgIHNob3VsZFByZWJvb3Q6IHRydWUsXG4gICAgfSk7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IG5ldyBCKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgLy8gSGlzdG9yaWNhbGx5IHRoaXMgY2FsbCB3YXMgYWx3YXlzIGFzeW5jaHJvbm91cyxcbiAgICAgICAgLy8gZS5nLiBpdCB3YXMgbm90IHdhaXRpbmcgdW50aWwgU2ltdWxhdG9yIGlzIGZ1bGx5IGJvb3RlZC5cbiAgICAgICAgLy8gU28gd2UgcHJlc2VydmUgdGhhdCBiZWhhdmlvciwgYW5kIGlmIG5vIGVycm9ycyBhcmUgcmVjZWl2ZWQgZm9yIGEgd2hpbGVcbiAgICAgICAgLy8gdGhlbiB3ZSBhc3N1bWUgdGhlIFNpbXVsYXRvciBib290aW5nIGlzIHN0aWxsIGluIHByb2dyZXNzLlxuICAgICAgICBzZXRUaW1lb3V0KHJlc29sdmUsIDMwMDApO1xuICAgICAgICBib290RXZlbnRzRW1pdHRlci5vbmNlKCdmYWlsdXJlJywgKGVycikgPT4ge1xuICAgICAgICAgIGlmIChfLmluY2x1ZGVzKGVycj8ubWVzc2FnZSwgJ3N0YXRlOiBCb290ZWQnKSkge1xuICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICBib290RXZlbnRzRW1pdHRlci5vbmNlKCdmaW5pc2gnLCByZXNvbHZlKTtcbiAgICAgIH0pO1xuICAgIH0gZmluYWxseSB7XG4gICAgICBib290RXZlbnRzRW1pdHRlci5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUGVyZm9ybSB2ZXJpZmljYXRpb24gb2YgZGV2aWNlIHByZWZlcmVuY2VzIGNvcnJlY3RuZXNzLlxuICAgKlxuICAgKiBAcGFyYW0ge0RldmljZVByZWZlcmVuY2VzfSBwcmVmcyBbe31dIC0gVGhlIHByZWZlcmVuY2VzIHRvIGJlIHZlcmlmaWVkXG4gICAqIEB0aHJvd3Mge0Vycm9yfSBJZiBhbnkgb2YgdGhlIGdpdmVuIHByZWZlcmVuY2UgdmFsdWVzIGRvZXMgbm90IG1hdGNoIHRoZSBleHBlY3RlZFxuICAgKiBmb3JtYXQuXG4gICAqL1xuICB2ZXJpZnlEZXZpY2VQcmVmZXJlbmNlcyAocHJlZnMgPSB7fSkge1xuICAgIGlmIChfLmlzRW1wdHkocHJlZnMpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKCFfLmlzVW5kZWZpbmVkKHByZWZzLlNpbXVsYXRvcldpbmRvd0xhc3RTY2FsZSkpIHtcbiAgICAgIGlmICghXy5pc051bWJlcihwcmVmcy5TaW11bGF0b3JXaW5kb3dMYXN0U2NhbGUpIHx8IHByZWZzLlNpbXVsYXRvcldpbmRvd0xhc3RTY2FsZSA8PSAwKSB7XG4gICAgICAgIGxvZy5lcnJvckFuZFRocm93KGBTaW11bGF0b3JXaW5kb3dMYXN0U2NhbGUgaXMgZXhwZWN0ZWQgdG8gYmUgYSBwb3NpdGl2ZSBmbG9hdCB2YWx1ZS4gYCArXG4gICAgICAgICAgYCcke3ByZWZzLlNpbXVsYXRvcldpbmRvd0xhc3RTY2FsZX0nIGlzIGFzc2lnbmVkIGluc3RlYWQuYCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCFfLmlzVW5kZWZpbmVkKHByZWZzLlNpbXVsYXRvcldpbmRvd0NlbnRlcikpIHtcbiAgICAgIC8vIGh0dHBzOi8vcmVnZXgxMDEuY29tL3IvMlpYT2lqLzJcbiAgICAgIGNvbnN0IHZlcmlmaWNhdGlvblBhdHRlcm4gPSAvey0/XFxkKyhcXC5cXGQrKT8sLT9cXGQrKFxcLlxcZCspP30vO1xuICAgICAgaWYgKCFfLmlzU3RyaW5nKHByZWZzLlNpbXVsYXRvcldpbmRvd0NlbnRlcikgfHwgIXZlcmlmaWNhdGlvblBhdHRlcm4udGVzdChwcmVmcy5TaW11bGF0b3JXaW5kb3dDZW50ZXIpKSB7XG4gICAgICAgIGxvZy5lcnJvckFuZFRocm93KGBTaW11bGF0b3JXaW5kb3dDZW50ZXIgaXMgZXhwZWN0ZWQgdG8gbWF0Y2ggXCJ7ZmxvYXRYUG9zaXRpb24sZmxvYXRZUG9zaXRpb259XCIgZm9ybWF0ICh3aXRob3V0IHNwYWNlcykuIGAgK1xuICAgICAgICAgIGAnJHtwcmVmcy5TaW11bGF0b3JXaW5kb3dDZW50ZXJ9JyBpcyBhc3NpZ25lZCBpbnN0ZWFkLmApO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghXy5pc1VuZGVmaW5lZChwcmVmcy5TaW11bGF0b3JXaW5kb3dPcmllbnRhdGlvbikpIHtcbiAgICAgIGNvbnN0IGFjY2VwdGFibGVWYWx1ZXMgPSBbJ1BvcnRyYWl0JywgJ0xhbmRzY2FwZUxlZnQnLCAnUG9ydHJhaXRVcHNpZGVEb3duJywgJ0xhbmRzY2FwZVJpZ2h0J107XG4gICAgICBpZiAoYWNjZXB0YWJsZVZhbHVlcy5pbmRleE9mKHByZWZzLlNpbXVsYXRvcldpbmRvd09yaWVudGF0aW9uKSA9PT0gLTEpIHtcbiAgICAgICAgbG9nLmVycm9yQW5kVGhyb3coYFNpbXVsYXRvcldpbmRvd09yaWVudGF0aW9uIGlzIGV4cGVjdGVkIHRvIGJlIG9uZSBvZiAke2FjY2VwdGFibGVWYWx1ZXN9LiBgICtcbiAgICAgICAgICBgJyR7cHJlZnMuU2ltdWxhdG9yV2luZG93T3JpZW50YXRpb259JyBpcyBhc3NpZ25lZCBpbnN0ZWFkLmApO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghXy5pc1VuZGVmaW5lZChwcmVmcy5TaW11bGF0b3JXaW5kb3dSb3RhdGlvbkFuZ2xlKSkge1xuICAgICAgaWYgKCFfLmlzTnVtYmVyKHByZWZzLlNpbXVsYXRvcldpbmRvd1JvdGF0aW9uQW5nbGUpKSB7XG4gICAgICAgIGxvZy5lcnJvckFuZFRocm93KGBTaW11bGF0b3JXaW5kb3dSb3RhdGlvbkFuZ2xlIGlzIGV4cGVjdGVkIHRvIGJlIGEgdmFsaWQgbnVtYmVyLiBgICtcbiAgICAgICAgICBgJyR7cHJlZnMuU2ltdWxhdG9yV2luZG93Um90YXRpb25BbmdsZX0nIGlzIGFzc2lnbmVkIGluc3RlYWQuYCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSB0aGUgY29tbW9uIGlPUyBTaW11bGF0b3IgcHJlZmVyZW5jZXMgZmlsZSB3aXRoIG5ldyB2YWx1ZXMuXG4gICAqIEl0IGlzIG5lY2Vzc2FyeSB0byByZXN0YXJ0IHRoZSBjb3JyZXNwb25kaW5nIFNpbXVsYXRvciBiZWZvcmVcbiAgICogdGhlc2UgY2hhbmdlcyBhcmUgYXBwbGllZC5cbiAgICpcbiAgICogQHBhcmFtIHtEZXZpY2VQcmVmZXJlbmNlc30gZGV2aWNlUHJlZnMgW3t9XSAtIFRoZSBtYXBwaW5nLCB3aGljaCByZXByZXNlbnRzIG5ldyBkZXZpY2UgcHJlZmVyZW5jZSB2YWx1ZXNcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciB0aGUgZ2l2ZW4gU2ltdWxhdG9yLlxuICAgKiBAcGFyYW0ge0NvbW1vblByZWZlcmVuY2VzfSBjb21tb25QcmVmcyBbe31dIC0gVGhlIG1hcHBpbmcsIHdoaWNoIHJlcHJlc2VudHMgbmV3IGNvbW1vbiBwcmVmZXJlbmNlIHZhbHVlc1xuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGFsbCBTaW11bGF0b3JzLlxuICAgKiBAcmV0dXJuIHtib29sZWFufSBUcnVlIGlmIHRoZSBwcmVmZXJlbmNlcyB3ZXJlIHN1Y2Nlc3NmdWxseSB1cGRhdGVkLlxuICAgKi9cbiAgYXN5bmMgdXBkYXRlUHJlZmVyZW5jZXMgKGRldmljZVByZWZzID0ge30sIGNvbW1vblByZWZzID0ge30pIHtcbiAgICBpZiAoIV8uaXNFbXB0eShkZXZpY2VQcmVmcykpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgU2V0dGluZyBwcmVmZXJlbmNlcyBvZiAke3RoaXMudWRpZH0gU2ltdWxhdG9yIHRvICR7SlNPTi5zdHJpbmdpZnkoZGV2aWNlUHJlZnMpfWApO1xuICAgIH1cbiAgICBpZiAoIV8uaXNFbXB0eShjb21tb25QcmVmcykpIHtcbiAgICAgIGxvZy5kZWJ1ZyhgU2V0dGluZyBjb21tb24gU2ltdWxhdG9yIHByZWZlcmVuY2VzIHRvICR7SlNPTi5zdHJpbmdpZnkoY29tbW9uUHJlZnMpfWApO1xuICAgIH1cbiAgICBjb25zdCBob21lRm9sZGVyUGF0aCA9IHByb2Nlc3MuZW52LkhPTUU7XG4gICAgaWYgKCFob21lRm9sZGVyUGF0aCkge1xuICAgICAgbG9nLndhcm4oYENhbm5vdCBnZXQgdGhlIHBhdGggdG8gSE9NRSBmb2xkZXIgZnJvbSB0aGUgcHJvY2VzcyBlbnZpcm9ubWVudC4gYCArXG4gICAgICAgIGBJZ25vcmluZyBTaW11bGF0b3IgcHJlZmVyZW5jZXMgdXBkYXRlLmApO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICB0aGlzLnZlcmlmeURldmljZVByZWZlcmVuY2VzKGRldmljZVByZWZzKTtcbiAgICBjb25zdCBwbGlzdFBhdGggPSBwYXRoLnJlc29sdmUoaG9tZUZvbGRlclBhdGgsICdMaWJyYXJ5JywgJ1ByZWZlcmVuY2VzJywgJ2NvbS5hcHBsZS5pcGhvbmVzaW11bGF0b3IucGxpc3QnKTtcbiAgICByZXR1cm4gYXdhaXQgcHJlZmVyZW5jZXNQbGlzdEd1YXJkLmFjcXVpcmUoU2ltdWxhdG9yWGNvZGU5Lm5hbWUsIGFzeW5jICgpID0+IHtcbiAgICAgIGNvbnN0IGRlZmF1bHRzID0gbmV3IE5TVXNlckRlZmF1bHRzKHBsaXN0UGF0aCk7XG4gICAgICBjb25zdCBwcmVmc1RvVXBkYXRlID0gXy5jbG9uZShjb21tb25QcmVmcyk7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoIV8uaXNFbXB0eShkZXZpY2VQcmVmcykpIHtcbiAgICAgICAgICBsZXQgZXhpc3RpbmdEZXZpY2VQcmVmcztcbiAgICAgICAgICBjb25zdCB1ZGlkS2V5ID0gdGhpcy51ZGlkLnRvVXBwZXJDYXNlKCk7XG4gICAgICAgICAgaWYgKGF3YWl0IGZzLmV4aXN0cyhwbGlzdFBhdGgpKSB7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50UGxpc3RDb250ZW50ID0gYXdhaXQgZGVmYXVsdHMuYXNKc29uKCk7XG4gICAgICAgICAgICBpZiAoXy5pc1BsYWluT2JqZWN0KGN1cnJlbnRQbGlzdENvbnRlbnQuRGV2aWNlUHJlZmVyZW5jZXMpXG4gICAgICAgICAgICAgICAgJiYgXy5pc1BsYWluT2JqZWN0KGN1cnJlbnRQbGlzdENvbnRlbnQuRGV2aWNlUHJlZmVyZW5jZXNbdWRpZEtleV0pKSB7XG4gICAgICAgICAgICAgIGV4aXN0aW5nRGV2aWNlUHJlZnMgPSBjdXJyZW50UGxpc3RDb250ZW50LkRldmljZVByZWZlcmVuY2VzW3VkaWRLZXldO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBPYmplY3QuYXNzaWduKHByZWZzVG9VcGRhdGUsIHtcbiAgICAgICAgICAgIERldmljZVByZWZlcmVuY2VzOiB7XG4gICAgICAgICAgICAgIFt1ZGlkS2V5XTogT2JqZWN0LmFzc2lnbih7fSwgZXhpc3RpbmdEZXZpY2VQcmVmcyB8fCB7fSwgZGV2aWNlUHJlZnMpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgZGVmYXVsdHMudXBkYXRlKHByZWZzVG9VcGRhdGUpO1xuICAgICAgICBsb2cuZGVidWcoYFVwZGF0ZWQgJHt0aGlzLnVkaWR9IFNpbXVsYXRvciBwcmVmZXJlbmNlcyBhdCAnJHtwbGlzdFBhdGh9JyB3aXRoIGAgK1xuICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHByZWZzVG9VcGRhdGUpKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGxvZy53YXJuKGBDYW5ub3QgdXBkYXRlICR7dGhpcy51ZGlkfSBTaW11bGF0b3IgcHJlZmVyZW5jZXMgYXQgJyR7cGxpc3RQYXRofScuIGAgK1xuICAgICAgICAgIGBUcnkgdG8gZGVsZXRlIHRoZSBmaWxlIG1hbnVhbGx5IGluIG9yZGVyIHRvIHJlc2V0IGl0LiBPcmlnaW5hbCBlcnJvcjogJHtlLm1lc3NhZ2V9YCk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXNldCB0aGUgY3VycmVudCBTaW11bGF0b3IgdG8gdGhlIGNsZWFuIHN0YXRlLlxuICAgKiBAb3ZlcnJpZGVcbiAgICovXG4gIGFzeW5jIGNsZWFuICgpIHtcbiAgICBsb2cuaW5mbyhgQ2xlYW5pbmcgc2ltdWxhdG9yICR7dGhpcy51ZGlkfWApO1xuICAgIGF3YWl0IHRoaXMuc2ltY3RsLmVyYXNlRGV2aWNlKDEwMDAwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAaW5oZXJpdGRvY1xuICAgKiBAb3ZlcnJpZGVcbiAgICogQHByaXZhdGVcbiAgICovXG4gIGFzeW5jIF9hY3RpdmF0ZVdpbmRvdyAoKSB7XG4gICAgbGV0IHNlbGZOYW1lO1xuICAgIGxldCBzZWxmU2RrO1xuICAgIGxldCBib290ZWREZXZpY2VzQ291bnQgPSAwO1xuICAgIGZvciAoY29uc3QgW3NkaywgZGV2aWNlQXJyXSBvZiBfLnRvUGFpcnMoYXdhaXQgdGhpcy5zaW1jdGwuZ2V0RGV2aWNlcygpKSkge1xuICAgICAgZm9yIChjb25zdCB7c3RhdGUsIHVkaWQsIG5hbWV9IG9mIGRldmljZUFycikge1xuICAgICAgICBpZiAoc3RhdGUgPT09ICdCb290ZWQnKSB7XG4gICAgICAgICAgYm9vdGVkRGV2aWNlc0NvdW50Kys7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzZWxmTmFtZSAmJiB1ZGlkID09PSB0aGlzLnVkaWQpIHtcbiAgICAgICAgICBzZWxmU2RrID0gc2RrO1xuICAgICAgICAgIHNlbGZOYW1lID0gbmFtZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAoYm9vdGVkRGV2aWNlc0NvdW50IDwgMikge1xuICAgICAgcmV0dXJuIGF3YWl0IHN1cGVyLl9hY3RpdmF0ZVdpbmRvdygpO1xuICAgIH1cblxuICAgIC8vIFRoZXJlIGFyZSBwb3RlbnRpYWxseSBtb3JlIHRoYXQgb25lIFNpbXVsYXRvciB3aW5kb3dcbiAgICByZXR1cm4gYFxuICAgICAgdGVsbCBhcHBsaWNhdGlvbiBcIlN5c3RlbSBFdmVudHNcIlxuICAgICAgICB0ZWxsIHByb2Nlc3MgXCJTaW11bGF0b3JcIlxuICAgICAgICAgIHNldCBmcm9udG1vc3QgdG8gZmFsc2VcbiAgICAgICAgICBzZXQgZnJvbnRtb3N0IHRvIHRydWVcbiAgICAgICAgICBjbGljayAobWVudSBpdGVtIDEgd2hlcmUgKGl0cyBuYW1lIGNvbnRhaW5zIFwiJHtzZWxmTmFtZX0gXCIgYW5kIGl0cyBuYW1lIGNvbnRhaW5zIFwiJHtzZWxmU2RrfVwiKSkgb2YgbWVudSAxIG9mIG1lbnUgYmFyIGl0ZW0gXCJXaW5kb3dcIiBvZiBtZW51IGJhciAxXG4gICAgICAgIGVuZCB0ZWxsXG4gICAgICBlbmQgdGVsbFxuICAgIGA7XG4gIH1cblxuICAvKipcbiAgICogQGluaGVyaXRkb2NcbiAgICogQG92ZXJyaWRlXG4gICAqL1xuICBhc3luYyBpc0Jpb21ldHJpY0Vucm9sbGVkICgpIHtcbiAgICBjb25zdCB7c3Rkb3V0fSA9IGF3YWl0IHRoaXMuc2ltY3RsLnNwYXduUHJvY2VzcyhbXG4gICAgICAnbm90aWZ5dXRpbCcsXG4gICAgICAnLWcnLCBFTlJPTExNRU5UX05PVElGSUNBVElPTl9SRUNFSVZFUlxuICAgIF0pO1xuICAgIGNvbnN0IG1hdGNoID0gKG5ldyBSZWdFeHAoYCR7Xy5lc2NhcGVSZWdFeHAoRU5ST0xMTUVOVF9OT1RJRklDQVRJT05fUkVDRUlWRVIpfVxcXFxzKyhbMDFdKWApKVxuICAgICAgLmV4ZWMoc3Rkb3V0KTtcbiAgICBpZiAoIW1hdGNoKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCBwYXJzZSBiaW9tZXRyaWMgZW5yb2xsbWVudCBzdGF0ZSBmcm9tICcke3N0ZG91dH0nYCk7XG4gICAgfVxuICAgIGxvZy5pbmZvKGBDdXJyZW50IGJpb21ldHJpYyBlbnJvbGxlZCBzdGF0ZSBmb3IgJHt0aGlzLnVkaWR9IFNpbXVsYXRvcjogJHttYXRjaFsxXX1gKTtcbiAgICByZXR1cm4gbWF0Y2hbMV0gPT09ICcxJztcbiAgfVxuXG4gIC8qKlxuICAgKiBAaW5oZXJpdGRvY1xuICAgKiBAb3ZlcnJpZGVcbiAgICovXG4gIGFzeW5jIGVucm9sbEJpb21ldHJpYyAoaXNFbmFibGVkID0gdHJ1ZSkge1xuICAgIGxvZy5kZWJ1ZyhgU2V0dGluZyBiaW9tZXRyaWMgZW5yb2xsZWQgc3RhdGUgZm9yICR7dGhpcy51ZGlkfSBTaW11bGF0b3IgdG8gJyR7aXNFbmFibGVkID8gJ2VuYWJsZWQnIDogJ2Rpc2FibGVkJ30nYCk7XG4gICAgYXdhaXQgdGhpcy5zaW1jdGwuc3Bhd25Qcm9jZXNzKFtcbiAgICAgICdub3RpZnl1dGlsJyxcbiAgICAgICctcycsIEVOUk9MTE1FTlRfTk9USUZJQ0FUSU9OX1JFQ0VJVkVSLCBpc0VuYWJsZWQgPyAnMScgOiAnMCdcbiAgICBdKTtcbiAgICBhd2FpdCB0aGlzLnNpbWN0bC5zcGF3blByb2Nlc3MoW1xuICAgICAgJ25vdGlmeXV0aWwnLFxuICAgICAgJy1wJywgRU5ST0xMTUVOVF9OT1RJRklDQVRJT05fUkVDRUlWRVJcbiAgICBdKTtcbiAgICBpZiAoYXdhaXQgdGhpcy5pc0Jpb21ldHJpY0Vucm9sbGVkKCkgIT09IGlzRW5hYmxlZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBDYW5ub3Qgc2V0IGJpb21ldHJpYyBlbnJvbGxlZCBzdGF0ZSBmb3IgJHt0aGlzLnVkaWR9IFNpbXVsYXRvciB0byAnJHtpc0VuYWJsZWQgPyAnZW5hYmxlZCcgOiAnZGlzYWJsZWQnfSdgKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogU2VuZHMgYSBub3RpZmljYXRpb24gdG8gbWF0Y2gvbm90IG1hdGNoIHRoZSBwYXJ0aWN1bGFyIGJpb21ldHJpYy5cbiAgICogQG92ZXJyaWRlXG4gICAqXG4gICAqIEBwYXJhbSB7P2Jvb2xlYW59IHNob3VsZE1hdGNoIFt0cnVlXSAtIFNldCBpdCB0byB0cnVlIG9yIGZhbHNlIGluIG9yZGVyIHRvIGVtdWxhdGVcbiAgICogbWF0Y2hpbmcvbm90IG1hdGNoaW5nIHRoZSBjb3JyZXNwb25kaW5nIGJpb21ldHJpY1xuICAgKiBAcGFyYW0gez9zdHJpbmd9IGJpb21ldHJpY05hbWUgW3RvdWNoSWRdIC0gRWl0aGVyIHRvdWNoSWQgb3IgZmFjZUlkIChmYWNlSWQgaXMgb25seSBhdmFpbGFibGUgc2luY2UgaU9TIDExKVxuICAgKi9cbiAgYXN5bmMgc2VuZEJpb21ldHJpY01hdGNoIChzaG91bGRNYXRjaCA9IHRydWUsIGJpb21ldHJpY05hbWUgPSAndG91Y2hJZCcpIHtcbiAgICBjb25zdCBkb21haW5Db21wb25lbnQgPSB0b0Jpb21ldHJpY0RvbWFpbkNvbXBvbmVudChiaW9tZXRyaWNOYW1lKTtcbiAgICBjb25zdCBkb21haW4gPSBgY29tLmFwcGxlLkJpb21ldHJpY0tpdF9TaW0uJHtkb21haW5Db21wb25lbnR9LiR7c2hvdWxkTWF0Y2ggPyAnJyA6ICdubyd9bWF0Y2hgO1xuICAgIGF3YWl0IHRoaXMuc2ltY3RsLnNwYXduUHJvY2VzcyhbXG4gICAgICAnbm90aWZ5dXRpbCcsXG4gICAgICAnLXAnLCBkb21haW5cbiAgICBdKTtcbiAgICBsb2cuaW5mbyhgU2VudCBub3RpZmljYXRpb24gJHtkb21haW59IHRvICR7c2hvdWxkTWF0Y2ggPyAnbWF0Y2gnIDogJ25vdCBtYXRjaCd9ICR7YmlvbWV0cmljTmFtZX0gYmlvbWV0cmljIGAgK1xuICAgICAgYGZvciAke3RoaXMudWRpZH0gU2ltdWxhdG9yYCk7XG4gIH1cblxuICAvKipcbiAgICogQG92ZXJyaWRlXG4gICAqL1xuICBhc3luYyBnZXRMYXVuY2hEYWVtb25zUm9vdCAoKSB7XG4gICAgY29uc3QgZGV2Um9vdCA9IGF3YWl0IGdldERldmVsb3BlclJvb3QoKTtcbiAgICByZXR1cm4gcGF0aC5yZXNvbHZlKGRldlJvb3QsXG4gICAgICAnUGxhdGZvcm1zL2lQaG9uZU9TLnBsYXRmb3JtL0RldmVsb3Blci9MaWJyYXJ5L0NvcmVTaW11bGF0b3IvUHJvZmlsZXMvUnVudGltZXMvaU9TLnNpbXJ1bnRpbWUvQ29udGVudHMvUmVzb3VyY2VzL1J1bnRpbWVSb290L1N5c3RlbS9MaWJyYXJ5L0xhdW5jaERhZW1vbnMnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAdHlwZWRlZiB7T2JqZWN0fSBLZXlib2FyZE9wdGlvbnNcbiAgICogQHByb3BlcnR5IHshc3RyaW5nfSBuYW1lIFRoZSBuYW1lIG9mIHRoZSBrZXlib2FyZCBsb2NhbGUsIGZvciBleGFtcGxlIGBlbl9VU2Agb3IgYGRlX0NIYFxuICAgKiBAcHJvcGVydHkgeyFzdHJpbmd9IGxheW91dCBUaGUga2V5Ym9hcmQgbGF5b3V0LCBmb3IgZXhhbXBsZSBgUVVFUlRZYCBvciBgVWtyYWluaWFuYFxuICAgKiBAcHJvcGVydHkgez9zdHJpbmd9IGhhcmR3YXJlIENvdWxkIGVpdGhlciBiZSBgQXV0b21hdGljYCBvciBgbnVsbGBcbiAgICovXG5cbiAgLyoqXG4gICAqIEB0eXBlZGVmIHtPYmplY3R9IExhbmd1YWdlT3B0aW9uc1xuICAgKiBAcHJvcGVydHkgeyFzdHJpbmd9IG5hbWUgVGhlIG5hbWUgb2YgdGhlIGxhbmd1YWdlLCBmb3IgZXhhbXBsZSBgZGVgIG9yIGB6aC1IYW50LUNOYFxuICAgKi9cblxuICAvKipcbiAgICogQHR5cGVkZWYge09iamVjdH0gTG9jYWxlT3B0aW9uc1xuICAgKiBAcHJvcGVydHkgeyFzdHJpbmd9IG5hbWUgVGhlIG5hbWUgb2YgdGhlIHN5c3RlbSBsb2NhbGUsIGZvciBleGFtcGxlIGBkZV9DSGAgb3IgYHpoX0NOYFxuICAgKiBAcHJvcGVydHkgez9zdHJpbmd9IGNhbGVuZGFyIE9wdGlvbmFsIGNhbGVuZGFyIGZvcm1hdCwgZm9yIGV4YW1wbGUgYGdyZWdvcmlhbmAgb3IgYHBlcnNpYW5gXG4gICAqL1xuXG4gIC8qKlxuICAgKiBAdHlwZWRlZiB7T2JqZWN0fSBMb2NhbGl6YXRpb25PcHRpb25zXG4gICAqIEBwcm9wZXJ0eSB7P0tleWJvYXJkT3B0aW9uc30ga2V5Ym9hcmRcbiAgICogQHByb3BlcnR5IHs/TGFuZ3VhZ2VPcHRpb25zfSBsYW5ndWFnZVxuICAgKiBAcHJvcGVydHkgez9Mb2NhbGVPcHRpb25zfSBsb2NhbGVcbiAgICovXG5cbiAgLyoqXG4gICAqIENoYW5nZSBsb2NhbGl6YXRpb24gc2V0dGluZ3Mgb24gdGhlIGN1cnJlbnRseSBib290ZWQgc2ltdWxhdG9yXG4gICAqXG4gICAqIEBwYXJhbSB7P0xvY2FsaXphdGlvbk9wdGlvbnN9IG9wdHNcbiAgICogQHRocm93cyB7RXJyb3J9IElmIHRoZXJlIHdhcyBhIGZhaWx1cmUgd2hpbGUgc2V0dGluZyB0aGUgcHJlZmVyZW5jZXNcbiAgICogQHJldHVybnMge2Jvb2xlYW59IGB0cnVlYCBpZiBhbnkgb2Ygc2V0dGluZ3MgaGFzIGJlZW4gc3VjY2Vzc2Z1bGx5IGNoYW5nZWRcbiAgICovXG4gIGFzeW5jIGNvbmZpZ3VyZUxvY2FsaXphdGlvbiAob3B0cyA9IHt9KSB7XG4gICAgaWYgKF8uaXNFbXB0eShvcHRzKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGNvbnN0IHsgbGFuZ3VhZ2UsIGxvY2FsZSwga2V5Ym9hcmQgfSA9IG9wdHM7XG4gICAgY29uc3QgZ2xvYmFsUHJlZnMgPSB7fTtcbiAgICBsZXQga2V5Ym9hcmRJZCA9IG51bGw7XG4gICAgaWYgKF8uaXNQbGFpbk9iamVjdChrZXlib2FyZCkpIHtcbiAgICAgIGNvbnN0IHsgbmFtZSwgbGF5b3V0LCBoYXJkd2FyZSB9ID0ga2V5Ym9hcmQ7XG4gICAgICBpZiAoIW5hbWUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgJ2tleWJvYXJkJyBmaWVsZCBtdXN0IGhhdmUgYSB2YWxpZCBuYW1lIHNldGApO1xuICAgICAgfVxuICAgICAgaWYgKCFsYXlvdXQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgJ2tleWJvYXJkJyBmaWVsZCBtdXN0IGhhdmUgYSB2YWxpZCBsYXlvdXQgc2V0YCk7XG4gICAgICB9XG4gICAgICBrZXlib2FyZElkID0gYCR7bmFtZX1Ac3c9JHtsYXlvdXR9YDtcbiAgICAgIGlmIChoYXJkd2FyZSkge1xuICAgICAgICBrZXlib2FyZElkICs9IGA7QGh3PSR7aGFyZHdhcmV9YDtcbiAgICAgIH1cbiAgICAgIGdsb2JhbFByZWZzLkFwcGxlS2V5Ym9hcmRzID0gW2tleWJvYXJkSWRdO1xuICAgIH1cbiAgICBpZiAoXy5pc1BsYWluT2JqZWN0KGxhbmd1YWdlKSkge1xuICAgICAgY29uc3QgeyBuYW1lIH0gPSBsYW5ndWFnZTtcbiAgICAgIGlmICghbmFtZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFRoZSAnbGFuZ3VhZ2UnIGZpZWxkIG11c3QgaGF2ZSBhIHZhbGlkIG5hbWUgc2V0YCk7XG4gICAgICB9XG4gICAgICBnbG9iYWxQcmVmcy5BcHBsZUxhbmd1YWdlcyA9IFtuYW1lXTtcbiAgICB9XG4gICAgaWYgKF8uaXNQbGFpbk9iamVjdChsb2NhbGUpKSB7XG4gICAgICBjb25zdCB7IG5hbWUsIGNhbGVuZGFyIH0gPSBsb2NhbGU7XG4gICAgICBpZiAoIW5hbWUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBUaGUgJ2xvY2FsZScgZmllbGQgbXVzdCBoYXZlIGEgdmFsaWQgbmFtZSBzZXRgKTtcbiAgICAgIH1cbiAgICAgIGxldCBsb2NhbGVJZCA9IG5hbWU7XG4gICAgICBpZiAoY2FsZW5kYXIpIHtcbiAgICAgICAgbG9jYWxlSWQgKz0gYEBjYWxlbmRhcj0ke2NhbGVuZGFyfWA7XG4gICAgICB9XG4gICAgICBnbG9iYWxQcmVmcy5BcHBsZUxvY2FsZSA9IGxvY2FsZUlkO1xuICAgIH1cbiAgICBpZiAoXy5pc0VtcHR5KGdsb2JhbFByZWZzKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGNvbnN0IGFyZ0NodW5rcyA9IGdlbmVyYXRlRGVmYXVsdHNDb21tYW5kQXJncyhnbG9iYWxQcmVmcywgdHJ1ZSk7XG4gICAgYXdhaXQgQi5hbGwoYXJnQ2h1bmtzLm1hcCgoYXJncykgPT4gdGhpcy5zaW1jdGwuc3Bhd25Qcm9jZXNzKFtcbiAgICAgICdkZWZhdWx0cycsICd3cml0ZScsICcuR2xvYmFsUHJlZmVyZW5jZXMucGxpc3QnLCAuLi5hcmdzXG4gICAgXSkpKTtcblxuICAgIGlmIChrZXlib2FyZElkKSB7XG4gICAgICBjb25zdCBhcmdDaHVua3MgPSBnZW5lcmF0ZURlZmF1bHRzQ29tbWFuZEFyZ3Moe1xuICAgICAgICBLZXlib2FyZHNDdXJyZW50QW5kTmV4dDogW2tleWJvYXJkSWRdLFxuICAgICAgICBLZXlib2FyZExhc3RVc2VkOiBrZXlib2FyZElkLFxuICAgICAgICBLZXlib2FyZExhc3RVc2VkRm9yTGFuZ3VhZ2U6IHsgW2tleWJvYXJkLm5hbWVdOiBrZXlib2FyZElkIH1cbiAgICAgIH0sIHRydWUpO1xuICAgICAgYXdhaXQgQi5hbGwoYXJnQ2h1bmtzLm1hcCgoYXJncykgPT4gdGhpcy5zaW1jdGwuc3Bhd25Qcm9jZXNzKFtcbiAgICAgICAgJ2RlZmF1bHRzJywgJ3dyaXRlJywgJ2NvbS5hcHBsZS5QcmVmZXJlbmNlcycsIC4uLmFyZ3NcbiAgICAgIF0pKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRydWU7XG4gIH1cblxufVxuXG5leHBvcnQgZGVmYXVsdCBTaW11bGF0b3JYY29kZTk7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUEsTUFBTUEsMEJBQTBCLEdBQUcsS0FBSyxJQUF4QztBQUNBLE1BQU1DLFdBQVcsR0FBRyxJQUFJQyxrQkFBSixFQUFwQjtBQUNBLE1BQU1DLHFCQUFxQixHQUFHLElBQUlELGtCQUFKLEVBQTlCO0FBQ0EsTUFBTUUsZ0NBQWdDLEdBQUcsMENBQXpDO0FBQ0EsTUFBTUMsMkJBQTJCLEdBQUcsZ0NBQXBDOztBQVVBLFNBQVNDLDJCQUFULENBQXNDQyxJQUFJLEdBQUcsRUFBN0MsRUFBaUQ7RUFDL0MsTUFBTTtJQUNKQyx1QkFESTtJQUVKQyxZQUZJO0lBR0pDLHVCQUhJO0lBSUpDO0VBSkksSUFLRkosSUFMSjtFQU1BLE1BQU1LLGlCQUFpQixHQUFHO0lBR3hCQywrQkFBK0IsRUFBRSxJQUhUO0lBS3hCQyx1QkFBdUIsRUFBRSxL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
