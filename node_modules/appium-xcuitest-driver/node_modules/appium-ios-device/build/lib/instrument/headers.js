"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.FLAG_TYPES = exports.DTX_MESSAGE_PAYLOAD_HEADER_LENGTH = exports.DTX_MESSAGE_HEADER_MAGIC_LEN = exports.DTX_MESSAGE_HEADER_MAGIC = exports.DTX_MESSAGE_HEADER_LENGTH = exports.DTXMessagePayloadHeader = exports.DTXMessageHeader = exports.DTXMessageAuxBuffer = exports.DTXMessageAux = exports.DTXMessage = void 0;

require("source-map-support/register");

var _nskeyed = require("./transformer/nskeyed");

var _bplistParser = _interopRequireDefault(require("bplist-parser"));

var _lodash = _interopRequireDefault(require("lodash"));

const DTX_MESSAGE_PAYLOAD_HEADER_LENGTH = 16;
exports.DTX_MESSAGE_PAYLOAD_HEADER_LENGTH = DTX_MESSAGE_PAYLOAD_HEADER_LENGTH;
const DTX_MESSAGE_HEADER_LENGTH = 32;
exports.DTX_MESSAGE_HEADER_LENGTH = DTX_MESSAGE_HEADER_LENGTH;
const DTX_MESSAGE_HEADER_MAGIC = 0x1F3D5B79;
exports.DTX_MESSAGE_HEADER_MAGIC = DTX_MESSAGE_HEADER_MAGIC;
const DTX_MESSAGE_HEADER_MAGIC_LEN = 4;
exports.DTX_MESSAGE_HEADER_MAGIC_LEN = DTX_MESSAGE_HEADER_MAGIC_LEN;
const DTX_MESSAGE_AUX_HEADER = 0x01F0;
const DTX_AUXILIARY_MAGIC = 0xa;
const FLAG_TYPES = Object.freeze({
  recv: 1,
  send: 2,
  reply: 3
});
exports.FLAG_TYPES = FLAG_TYPES;
const AUX_TYPES = Object.freeze({
  NSKeyed: 2,
  UInt32LE: 3,
  BigUInt64LE: 4,
  BigInt64LE: 6
});

class DTXMessageHeader {
  static build(data) {
    const messageHeader = Buffer.alloc(DTX_MESSAGE_HEADER_LENGTH);
    messageHeader.writeUInt32LE(DTX_MESSAGE_HEADER_MAGIC, 0);
    messageHeader.writeUInt32LE(DTX_MESSAGE_HEADER_LENGTH, 4);
    messageHeader.writeUInt16LE(0, 8);
    messageHeader.writeUInt16LE(1, 10);
    messageHeader.writeUInt32LE(data.payloadLength, 12);
    messageHeader.writeUInt32LE(data.identifier, 16);
    messageHeader.writeUInt32LE(data.conversationIndex, 20);
    messageHeader.writeUInt32LE(data.channelCode, 24);
    messageHeader.writeUInt32LE(data.expectsReply, 28);
    return messageHeader;
  }

  static parse(headerBuffer) {
    return {
      magic: headerBuffer.readUInt32LE(0),
      headerLength: headerBuffer.readUInt32LE(4),
      fragmentId: headerBuffer.readUInt16LE(8),
      fragmentCount: headerBuffer.readUInt16LE(10),
      payloadLength: headerBuffer.readUInt32LE(12),
      identifier: headerBuffer.readUInt32LE(16),
      conversationIndex: headerBuffer.readUInt32LE(20),
      channel: headerBuffer.readUInt32LE(24),
      expectsReply: headerBuffer.readUInt32LE(28)
    };
  }

}

exports.DTXMessageHeader = DTXMessageHeader;

class DTXMessagePayloadHeader {
  static build(data) {
    const messageHeader = Buffer.alloc(DTX_MESSAGE_PAYLOAD_HEADER_LENGTH);
    messageHeader.writeUInt32LE(data.flags, 0);
    messageHeader.writeUInt32LE(data.auxLength, 4);
    messageHeader.writeBigUInt64LE(data.totalLength, 8);
    return messageHeader;
  }

  static parse(headerBuffer) {
    return {
      flags: headerBuffer.readUInt32LE(0),
      auxLength: headerBuffer.readUInt32LE(4),
      totalLength: headerBuffer.readBigInt64LE(8)
    };
  }

}

exports.DTXMessagePayloadHeader = DTXMessagePayloadHeader;

class DTXMessageAux {
  constructor(data = []) {
    this.data = data;
  }

  build() {
    const messageAux = new DTXMessageAuxBuffer();
    let buf = Buffer.alloc(0);

    if (this.data.length === 0) {
      return buf;
    }

    for (const arg of this.data) {
      if (arg instanceof DTXMessageAuxBuffer) {
        buf = Buffer.concat([buf, arg.getBytes()]);
      } else if (_lodash.default.isNumber(arg)) {
        messageAux.appendInt(arg);
      } else if (typeof arg == 'bigint') {
        messageAux.appendLong(arg);
      } else {
        messageAux.appendObject(arg);
      }
    }

    return Buffer.concat([buf, messageAux.getBytes()]);
  }

  static parse(headerBuffer) {
    let cursor = 0;
    const data = [];
    const length = headerBuffer.readBigInt64LE(8);
    cursor += 16;

    while (cursor <= length) {
      const m = headerBuffer.readUInt32LE(cursor);

      if (m !== DTX_AUXILIARY_MAGIC) {
        throw new Error(`incorrect auxiliary magic: ${m}`);
      }

      const type = headerBuffer.readUInt32LE(cursor + 4);
      cursor += 8;

      switch (type) {
        case AUX_TYPES.NSKeyed:
          {
            const strLen = headerBuffer.readUInt32LE(cursor);
            cursor += 4;
            const archived_data = headerBuffer.slice(cursor, cursor + strLen);
            data.push((0, _nskeyed.unarchive)(archived_data));
            cursor += strLen;
            break;
          }

        case AUX_TYPES.UInt32LE:
          data.push(headerBuffer.readUInt32LE(cursor));
          cursor += 4;
          break;

        case AUX_TYPES.BigUInt64LE:
          data.push(headerBuffer.readBigUInt64LE(cursor));
          cursor += 8;
          break;

        case AUX_TYPES.BigInt64LE:
          data.push(headerBuffer.readBigInt64LE(cursor));
          cursor += 8;
          break;

        default:
          throw new Error(`Unknown type ${type}`);
      }
    }

    return data;
  }

}

exports.DTXMessageAux = DTXMessageAux;

class InstrumentRPCParseError {
  constructor(data) {
    this.data = data;
  }

}

class DTXMessageAuxBuffer {
  constructor() {
    this._buf = Buffer.alloc(0);
  }

  appendInt(value) {
    const buf = Buffer.alloc(12);
    buf.writeUInt32LE(DTX_AUXILIARY_MAGIC, 0);
    buf.writeUInt32LE(3, 4);
    buf.writeUInt32LE(value, 8);
    this._buf = Buffer.concat([this._buf, buf]);
  }

  appendLong(value) {
    const buf = Buffer.alloc(16);
    buf.writeUInt32LE(DTX_AUXILIARY_MAGIC, 0);
    buf.writeUInt32LE(4, 4);
    buf.writeBigUInt64LE(value, 8);
    this._buf = Buffer.concat([this._buf, buf]);
  }

  appendSignedInt(value) {
    const buf = Buffer.alloc(12);
    buf.writeUInt32LE(DTX_AUXILIARY_MAGIC, 0);
    buf.writeUInt32LE(3, 4);
    buf.writeInt32LE(value, 8);
    this._buf = Buffer.concat([this._buf, buf]);
  }

  appendSignedLong(value) {
    const buf = Buffer.alloc(16);

    this._buf.writeUInt32LE(DTX_AUXILIARY_MAGIC, 0);

    this._buf.writeUInt32LE(6, 4);

    this._buf.writeBigInt64LE(value, 8);

    this._buf = Buffer.concat([this._buf, buf]);
  }

  appendObject(value) {
    const buf = (0, _nskeyed.archive)(value);
    const buf2 = Buffer.alloc(12);
    buf2.writeUInt32LE(DTX_AUXILIARY_MAGIC, 0);
    buf2.writeUInt32LE(2, 4);
    buf2.writeUInt32LE(buf.length, 8);
    this._buf = Buffer.concat([this._buf, buf2, buf]);
  }

  getBytes() {
    const out = Buffer.alloc(16);
    out.writeUInt32LE(DTX_MESSAGE_AUX_HEADER, 0);
    out.writeUInt32LE(this._buf.length, 8);
    return Buffer.concat([out, this._buf]);
  }

}

exports.DTXMessageAuxBuffer = DTXMessageAuxBuffer;

class DTXMessage {
  constructor(opts = {}) {
    const {
      identifier,
      channelCode,
      selector,
      expectsReply,
      conversationIndex = 0,
      flags = FLAG_TYPES.send
    } = opts;
    this._messageHeader = undefined;
    this._payloadHeader = undefined;
    this._identifier = identifier;
    this._channelCode = channelCode;
    this._expectsReply = expectsReply;
    this._selector = selector;
    this._conversationIndex = conversationIndex;
    this._flags = flags;
    this.auxiliaries = new DTXMessageAux();
  }

  get identifier() {
    var _this$_messageHeader;

    return (_this$_messageHeader = this._messageHeader) === null || _this$_messageHeader === void 0 ? void 0 : _this$_messageHeader.identifier;
  }

  get channelCode() {
    var _this$_messageHeader2;

    return (_this$_messageHeader2 = this._messageHeader) === null || _this$_messageHeader2 === void 0 ? void 0 : _this$_messageHeader2.channel;
  }

  get expectsReply() {
    var _this$_messageHeader3;

    return (_this$_messageHeader3 = this._messageHeader) === null || _this$_messageHeader3 === void 0 ? void 0 : _this$_messageHeader3.expectsReply;
  }

  get selector() {
    return this._selector;
  }

  set selector(data) {
    this._selector = data;
  }

  get conversationIndex() {
    var _this$_messageHeader4;

    return (_this$_messageHeader4 = this._messageHeader) === null || _this$_messageHeader4 === void 0 ? void 0 : _this$_messageHeader4.conversationIndex;
  }

  build() {
    const sel = this._selector ? (0, _nskeyed.archive)(this._selector) : Buffer.alloc(0);
    const aux = this.auxiliaries.build();
    const payloadHeader = DTXMessagePayloadHeader.build({
      flags: this._flags,
      auxLength: aux.length,
      totalLength: BigInt(aux.length + sel.length)
    });
    const messageHeader = DTXMessageHeader.build({
      payloadLength: DTX_MESSAGE_PAYLOAD_HEADER_LENGTH + aux.length + sel.length,
      identifier: this._identifier,
      conversationIndex: this._conversationIndex,
      channelCode: this._channelCode,
      expectsReply: this._expectsReply
    });
    return Buffer.concat([messageHeader, payloadHeader, aux, sel]);
  }

  static parse(headerBuf, payloadBuf) {
    let cursor = 0;
    const ret = new DTXMessage();
    ret._messageHeader = DTXMessageHeader.parse(headerBuf);

    if (ret._messageHeader.payloadLength === 0) {
      return ret;
    }

    ret._payloadHeader = DTXMessagePayloadHeader.parse(payloadBuf.slice(cursor, DTX_MESSAGE_PAYLOAD_HEADER_LENGTH));
    cursor += DTX_MESSAGE_PAYLOAD_HEADER_LENGTH;

    if (ret._payloadHeader.totalLength === 0n) {
      return ret;
    }

    if (ret._payloadHeader.auxLength > 0) {
      ret.auxiliaries = DTXMessageAux.parse(payloadBuf.slice(cursor, cursor + ret._payloadHeader.auxLength));
      cursor += ret._payloadHeader.auxLength;
    }

    const data = payloadBuf.slice(cursor, cursor + payloadBuf.length);

    for (const fun of [_nskeyed.unarchive, _bplistParser.default.parseBuffer]) {
      try {
        ret.selector = fun(data);
        break;
      } catch (e) {
        ret.selector = new InstrumentRPCParseError(data);
      }
    }

    return ret;
  }

}

exports.DTXMessage = DTXMessage;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGliL2luc3RydW1lbnQvaGVhZGVycy5qcyIsIm5hbWVzIjpbIkRUWF9NRVNTQUdFX1BBWUxPQURfSEVBREVSX0xFTkdUSCIsIkRUWF9NRVNTQUdFX0hFQURFUl9MRU5HVEgiLCJEVFhfTUVTU0FHRV9IRUFERVJfTUFHSUMiLCJEVFhfTUVTU0FHRV9IRUFERVJfTUFHSUNfTEVOIiwiRFRYX01FU1NBR0VfQVVYX0hFQURFUiIsIkRUWF9BVVhJTElBUllfTUFHSUMiLCJGTEFHX1RZUEVTIiwiT2JqZWN0IiwiZnJlZXplIiwicmVjdiIsInNlbmQiLCJyZXBseSIsIkFVWF9UWVBFUyIsIk5TS2V5ZWQiLCJVSW50MzJMRSIsIkJpZ1VJbnQ2NExFIiwiQmlnSW50NjRMRSIsIkRUWE1lc3NhZ2VIZWFkZXIiLCJidWlsZCIsImRhdGEiLCJtZXNzYWdlSGVhZGVyIiwiQnVmZmVyIiwiYWxsb2MiLCJ3cml0ZVVJbnQzMkxFIiwid3JpdGVVSW50MTZMRSIsInBheWxvYWRMZW5ndGgiLCJpZGVudGlmaWVyIiwiY29udmVyc2F0aW9uSW5kZXgiLCJjaGFubmVsQ29kZSIsImV4cGVjdHNSZXBseSIsInBhcnNlIiwiaGVhZGVyQnVmZmVyIiwibWFnaWMiLCJyZWFkVUludDMyTEUiLCJoZWFkZXJMZW5ndGgiLCJmcmFnbWVudElkIiwicmVhZFVJbnQxNkxFIiwiZnJhZ21lbnRDb3VudCIsImNoYW5uZWwiLCJEVFhNZXNzYWdlUGF5bG9hZEhlYWRlciIsImZsYWdzIiwiYXV4TGVuZ3RoIiwid3JpdGVCaWdVSW50NjRMRSIsInRvdGFsTGVuZ3RoIiwicmVhZEJpZ0ludDY0TEUiLCJEVFhNZXNzYWdlQXV4IiwiY29uc3RydWN0b3IiLCJtZXNzYWdlQXV4IiwiRFRYTWVzc2FnZUF1eEJ1ZmZlciIsImJ1ZiIsImxlbmd0aCIsImFyZyIsImNvbmNhdCIsImdldEJ5dGVzIiwiXyIsImlzTnVtYmVyIiwiYXBwZW5kSW50IiwiYXBwZW5kTG9uZyIsImFwcGVuZE9iamVjdCIsImN1cnNvciIsIm0iLCJFcnJvciIsInR5cGUiLCJzdHJMZW4iLCJhcmNoaXZlZF9kYXRhIiwic2xpY2UiLCJwdXNoIiwicmVhZEJpZ1VJbnQ2NExFIiwiSW5zdHJ1bWVudFJQQ1BhcnNlRXJyb3IiLCJfYnVmIiwidmFsdWUiLCJhcHBlbmRTaWduZWRJbnQiLCJ3cml0ZUludDMyTEUiLCJhcHBlbmRTaWduZWRMb25nIiwid3JpdGVCaWdJbnQ2NExFIiwiYnVmMiIsIm91dCIsIkRUWE1lc3NhZ2UiLCJvcHRzIiwic2VsZWN0b3IiLCJfbWVzc2FnZUhlYWRlciIsInVuZGVmaW5lZCIsIl9wYXlsb2FkSGVhZGVyIiwiX2lkZW50aWZpZXIiLCJfY2hhbm5lbENvZGUiLCJfZXhwZWN0c1JlcGx5IiwiX3NlbGVjdG9yIiwiX2NvbnZlcnNhdGlvbkluZGV4IiwiX2ZsYWdzIiwiYXV4aWxpYXJpZXMiLCJzZWwiLCJhdXgiLCJwYXlsb2FkSGVhZGVyIiwiQmlnSW50IiwiaGVhZGVyQnVmIiwicGF5bG9hZEJ1ZiIsInJldCIsImZ1biIsInVuYXJjaGl2ZSIsInBsaXN0bGliIiwicGFyc2VCdWZmZXIiLCJlIl0sInNvdXJjZVJvb3QiOiIuLi8uLi8uLiIsInNvdXJjZXMiOlsibGliL2luc3RydW1lbnQvaGVhZGVycy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge2FyY2hpdmUsIHVuYXJjaGl2ZX0gZnJvbSAnLi90cmFuc2Zvcm1lci9uc2tleWVkJztcbmltcG9ydCBwbGlzdGxpYiBmcm9tICdicGxpc3QtcGFyc2VyJztcbmltcG9ydCBfIGZyb20gJ2xvZGFzaCc7XG5cbmNvbnN0IERUWF9NRVNTQUdFX1BBWUxPQURfSEVBREVSX0xFTkdUSCA9IDE2O1xuY29uc3QgRFRYX01FU1NBR0VfSEVBREVSX0xFTkdUSCA9IDMyO1xuY29uc3QgRFRYX01FU1NBR0VfSEVBREVSX01BR0lDID0gMHgxRjNENUI3OTtcbmNvbnN0IERUWF9NRVNTQUdFX0hFQURFUl9NQUdJQ19MRU4gPSA0O1xuY29uc3QgRFRYX01FU1NBR0VfQVVYX0hFQURFUiA9IDB4MDFGMDtcbmNvbnN0IERUWF9BVVhJTElBUllfTUFHSUMgPSAweGE7XG5cbmNvbnN0IEZMQUdfVFlQRVMgPSBPYmplY3QuZnJlZXplKHtcbiAgcmVjdjogMSxcbiAgc2VuZDogMixcbiAgcmVwbHk6IDNcbn0pO1xuXG5jb25zdCBBVVhfVFlQRVMgPSBPYmplY3QuZnJlZXplKHtcbiAgTlNLZXllZDogMixcbiAgVUludDMyTEU6IDMsXG4gIEJpZ1VJbnQ2NExFOiA0LFxuICBCaWdJbnQ2NExFOiA2XG59KTtcblxuLyoqXG4gKiBEVFhNZXNzYWdlSGVhZGVyIGxlbmd0aCAzMlxuICogc3RydWN0IERUWE1lc3NhZ2VIZWFkZXIge1xuICogICAgIHUzMiBtYWdpYyBEVFhfTUVTU0FHRV9IRUFERVJfTUFHSUNcbiAqICAgICB1MzIgaGVhZGVyTGVuZ3RoXG4gKiAgICAgdTE2IGZyYWdtZW50SWQgICBwYWNrZXQgbnVtYmVyXG4gKiAgICAgdTE2IGZyYWdtZW50Q291bnQgIHBhY2tldHMgdG90YWwgbnVtYmVyXG4gKiAgICAgdTMyIHBheWxvYWRMZW5ndGhcbiAqICAgICB1MzIgaWRlbnRpZmllclxuICogICAgIHUzMiBjb252ZXJzYXRpb25JbmRleFxuICogICAgIHUzMiBjaGFubmVsXG4gKiAgICAgdTMyIGV4cGVjdHNSZXBseVxuICogICAgIH1cbiAqL1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IERUWE1lc3NhZ2VPcHRpb25zXG4gKiBAcHJvcGVydHkge251bWJlcn0gaWRlbnRpZmllciBwYWNrZXQgdHJhbnNtaXNzaW9uIHNlcXVlbmNlLCB0aGlzIHZhbHVlIGlzIGluY3JlbWVudGVkIGZvciBlYWNoIHJlcXVlc3RcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBjaGFubmVsQ29kZSB0aGUgZGF0YSB0cmFuc21pc3Npb24gb2YgdGhlIHNlcnZpY2Ugd2lsbCB1c2UgdGhpcyBjaGFubmVsIGNvZGUuXG4gKiBFYWNoIHNlcnZpY2UgaGFzIGEgc2VwYXJhdGUgY2hhbm5lbFxuICogQHByb3BlcnR5IHs/bnVtYmVyfSBwYXlsb2FkTGVuZ3RoIERUWE1lc3NhZ2VBdXhCdWZmZXIubGVuZ3RoKG51bGxhYmxlKSArIHNlbGVjdG9yQnVmZmVyLmxlbmd0aChudWxsYWJsZSlcbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gZXhwZWN0c1JlcGx5IGlmIHRydWUgcmVwbHkgYSBhY2sgbWVzc2FnZVxuICogQHByb3BlcnR5IHtudW1iZXJ9IGNvbnZlcnNhdGlvbkluZGV4ICByYXcgZGF0YSArMSBpbmRpY2F0ZSBhIHJlcGx5IG1lc3NhZ2VcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBmbGFncyBtZXNzYWdlIHN0YXR1c1xuICovXG5cbmNsYXNzIERUWE1lc3NhZ2VIZWFkZXIge1xuICAvKipcbiAgICogQHBhcmFtIHtEVFhNZXNzYWdlT3B0aW9uc30gZGF0YVxuICAgKiBAcmV0dXJucyB7QnVmZmVyfSBEVFhNZXNzYWdlSGVhZGVyQnVmZmVyXG4gICAqL1xuICBzdGF0aWMgYnVpbGQgKGRhdGEpIHtcbiAgICBjb25zdCBtZXNzYWdlSGVhZGVyID0gQnVmZmVyLmFsbG9jKERUWF9NRVNTQUdFX0hFQURFUl9MRU5HVEgpO1xuICAgIG1lc3NhZ2VIZWFkZXIud3JpdGVVSW50MzJMRShEVFhfTUVTU0FHRV9IRUFERVJfTUFHSUMsIDApO1xuICAgIG1lc3NhZ2VIZWFkZXIud3JpdGVVSW50MzJMRShEVFhfTUVTU0FHRV9IRUFERVJfTEVOR1RILCA0KTtcbiAgICBtZXNzYWdlSGVhZGVyLndyaXRlVUludDE2TEUoMCwgOCk7XG4gICAgbWVzc2FnZUhlYWRlci53cml0ZVVJbnQxNkxFKDEsIDEwKTtcbiAgICBtZXNzYWdlSGVhZGVyLndyaXRlVUludDMyTEUoZGF0YS5wYXlsb2FkTGVuZ3RoLCAxMik7XG4gICAgbWVzc2FnZUhlYWRlci53cml0ZVVJbnQzMkxFKGRhdGEuaWRlbnRpZmllciwgMTYpO1xuICAgIG1lc3NhZ2VIZWFkZXIud3JpdGVVSW50MzJMRShkYXRhLmNvbnZlcnNhdGlvbkluZGV4LCAyMCk7XG4gICAgbWVzc2FnZUhlYWRlci53cml0ZVVJbnQzMkxFKGRhdGEuY2hhbm5lbENvZGUsIDI0KTtcbiAgICBtZXNzYWdlSGVhZGVyLndyaXRlVUludDMyTEUoZGF0YS5leHBlY3RzUmVwbHksIDI4KTtcbiAgICByZXR1cm4gbWVzc2FnZUhlYWRlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0gaGVhZGVyQnVmZmVyIERUWE1lc3NhZ2VIZWFkZXJCdWZmZXJcbiAgICogQHJldHVybnMge09iamVjdH1cbiAgICovXG4gIHN0YXRpYyBwYXJzZSAoaGVhZGVyQnVmZmVyKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG1hZ2ljOiBoZWFkZXJCdWZmZXIucmVhZFVJbnQzMkxFKDApLFxuICAgICAgaGVhZGVyTGVuZ3RoOiBoZWFkZXJCdWZmZXIucmVhZFVJbnQzMkxFKDQpLFxuICAgICAgZnJhZ21lbnRJZDogaGVhZGVyQnVmZmVyLnJlYWRVSW50MTZMRSg4KSxcbiAgICAgIGZyYWdtZW50Q291bnQ6IGhlYWRlckJ1ZmZlci5yZWFkVUludDE2TEUoMTApLFxuICAgICAgcGF5bG9hZExlbmd0aDogaGVhZGVyQnVmZmVyLnJlYWRVSW50MzJMRSgxMiksXG4gICAgICBpZGVudGlmaWVyOiBoZWFkZXJCdWZmZXIucmVhZFVJbnQzMkxFKDE2KSxcbiAgICAgIGNvbnZlcnNhdGlvbkluZGV4OiBoZWFkZXJCdWZmZXIucmVhZFVJbnQzMkxFKDIwKSxcbiAgICAgIGNoYW5uZWw6IGhlYWRlckJ1ZmZlci5yZWFkVUludDMyTEUoMjQpLFxuICAgICAgZXhwZWN0c1JlcGx5OiBoZWFkZXJCdWZmZXIucmVhZFVJbnQzMkxFKDI4KSxcbiAgICB9O1xuICB9XG59XG5cbi8qKlxuICogRFRYTWVzc2FnZVBheWxvYWRIZWFkZXIgbGVuZ3RoIDE2XG4gKiBzdHJ1Y3QgRFRYTWVzc2FnZUhlYWRlciB7XG4gKiAgICAgdTMyIGZsYWdzIEZMQUdfVFlQRVNcbiAqICAgICB1MzIgYXV4TGVuZ3RoXG4gKiAgICAgdTY0IHRvdGFsTGVuZ3RoXG4gKiAgICAgfVxuICovXG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gRFRYTWVzc2FnZVBheWxvYWRIZWFkZXJPYmplY3RcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBmbGFncyBtZXNzYWdlIHN0YXR1c1xuICogQHByb3BlcnR5IHtudW1iZXJ9IGF1eExlbmd0aCBEVFhNZXNzYWdlQXV4QnVmZmVyLmxlbmd0aChudWxsYWJsZSlcbiAqIEBwcm9wZXJ0eSB7YmlnaW50fSB0b3RhbExlbmd0aCBEVFhNZXNzYWdlQXV4QnVmZmVyLmxlbmd0aChudWxsYWJsZSkgKyBzZWxlY3RvckJ1ZmZlci5sZW5ndGhcbiAqL1xuY2xhc3MgRFRYTWVzc2FnZVBheWxvYWRIZWFkZXIge1xuICAvKipcbiAgICogQHBhcmFtIGRhdGEge0RUWE1lc3NhZ2VQYXlsb2FkSGVhZGVyT2JqZWN0fVxuICAgKiBAcmV0dXJucyB7QnVmZmVyfSBEVFhNZXNzYWdlUGF5bG9hZEhlYWRlckJ1ZmZlclxuICAgKi9cbiAgc3RhdGljIGJ1aWxkIChkYXRhKSB7XG4gICAgY29uc3QgbWVzc2FnZUhlYWRlciA9IEJ1ZmZlci5hbGxvYyhEVFhfTUVTU0FHRV9QQVlMT0FEX0hFQURFUl9MRU5HVEgpO1xuICAgIG1lc3NhZ2VIZWFkZXIud3JpdGVVSW50MzJMRShkYXRhLmZsYWdzLCAwKTtcbiAgICBtZXNzYWdlSGVhZGVyLndyaXRlVUludDMyTEUoZGF0YS5hdXhMZW5ndGgsIDQpO1xuICAgIG1lc3NhZ2VIZWFkZXIud3JpdGVCaWdVSW50NjRMRShkYXRhLnRvdGFsTGVuZ3RoLCA4KTtcbiAgICByZXR1cm4gbWVzc2FnZUhlYWRlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0gaGVhZGVyQnVmZmVyXG4gICAqIEByZXR1cm5zIHt7ZmxhZ3M6IG51bWJlciwgdG90YWxMZW5ndGg6IGJpZ2ludCwgYXV4TGVuZ3RoOiBudW1iZXJ9fVxuICAgKi9cbiAgc3RhdGljIHBhcnNlIChoZWFkZXJCdWZmZXIpIHtcbiAgICByZXR1cm4ge1xuICAgICAgZmxhZ3M6IGhlYWRlckJ1ZmZlci5yZWFkVUludDMyTEUoMCksXG4gICAgICBhdXhMZW5ndGg6IGhlYWRlckJ1ZmZlci5yZWFkVUludDMyTEUoNCksXG4gICAgICB0b3RhbExlbmd0aDogaGVhZGVyQnVmZmVyLnJlYWRCaWdJbnQ2NExFKDgpXG4gICAgfTtcbiAgfVxufVxuXG5cbmNsYXNzIERUWE1lc3NhZ2VBdXgge1xuICBjb25zdHJ1Y3RvciAoZGF0YSA9IFtdKSB7XG4gICAgdGhpcy5kYXRhID0gZGF0YTtcbiAgfVxuXG4gIC8qKlxuICAgKiBKUyBBcnJheSB0byBBcHBsZSBOU0tleWVkIEJ1ZmZlclxuICAgKiBAcmV0dXJucyB7QnVmZmVyfVxuICAgKi9cbiAgYnVpbGQgKCkge1xuICAgIGNvbnN0IG1lc3NhZ2VBdXggPSBuZXcgRFRYTWVzc2FnZUF1eEJ1ZmZlcigpO1xuICAgIGxldCBidWYgPSBCdWZmZXIuYWxsb2MoMCk7XG4gICAgaWYgKHRoaXMuZGF0YS5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBidWY7XG4gICAgfVxuICAgIGZvciAoY29uc3QgYXJnIG9mIHRoaXMuZGF0YSkge1xuICAgICAgaWYgKGFyZyBpbnN0YW5jZW9mIERUWE1lc3NhZ2VBdXhCdWZmZXIpIHtcbiAgICAgICAgYnVmID0gQnVmZmVyLmNvbmNhdChbYnVmLCBhcmcuZ2V0Qnl0ZXMoKV0pO1xuICAgICAgfSBlbHNlIGlmIChfLmlzTnVtYmVyKGFyZykpIHtcbiAgICAgICAgbWVzc2FnZUF1eC5hcHBlbmRJbnQoYXJnKTtcbiAgICAgIH0gZWxzZSBpZiAodHlwZW9mIGFyZyA9PSAnYmlnaW50Jykge1xuICAgICAgICBtZXNzYWdlQXV4LmFwcGVuZExvbmcoYXJnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1lc3NhZ2VBdXguYXBwZW5kT2JqZWN0KGFyZyk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBCdWZmZXIuY29uY2F0KFtidWYsIG1lc3NhZ2VBdXguZ2V0Qnl0ZXMoKV0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFBhcnNlcyBuc2tleWVkIEJ1ZmZlciBpbnRvIGpzIGFycmF5XG4gICAqIEBwYXJhbSBoZWFkZXJCdWZmZXJcbiAgICogQHJldHVybnMge0FycmF5fVxuICAgKi9cbiAgc3RhdGljIHBhcnNlIChoZWFkZXJCdWZmZXIpIHtcbiAgICBsZXQgY3Vyc29yID0gMDtcbiAgICBjb25zdCBkYXRhID0gW107XG4gICAgY29uc3QgbGVuZ3RoID0gaGVhZGVyQnVmZmVyLnJlYWRCaWdJbnQ2NExFKDgpO1xuICAgIGN1cnNvciArPSAxNjtcbiAgICB3aGlsZSAoY3Vyc29yIDw9IGxlbmd0aCkge1xuICAgICAgY29uc3QgbSA9IGhlYWRlckJ1ZmZlci5yZWFkVUludDMyTEUoY3Vyc29yKTtcbiAgICAgIGlmIChtICE9PSBEVFhfQVVYSUxJQVJZX01BR0lDKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgaW5jb3JyZWN0IGF1eGlsaWFyeSBtYWdpYzogJHttfWApO1xuICAgICAgfVxuICAgICAgY29uc3QgdHlwZSA9IGhlYWRlckJ1ZmZlci5yZWFkVUludDMyTEUoY3Vyc29yICsgNCk7XG4gICAgICBjdXJzb3IgKz0gODtcbiAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICBjYXNlIEFVWF9UWVBFUy5OU0tleWVkOiB7XG4gICAgICAgICAgY29uc3Qgc3RyTGVuID0gaGVhZGVyQnVmZmVyLnJlYWRVSW50MzJMRShjdXJzb3IpO1xuICAgICAgICAgIGN1cnNvciArPSA0O1xuICAgICAgICAgIGNvbnN0IGFyY2hpdmVkX2RhdGEgPSBoZWFkZXJCdWZmZXIuc2xpY2UoY3Vyc29yLCBjdXJzb3IgKyBzdHJMZW4pO1xuICAgICAgICAgIGRhdGEucHVzaCh1bmFyY2hpdmUoYXJjaGl2ZWRfZGF0YSkpO1xuICAgICAgICAgIGN1cnNvciArPSBzdHJMZW47XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBBVVhfVFlQRVMuVUludDMyTEU6XG4gICAgICAgICAgZGF0YS5wdXNoKGhlYWRlckJ1ZmZlci5yZWFkVUludDMyTEUoY3Vyc29yKSk7XG4gICAgICAgICAgY3Vyc29yICs9IDQ7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgQVVYX1RZUEVTLkJpZ1VJbnQ2NExFOlxuICAgICAgICAgIGRhdGEucHVzaChoZWFkZXJCdWZmZXIucmVhZEJpZ1VJbnQ2NExFKGN1cnNvcikpO1xuICAgICAgICAgIGN1cnNvciArPSA4O1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIEFVWF9UWVBFUy5CaWdJbnQ2NExFOlxuICAgICAgICAgIGRhdGEucHVzaChoZWFkZXJCdWZmZXIucmVhZEJpZ0ludDY0TEUoY3Vyc29yKSk7XG4gICAgICAgICAgY3Vyc29yICs9IDg7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHR5cGUgJHt0eXBlfWApO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZGF0YTtcbiAgfVxufVxuXG5jbGFzcyBJbnN0cnVtZW50UlBDUGFyc2VFcnJvciB7XG4gIGNvbnN0cnVjdG9yIChkYXRhKSB7XG4gICAgdGhpcy5kYXRhID0gZGF0YTtcbiAgfVxufVxuXG5jbGFzcyBEVFhNZXNzYWdlQXV4QnVmZmVyIHtcbiAgY29uc3RydWN0b3IgKCkge1xuICAgIHRoaXMuX2J1ZiA9IEJ1ZmZlci5hbGxvYygwKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge251bWJlcn0gdmFsdWVcbiAgICovXG4gIGFwcGVuZEludCAodmFsdWUpIHtcbiAgICBjb25zdCBidWYgPSBCdWZmZXIuYWxsb2MoMTIpO1xuICAgIGJ1Zi53cml0ZVVJbnQzMkxFKERUWF9BVVhJTElBUllfTUFHSUMsIDApO1xuICAgIGJ1Zi53cml0ZVVJbnQzMkxFKDMsIDQpO1xuICAgIGJ1Zi53cml0ZVVJbnQzMkxFKHZhbHVlLCA4KTtcbiAgICB0aGlzLl9idWYgPSBCdWZmZXIuY29uY2F0KFt0aGlzLl9idWYsIGJ1Zl0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7YmlnaW50fSB2YWx1ZVxuICAgKi9cbiAgYXBwZW5kTG9uZyAodmFsdWUpIHtcbiAgICBjb25zdCBidWYgPSBCdWZmZXIuYWxsb2MoMTYpO1xuICAgIGJ1Zi53cml0ZVVJbnQzMkxFKERUWF9BVVhJTElBUllfTUFHSUMsIDApO1xuICAgIGJ1Zi53cml0ZVVJbnQzMkxFKDQsIDQpO1xuICAgIGJ1Zi53cml0ZUJpZ1VJbnQ2NExFKHZhbHVlLCA4KTtcbiAgICB0aGlzLl9idWYgPSBCdWZmZXIuY29uY2F0KFt0aGlzLl9idWYsIGJ1Zl0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7bnVtYmVyfSB2YWx1ZVxuICAgKi9cbiAgYXBwZW5kU2lnbmVkSW50ICh2YWx1ZSkge1xuICAgIGNvbnN0IGJ1ZiA9IEJ1ZmZlci5hbGxvYygxMik7XG4gICAgYnVmLndyaXRlVUludDMyTEUoRFRYX0FVWElMSUFSWV9NQUdJQywgMCk7XG4gICAgYnVmLndyaXRlVUludDMyTEUoMywgNCk7XG4gICAgYnVmLndyaXRlSW50MzJMRSh2YWx1ZSwgOCk7XG4gICAgdGhpcy5fYnVmID0gQnVmZmVyLmNvbmNhdChbdGhpcy5fYnVmLCBidWZdKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0ge2JpZ2ludH0gdmFsdWVcbiAgICovXG4gIGFwcGVuZFNpZ25lZExvbmcgKHZhbHVlKSB7XG4gICAgY29uc3QgYnVmID0gQnVmZmVyLmFsbG9jKDE2KTtcbiAgICB0aGlzLl9idWYud3JpdGVVSW50MzJMRShEVFhfQVVYSUxJQVJZX01BR0lDLCAwKTtcbiAgICB0aGlzLl9idWYud3JpdGVVSW50MzJMRSg2LCA0KTtcbiAgICB0aGlzLl9idWYud3JpdGVCaWdJbnQ2NExFKHZhbHVlLCA4KTtcbiAgICB0aGlzLl9idWYgPSBCdWZmZXIuY29uY2F0KFt0aGlzLl9idWYsIGJ1Zl0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEBwYXJhbSB7T2JqZWN0fSB2YWx1ZVxuICAgKi9cbiAgYXBwZW5kT2JqZWN0ICh2YWx1ZSkge1xuICAgIGNvbnN0IGJ1ZiA9IGFyY2hpdmUodmFsdWUpO1xuICAgIGNvbnN0IGJ1ZjIgPSBCdWZmZXIuYWxsb2MoMTIpO1xuICAgIGJ1ZjIud3JpdGVVSW50MzJMRShEVFhfQVVYSUxJQVJZX01BR0lDLCAwKTtcbiAgICBidWYyLndyaXRlVUludDMyTEUoMiwgNCk7XG4gICAgYnVmMi53cml0ZVVJbnQzMkxFKGJ1Zi5sZW5ndGgsIDgpO1xuICAgIHRoaXMuX2J1ZiA9IEJ1ZmZlci5jb25jYXQoW3RoaXMuX2J1ZiwgYnVmMiwgYnVmXSk7XG4gIH1cblxuICBnZXRCeXRlcyAoKSB7XG4gICAgY29uc3Qgb3V0ID0gQnVmZmVyLmFsbG9jKDE2KTtcbiAgICBvdXQud3JpdGVVSW50MzJMRShEVFhfTUVTU0FHRV9BVVhfSEVBREVSLCAwKTtcbiAgICBvdXQud3JpdGVVSW50MzJMRSh0aGlzLl9idWYubGVuZ3RoLCA4KTtcbiAgICByZXR1cm4gQnVmZmVyLmNvbmNhdChbb3V0LCB0aGlzLl9idWZdKTtcbiAgfVxufVxuXG5cblxuY2xhc3MgRFRYTWVzc2FnZSB7XG4gIC8qKlxuICAgKiBAcGFyYW0ge0RUWE1lc3NhZ2VPcHRpb25zfSBvcHRzXG4gICAqL1xuICBjb25zdHJ1Y3RvciAob3B0cyA9IHt9KSB7XG4gICAgY29uc3Qge1xuICAgICAgaWRlbnRpZmllcixcbiAgICAgIGNoYW5uZWxDb2RlLFxuICAgICAgc2VsZWN0b3IsXG4gICAgICBleHBlY3RzUmVwbHksXG4gICAgICBjb252ZXJzYXRpb25JbmRleCA9IDAsXG4gICAgICBmbGFncyA9IEZMQUdfVFlQRVMuc2VuZFxuICAgIH0gPSBvcHRzO1xuICAgIHRoaXMuX21lc3NhZ2VIZWFkZXIgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5fcGF5bG9hZEhlYWRlciA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLl9pZGVudGlmaWVyID0gaWRlbnRpZmllcjtcbiAgICB0aGlzLl9jaGFubmVsQ29kZSA9IGNoYW5uZWxDb2RlO1xuICAgIHRoaXMuX2V4cGVjdHNSZXBseSA9IGV4cGVjdHNSZXBseTtcbiAgICB0aGlzLl9zZWxlY3RvciA9IHNlbGVjdG9yO1xuICAgIHRoaXMuX2NvbnZlcnNhdGlvbkluZGV4ID0gY29udmVyc2F0aW9uSW5kZXg7XG4gICAgdGhpcy5fZmxhZ3MgPSBmbGFncztcbiAgICB0aGlzLmF1eGlsaWFyaWVzID0gbmV3IERUWE1lc3NhZ2VBdXgoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBnZXQgRFRYTWVzc2FnZUhlYWRlciBpZGVudGlmaWVyLiBQYWNrZXQgdHJhbnNtaXNzaW9uIHNlcXVlbmNlXG4gICAqIEByZXR1cm5zIHtudW1iZXJ9XG4gICAqL1xuICBnZXQgaWRlbnRpZmllciAoKSB7XG4gICAgcmV0dXJuIHRoaXMuX21lc3NhZ2VIZWFkZXI/LmlkZW50aWZpZXI7XG4gIH1cblxuICAvKipcbiAgICogZ2V0IERUWE1lc3NhZ2VIZWFkZXIgY2hhbm5lbENvZGUuXG4gICAqIFBhY2tldCB0cmFuc21pc3Npb24gY2hhbm5lbENvZGUuIFVzZSB0aGlzIHZhbHVlIHRvIGRpc3Rpbmd1aXNoIHdoZW4gdGhlcmUgYXJlIG11bHRpcGxlIGNoYW5uZWxzXG4gICAqIGNhbGwgdGhpcyBtZXRob2QgYEluc3RydW1lbnRTZXJ2aWNlLnJlZ2lzdGVyQ2hhbm5lbENhbGxiYWNrYCBnZXQgdGhlIGNoYW5uZWwgbWVzc2FnZVxuICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgKi9cbiAgZ2V0IGNoYW5uZWxDb2RlICgpIHtcbiAgICByZXR1cm4gdGhpcy5fbWVzc2FnZUhlYWRlcj8uY2hhbm5lbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBnZXQgRFRYTWVzc2FnZUhlYWRlciBleHBlY3RzUmVwbHkuIFdoZXRoZXIgdG8gbmVlZCBhY2sgbWVzc2FnZVxuICAgKiBpZiBleHBlY3RzUmVwbHkgaXMgdHJ1ZSBtdXN0IHJlcGx5IGFjayBtZXNzYWdlXG4gICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgKi9cbiAgZ2V0IGV4cGVjdHNSZXBseSAoKSB7XG4gICAgcmV0dXJuIHRoaXMuX21lc3NhZ2VIZWFkZXI/LmV4cGVjdHNSZXBseTtcbiAgfVxuXG4gIC8qKlxuICAgKiBjYWxsIHRoaXMgbWV0aG9kIGBJbnN0cnVtZW50U2VydmljZS5yZWdpc3RlclNlbGVjdG9yQ2FsbGJhY2tgIGdldCB0aGUgc2VsZWN0b3IgbWVzc2FnZVxuICAgKiBAcmV0dXJucyB7Kn0gVW5rbm93biBkYXRhXG4gICAqL1xuICBnZXQgc2VsZWN0b3IgKCkge1xuICAgIHJldHVybiB0aGlzLl9zZWxlY3RvcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBAcGFyYW0gZGF0YVxuICAgKi9cbiAgc2V0IHNlbGVjdG9yIChkYXRhKSB7XG4gICAgdGhpcy5fc2VsZWN0b3IgPSBkYXRhO1xuICB9XG5cbiAgLyoqXG4gICAqIGdldCBEVFhNZXNzYWdlSGVhZGVyIGNvbnZlcnNhdGlvbkluZGV4XG4gICAqIEByZXR1cm5zIHtudW1iZXJ9XG4gICAqL1xuICBnZXQgY29udmVyc2F0aW9uSW5kZXggKCkge1xuICAgIHJldHVybiB0aGlzLl9tZXNzYWdlSGVhZGVyPy5jb252ZXJzYXRpb25JbmRleDtcbiAgfVxuXG4gIC8qKlxuICAgKiBEVFhNZXNzYWdlIEJ1ZmZlcjogRFRYTWVzc2FnZUhlYWRlciArIFBheWxvYWRIZWFkZXIgKyBEVFhNZXNzYWdlQXV4QnVmZmVyKG51bGxhYmxlKSArIHNlbGVjdG9yKG51bGxhYmxlKVxuICAgKiBAcmV0dXJucyB7QnVmZmVyfVxuICAgKi9cbiAgYnVpbGQgKCkge1xuICAgIGNvbnN0IHNlbCA9IHRoaXMuX3NlbGVjdG9yID8gYXJjaGl2ZSh0aGlzLl9zZWxlY3RvcikgOiBCdWZmZXIuYWxsb2MoMCk7XG4gICAgY29uc3QgYXV4ID0gdGhpcy5hdXhpbGlhcmllcy5idWlsZCgpO1xuICAgIGNvbnN0IHBheWxvYWRIZWFkZXIgPSBEVFhNZXNzYWdlUGF5bG9hZEhlYWRlci5idWlsZCh7XG4gICAgICBmbGFnczogdGhpcy5fZmxhZ3MsXG4gICAgICBhdXhMZW5ndGg6IGF1eC5sZW5ndGgsXG4gICAgICAvLyBuZWVkIHRvIGNvbnZlcnQgdG8gYmlnaW50IGluIGFueSBjYXNlXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWZcbiAgICAgIHRvdGFsTGVuZ3RoOiBCaWdJbnQoYXV4Lmxlbmd0aCArIHNlbC5sZW5ndGgpLFxuICAgIH0pO1xuXG4gICAgY29uc3QgbWVzc2FnZUhlYWRlciA9IERUWE1lc3NhZ2VIZWFkZXIuYnVpbGQoe1xuICAgICAgcGF5bG9hZExlbmd0aDogRFRYX01FU1NBR0VfUEFZTE9BRF9IRUFERVJfTEVOR1RIICsgYXV4Lmxlbmd0aCArIHNlbC5sZW5ndGgsXG4gICAgICBpZGVudGlmaWVyOiB0aGlzLl9pZGVudGlmaWVyLFxuICAgICAgY29udmVyc2F0aW9uSW5kZXg6IHRoaXMuX2NvbnZlcnNhdGlvbkluZGV4LFxuICAgICAgY2hhbm5lbENvZGU6IHRoaXMuX2NoYW5uZWxDb2RlLFxuICAgICAgZXhwZWN0c1JlcGx5OiB0aGlzLl9leHBlY3RzUmVwbHlcbiAgICB9KTtcbiAgICByZXR1cm4gQnVmZmVyLmNvbmNhdChbbWVzc2FnZUhlYWRlciwgcGF5bG9hZEhlYWRlciwgYXV4LCBzZWxdKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBQYXJzZXMgRFRYIGJ1ZmZlciBpbnRvIGFuIGpzIG9iamVjdC4gUmV0dXJuZWQgaW4gRFRYRGVjb2RlciBTdHJlYW0uVHJhbnNmb3JtXG4gICAqIEBwYXJhbSB7QnVmZmVyfSBoZWFkZXJCdWYgIERUWE1lc3NhZ2VIZWFkZXIgYnVmZmVyXG4gICAqIEBwYXJhbSB7QnVmZmVyfSBwYXlsb2FkQnVmICBQYXlsb2FkSGVhZGVyQnVmZmVyICsgRFRYTWVzc2FnZUF1eEJ1ZmZlcihudWxsYWJsZSkgKyBzZWxlY3RvckJ1ZmZlcihudWxsYWJsZSlcbiAgICogQHJldHVybnMge0RUWE1lc3NhZ2V9XG4gICAqL1xuICBzdGF0aWMgcGFyc2UgKGhlYWRlckJ1ZiwgcGF5bG9hZEJ1Zikge1xuICAgIGxldCBjdXJzb3IgPSAwO1xuICAgIGNvbnN0IHJldCA9IG5ldyBEVFhNZXNzYWdlKCk7XG4gICAgcmV0Ll9tZXNzYWdlSGVhZGVyID0gRFRYTWVzc2FnZUhlYWRlci5wYXJzZShoZWFkZXJCdWYpO1xuICAgIGlmIChyZXQuX21lc3NhZ2VIZWFkZXIucGF5bG9hZExlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHJldDtcbiAgICB9XG4gICAgcmV0Ll9wYXlsb2FkSGVhZGVyID0gRFRYTWVzc2FnZVBheWxvYWRIZWFkZXIucGFyc2UocGF5bG9hZEJ1Zi5zbGljZShjdXJzb3IsIERUWF9NRVNTQUdFX1BBWUxPQURfSEVBREVSX0xFTkdUSCkpO1xuICAgIGN1cnNvciArPSBEVFhfTUVTU0FHRV9QQVlMT0FEX0hFQURFUl9MRU5HVEg7XG4gICAgLy8gdG90YWxMZW5ndGggaXMgYmlnaW50IHVzZSAwblxuICAgIGlmIChyZXQuX3BheWxvYWRIZWFkZXIudG90YWxMZW5ndGggPT09IDBuKSB7XG4gICAgICByZXR1cm4gcmV0O1xuICAgIH1cbiAgICBpZiAocmV0Ll9wYXlsb2FkSGVhZGVyLmF1eExlbmd0aCA+IDApIHtcbiAgICAgIHJldC5hdXhpbGlhcmllcyA9IERUWE1lc3NhZ2VBdXgucGFyc2UocGF5bG9hZEJ1Zi5zbGljZShjdXJzb3IsIGN1cnNvciArIHJldC5fcGF5bG9hZEhlYWRlci5hdXhMZW5ndGgpKTtcbiAgICAgIGN1cnNvciArPSByZXQuX3BheWxvYWRIZWFkZXIuYXV4TGVuZ3RoO1xuICAgIH1cblxuICAgIGNvbnN0IGRhdGEgPSBwYXlsb2FkQnVmLnNsaWNlKGN1cnNvciwgY3Vyc29yICsgcGF5bG9hZEJ1Zi5sZW5ndGgpO1xuICAgIGZvciAoY29uc3QgZnVuIG9mIFt1bmFyY2hpdmUsIHBsaXN0bGliLnBhcnNlQnVmZmVyXSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmV0LnNlbGVjdG9yID0gZnVuKGRhdGEpO1xuICAgICAgICBicmVhaztcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgcmV0LnNlbGVjdG9yID0gbmV3IEluc3RydW1lbnRSUENQYXJzZUVycm9yKGRhdGEpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gcmV0O1xuICB9XG59XG5cbmV4cG9ydCB7IERUWE1lc3NhZ2VIZWFkZXIsIERUWE1lc3NhZ2VQYXlsb2FkSGVhZGVyLCBEVFhNZXNzYWdlQXV4QnVmZmVyLCBEVFhNZXNzYWdlQXV4LCBEVFhNZXNzYWdlLFxuICBEVFhfTUVTU0FHRV9QQVlMT0FEX0hFQURFUl9MRU5HVEgsIERUWF9NRVNTQUdFX0hFQURFUl9MRU5HVEgsIERUWF9NRVNTQUdFX0hFQURFUl9NQUdJQywgRFRYX01FU1NBR0VfSEVBREVSX01BR0lDX0xFTixcbiAgRkxBR19UWVBFU307Il0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUVBLE1BQU1BLGlDQUFpQyxHQUFHLEVBQTFDOztBQUNBLE1BQU1DLHlCQUF5QixHQUFHLEVBQWxDOztBQUNBLE1BQU1DLHdCQUF3QixHQUFHLFVBQWpDOztBQUNBLE1BQU1DLDRCQUE0QixHQUFHLENBQXJDOztBQUNBLE1BQU1DLHNCQUFzQixHQUFHLE1BQS9CO0FBQ0EsTUFBTUMsbUJBQW1CLEdBQUcsR0FBNUI7QUFFQSxNQUFNQyxVQUFVLEdBQUdDLE1BQU0sQ0FBQ0MsTUFBUCxDQUFjO0VBQy9CQyxJQUFJLEVBQUUsQ0FEeUI7RUFFL0JDLElBQUksRUFBRSxDQUZ5QjtFQUcvQkMsS0FBSyxFQUFFO0FBSHdCLENBQWQsQ0FBbkI7O0FBTUEsTUFBTUMsU0FBUyxHQUFHTCxNQUFNLENBQUNDLE1BQVAsQ0FBYztFQUM5QkssT0FBTyxFQUFFLENBRHFCO0VBRTlCQyxRQUFRLEVBQUUsQ0FGb0I7RUFHOUJDLFdBQVcsRUFBRSxDQUhpQjtFQUk5QkMsVUFBVSxFQUFFO0FBSmtCLENBQWQsQ0FBbEI7O0FBaUNBLE1BQU1DLGdCQUFOLENBQXVCO0VBS1QsT0FBTEMsS0FBSyxDQUFFQyxJQUFG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
