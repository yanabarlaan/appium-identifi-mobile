"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.SyslogService = exports.SYSLOG_SERVICE_NAME = void 0;

require("source-map-support/register");

var _syslogDecoder = _interopRequireDefault(require("./transformer/syslog-decoder"));

var _constants = require("../constants");

var _baseService = require("../base-service");

const SYSLOG_SERVICE_NAME = 'com.apple.syslog_relay';
exports.SYSLOG_SERVICE_NAME = SYSLOG_SERVICE_NAME;
const START_MESSAGE = 'start';

class SyslogService extends _baseService.BaseServiceSocket {
  constructor(socketClient) {
    super(socketClient);
    this._decoder = new _syslogDecoder.default(5 * _constants.KB);

    this._socketClient.pipe(this._decoder);

    this._assignClientFailureHandlers(this._decoder);
  }

  start(onData) {
    this._decoder.on('data', onData);

    this._socketClient.write(START_MESSAGE);
  }

}

exports.SyslogService = SyslogService;
var _default = SyslogService;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGliL3N5c2xvZy9pbmRleC5qcyIsIm5hbWVzIjpbIlNZU0xPR19TRVJWSUNFX05BTUUiLCJTVEFSVF9NRVNTQUdFIiwiU3lzbG9nU2VydmljZSIsIkJhc2VTZXJ2aWNlU29ja2V0IiwiY29uc3RydWN0b3IiLCJzb2NrZXRDbGllbnQiLCJfZGVjb2RlciIsIlN5c2xvZ0RlY29kZXIiLCJLQiIsIl9zb2NrZXRDbGllbnQiLCJwaXBlIiwiX2Fzc2lnbkNsaWVudEZhaWx1cmVIYW5kbGVycyIsInN0YXJ0Iiwib25EYXRhIiwib24iLCJ3cml0ZSJdLCJzb3VyY2VSb290IjoiLi4vLi4vLi4iLCJzb3VyY2VzIjpbImxpYi9zeXNsb2cvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFN5c2xvZ0RlY29kZXIgZnJvbSAnLi90cmFuc2Zvcm1lci9zeXNsb2ctZGVjb2Rlcic7XG5pbXBvcnQgeyBLQiB9IGZyb20gJy4uL2NvbnN0YW50cyc7XG5pbXBvcnQgeyBCYXNlU2VydmljZVNvY2tldCB9IGZyb20gJy4uL2Jhc2Utc2VydmljZSc7XG5cblxuLy9XZSBqdXN0IG5lZWQgdG8gd3JpdGUgYW55IGRhdGEgdG8gdGhlIGNsaWVudC4gSXQgZG9lc24ndCBtYXR0ZXIgd2hhdCB3ZSBzZW5kXG5jb25zdCBTWVNMT0dfU0VSVklDRV9OQU1FID0gJ2NvbS5hcHBsZS5zeXNsb2dfcmVsYXknO1xuY29uc3QgU1RBUlRfTUVTU0FHRSA9ICdzdGFydCc7XG5cbmNsYXNzIFN5c2xvZ1NlcnZpY2UgZXh0ZW5kcyBCYXNlU2VydmljZVNvY2tldCB7XG4gIGNvbnN0cnVjdG9yIChzb2NrZXRDbGllbnQpIHtcbiAgICBzdXBlcihzb2NrZXRDbGllbnQpO1xuXG4gICAgdGhpcy5fZGVjb2RlciA9IG5ldyBTeXNsb2dEZWNvZGVyKDUgKiBLQik7XG4gICAgdGhpcy5fc29ja2V0Q2xpZW50LnBpcGUodGhpcy5fZGVjb2Rlcik7XG4gICAgdGhpcy5fYXNzaWduQ2xpZW50RmFpbHVyZUhhbmRsZXJzKHRoaXMuX2RlY29kZXIpO1xuICB9XG4gIC8qKiBUaGUgY2FsbGJhY2sgZnVuY3Rpb24gd2hpY2ggd2lsbCBiZSBjYWxsZWQgZHVyaW5nIGxvZyBsaXN0ZW5pbmdcbiAgICogQG5hbWUgTG9nQ2FsbGJhY2tcbiAgICogQGZ1bmN0aW9uXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBsb2cgVGhlIGxvZyB0aGF0IGlzIHNlbnQgZnJvbSB0aGUgcGhvbmVcbiAgKi9cblxuICAvKipcbiAgICogU3RhcnQgcmVjaWV2aW5nIGxvZ3MgZnJvbSB0aGUgcGhvbmUuIFRoZSBjYWxsYmFjayB3aGVuIGEgbG9nIGlzIHJlY2lldmVkXG4gICAqIEBwYXJhbSB7TG9nQ2FsbGJhY2t9IG9uRGF0YVxuICAgKi9cbiAgc3RhcnQgKG9uRGF0YSkge1xuICAgIHRoaXMuX2RlY29kZXIub24oJ2RhdGEnLCBvbkRhdGEpO1xuICAgIHRoaXMuX3NvY2tldENsaWVudC53cml0ZShTVEFSVF9NRVNTQUdFKTtcbiAgfVxufVxuXG5leHBvcnQgeyBTeXNsb2dTZXJ2aWNlLCBTWVNMT0dfU0VSVklDRV9OQU1FIH07XG5leHBvcnQgZGVmYXVsdCBTeXNsb2dTZXJ2aWNlO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUlBLE1BQU1BLG1CQUFtQixHQUFHLHdCQUE1Qjs7QUFDQSxNQUFNQyxhQUFhLEdBQUcsT0FBdEI7O0FBRUEsTUFBTUMsYUFBTixTQUE0QkMsOEJBQTVCLENBQThDO0VBQzVDQyxXQUFXLENBQUVDLFlBQUYsRUFBZ0I7SUFDekIsTUFBTUEsWUFBTjtJQUVBLEtBQUtDLFFBQUwsR0FBZ0IsSUFBSUMsc0JBQUosQ0FBa0IsSUFBSUMsYUFBdEIsQ0FBaEI7O0lBQ0EsS0FBS0MsYUFBTCxDQUFtQkMsSUFBbkIsQ0FBd0IsS0FBS0osUUFBN0I7O0lBQ0EsS0FBS0ssNEJBQUwsQ0FBa0MsS0FBS0wsUUFBdkM7RUFDRDs7RUFXRE0sS0FBSyxDQUFFQyxNQUFGLEVBQVU7SUFDYixLQUFLUCxRQUFMLENBQWNRLEVBQWQsQ0FBaUIsTUFBakIsRUFBeUJELE1BQXpCOztJQUNBLEtBQUtKLGFBQUwsQ0FBbUJNLEtBQW5CLENBQXlCZCxhQUF6QjtFQUNEOztBQXJCMkM7OztlQXlCL0JDLGEifQ==
