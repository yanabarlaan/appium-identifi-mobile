'use strict';

require("source-map-support/register");

const eslint = require('gulp-eslint');

const debug = require('gulp-debug');

const gulpIf = require('gulp-if');

const {
  isVerbose
} = require('../utils');

const yamlLint = require('../yaml-lint');

const configure = function configure(gulp, opts) {
  const verbose = isVerbose();
  gulp.task('eslint', function eslintTask() {
    let opts = {
      fix: process.argv.includes('--fix')
    };

    if (process.argv.includes('--lax-lint') || process.argv.includes('-ll')) {
      opts.rules = {
        'no-console': 0,
        'mocha/no-exclusive-tests': 0
      };
    }

    return gulp.src(['**/*.js', '!node_modules/**', '!**/node_modules/**', '!build/**', '!**/*.min.js']).pipe(gulpIf(verbose, debug())).pipe(eslint(opts)).pipe(eslint.format()).pipe(eslint.failAfterError()).pipe(gulpIf(file => file.eslint && file.eslint.fixed, gulp.dest(process.cwd())));
  });
  gulp.task('yamllint', function yamllintTask() {
    const yamlOpts = {
      safe: !!opts.yaml.safe
    };
    return gulp.src(opts.yaml.files).pipe(gulpIf(verbose, debug())).pipe(yamlLint(yamlOpts));
  });
  const lintTasks = [];

  if (opts.eslint) {
    lintTasks.push('eslint');
  }

  if (opts.yamllint) {
    lintTasks.push('yamllint');
  }

  if (lintTasks.length) {
    gulp.task('lint', gulp.series(lintTasks));
  }
};

module.exports = {
  configure
};require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGliL3Rhc2tzL2xpbnQuanMiLCJuYW1lcyI6WyJlc2xpbnQiLCJyZXF1aXJlIiwiZGVidWciLCJndWxwSWYiLCJpc1ZlcmJvc2UiLCJ5YW1sTGludCIsImNvbmZpZ3VyZSIsImd1bHAiLCJvcHRzIiwidmVyYm9zZSIsInRhc2siLCJlc2xpbnRUYXNrIiwiZml4IiwicHJvY2VzcyIsImFyZ3YiLCJpbmNsdWRlcyIsInJ1bGVzIiwic3JjIiwicGlwZSIsImZvcm1hdCIsImZhaWxBZnRlckVycm9yIiwiZmlsZSIsImZpeGVkIiwiZGVzdCIsImN3ZCIsInlhbWxsaW50VGFzayIsInlhbWxPcHRzIiwic2FmZSIsInlhbWwiLCJmaWxlcyIsImxpbnRUYXNrcyIsInB1c2giLCJ5YW1sbGludCIsImxlbmd0aCIsInNlcmllcyIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii4uLy4uLy4uIiwic291cmNlcyI6WyJsaWIvdGFza3MvbGludC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IGVzbGludCA9IHJlcXVpcmUoJ2d1bHAtZXNsaW50Jyk7XG5jb25zdCBkZWJ1ZyA9IHJlcXVpcmUoJ2d1bHAtZGVidWcnKTtcbmNvbnN0IGd1bHBJZiA9IHJlcXVpcmUoJ2d1bHAtaWYnKTtcbmNvbnN0IHsgaXNWZXJib3NlIH0gPSByZXF1aXJlKCcuLi91dGlscycpO1xuY29uc3QgeWFtbExpbnQgPSByZXF1aXJlKCcuLi95YW1sLWxpbnQnKTtcblxuXG5jb25zdCBjb25maWd1cmUgPSBmdW5jdGlvbiBjb25maWd1cmUgKGd1bHAsIG9wdHMpIHtcbiAgY29uc3QgdmVyYm9zZSA9IGlzVmVyYm9zZSgpO1xuXG4gIGd1bHAudGFzaygnZXNsaW50JywgZnVuY3Rpb24gZXNsaW50VGFzayAoKSB7XG4gICAgbGV0IG9wdHMgPSB7XG4gICAgICBmaXg6IHByb2Nlc3MuYXJndi5pbmNsdWRlcygnLS1maXgnKSxcbiAgICB9O1xuICAgIGlmIChwcm9jZXNzLmFyZ3YuaW5jbHVkZXMoJy0tbGF4LWxpbnQnKSB8fCBwcm9jZXNzLmFyZ3YuaW5jbHVkZXMoJy1sbCcpKSB7XG4gICAgICAvLyB3aGVuIHJ1bm5pbmcgdGVzdHMsIHdlIHdhbnQgdG8gYmUgYWJsZSB0byB1c2UgZXhjbHVzaXZlIHRlc3RzXG4gICAgICAvLyBhbmQgY29uc29sZSBsb2dnaW5nXG4gICAgICBvcHRzLnJ1bGVzID0ge1xuICAgICAgICAnbm8tY29uc29sZSc6IDAsXG4gICAgICAgICdtb2NoYS9uby1leGNsdXNpdmUtdGVzdHMnOiAwLFxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIGd1bHBcbiAgICAgIC5zcmMoWycqKi8qLmpzJywgJyFub2RlX21vZHVsZXMvKionLCAnISoqL25vZGVfbW9kdWxlcy8qKicsICchYnVpbGQvKionLCAnISoqLyoubWluLmpzJ10pXG4gICAgICAucGlwZShndWxwSWYodmVyYm9zZSwgZGVidWcoKSkpXG4gICAgICAucGlwZShlc2xpbnQob3B0cykpXG4gICAgICAucGlwZShlc2xpbnQuZm9ybWF0KCkpXG4gICAgICAucGlwZShlc2xpbnQuZmFpbEFmdGVyRXJyb3IoKSlcbiAgICAgIC5waXBlKGd1bHBJZigoZmlsZSkgPT4gZmlsZS5lc2xpbnQgJiYgZmlsZS5lc2xpbnQuZml4ZWQsIGd1bHAuZGVzdChwcm9jZXNzLmN3ZCgpKSkpO1xuICB9KTtcblxuICBndWxwLnRhc2soJ3lhbWxsaW50JywgZnVuY3Rpb24geWFtbGxpbnRUYXNrICgpIHtcbiAgICBjb25zdCB5YW1sT3B0cyA9IHtcbiAgICAgIHNhZmU6ICEhb3B0cy55YW1sLnNhZmUsXG4gICAgfTtcbiAgICByZXR1cm4gZ3VscFxuICAgICAgLnNyYyhvcHRzLnlhbWwuZmlsZXMpXG4gICAgICAucGlwZShndWxwSWYodmVyYm9zZSwgZGVidWcoKSkpXG4gICAgICAucGlwZSh5YW1sTGludCh5YW1sT3B0cykpO1xuICB9KTtcblxuICBjb25zdCBsaW50VGFza3MgPSBbXTtcbiAgaWYgKG9wdHMuZXNsaW50KSB7XG4gICAgbGludFRhc2tzLnB1c2goJ2VzbGludCcpO1xuICB9XG4gIGlmIChvcHRzLnlhbWxsaW50KSB7XG4gICAgbGludFRhc2tzLnB1c2goJ3lhbWxsaW50Jyk7XG4gIH1cbiAgaWYgKGxpbnRUYXNrcy5sZW5ndGgpIHtcbiAgICBndWxwLnRhc2soJ2xpbnQnLCBndWxwLnNlcmllcyhsaW50VGFza3MpKTtcbiAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGNvbmZpZ3VyZSxcbn07XG4iXSwibWFwcGluZ3MiOiJBQUFBOzs7O0FBRUEsTUFBTUEsTUFBTSxHQUFHQyxPQUFPLENBQUMsYUFBRCxDQUF0Qjs7QUFDQSxNQUFNQyxLQUFLLEdBQUdELE9BQU8sQ0FBQyxZQUFELENBQXJCOztBQUNBLE1BQU1FLE1BQU0sR0FBR0YsT0FBTyxDQUFDLFNBQUQsQ0FBdEI7O0FBQ0EsTUFBTTtFQUFFRztBQUFGLElBQWdCSCxPQUFPLENBQUMsVUFBRCxDQUE3Qjs7QUFDQSxNQUFNSSxRQUFRLEdBQUdKLE9BQU8sQ0FBQyxjQUFELENBQXhCOztBQUdBLE1BQU1LLFNBQVMsR0FBRyxTQUFTQSxTQUFULENBQW9CQyxJQUFwQixFQUEwQkMsSUFBMUIsRUFBZ0M7RUFDaEQsTUFBTUMsT0FBTyxHQUFHTCxTQUFTLEVBQXpCO0VBRUFHLElBQUksQ0FBQ0csSUFBTCxDQUFVLFFBQVYsRUFBb0IsU0FBU0MsVUFBVCxHQUF1QjtJQUN6QyxJQUFJSCxJQUFJLEdBQUc7TUFDVEksR0FBRyxFQUFFQyxPQUFPLENBQUNDLElBQVIsQ0FBYUMsUUFBYixDQUFzQixPQUF0QjtJQURJLENBQVg7O0lBR0EsSUFBSUYsT0FBTyxDQUFDQyxJQUFSLENBQWFDLFFBQWIsQ0FBc0IsWUFBdEIsS0FBdUNGLE9BQU8sQ0FBQ0MsSUFBUixDQUFhQyxRQUFiLENBQXNCLEtBQXRCLENBQTNDLEVBQXlFO01BR3ZFUCxJQUFJLENBQUNRLEtBQUwsR0FBYTtRQUNYLGNBQWMsQ0FESDtRQUVYLDRCQUE0QjtNQUZqQixDQUFiO0lBSUQ7O0lBQ0QsT0FBT1QsSUFBSSxDQUNSVSxHQURJLENBQ0EsQ0FBQyxTQUFELEVBQVksa0JBQVosRUFBZ0MscUJBQWhDLEVBQXVELFdBQXZELEVBQW9FLGNBQXBFLENBREEsRUFFSkMsSUFGSSxDQUVDZixNQUFNLENBQUNNLE9BQUQsRUFBVVAsS0FBSyxFQUFmLENBRlAsRUFHSmdCLElBSEksQ0FHQ2xCLE1BQU0sQ0FBQ1EsSUFBRCxDQUhQLEVBSUpVLElBSkksQ0FJQ2xCLE1BQU0sQ0FBQ21CLE1BQVAsRUFKRCxFQUtKRCxJQUxJLENBS0NsQixNQUFNLENBQUNvQixjQUFQLEVBTEQsRUFNSkYsSUFOSSxDQU1DZixNQUFNLENBQUVrQixJQUFELElBQVVBLElBQUksQ0FBQ3JCLE1BQUwsSUFBZXFCLElBQUksQ0FBQ3JCLE1BQUwsQ0FBWXNCLEtBQXRDLEVBQTZDZixJQUFJLENBQUNnQixJQUFMLENBQVVWLE9BQU8sQ0FBQ1csR0FBUixFQUFWLENBQTdDLENBTlAsQ0FBUDtFQU9ELENBbkJEO0VBcUJBakIsSUFBSSxDQUFDRyxJQUFMLENBQVUsVUFBVixFQUFzQixTQUFTZSxZQUFULEdBQXlCO0lBQzdDLE1BQU1DLFFBQVEsR0FBRztNQUNmQyxJQUFJLEVBQUUsQ0FBQyxDQUFDbkIsSUFBSSxDQUFDb0IsSUFBTCxDQUFVRDtJQURILENBQWpCO0lBR0EsT0FBT3BCLElBQUksQ0FDUlUsR0FESSxDQUNBVCxJQUFJLENBQUNvQixJQUFMLENBQVVDLEtBRFYsRUFFSlgsSUFGSSxDQUVDZixNQUFNLENBQUNNLE9BQUQsRUFBVVAsS0FBSyxFQUFmLENBRlAsRUFHSmdCLElBSEksQ0FHQ2IsUUFBUSxDQUFDcUIsUUFBRCxDQUhULENBQVA7RUFJRCxDQVJEO0VBVUEsTUFBTUksU0FBUyxHQUFHLEVBQWxCOztFQUNBLElBQUl0QixJQUFJLENBQUNSLE1BQVQsRUFBaUI7SUFDZjhCLFNBQVMsQ0FBQ0MsSUFBVixDQUFlLFFBQWY7RUFDRDs7RUFDRCxJQUFJdkIsSUFBSSxDQUFDd0IsUUFBVCxFQUFtQjtJQUNqQkYsU0FBUyxDQUFDQyxJQUFWLENBQWUsVUFBZjtFQUNEOztFQUNELElBQUlELFNBQVMsQ0FBQ0csTUFBZCxFQUFzQjtJQUNwQjFCLElBQUksQ0FBQ0csSUFBTCxDQUFVLE1BQVYsRUFBa0JILElBQUksQ0FBQzJCLE1BQUwsQ0FBWUosU0FBWixDQUFsQjtFQUNEO0FBQ0YsQ0E1Q0Q7O0FBOENBSyxNQUFNLENBQUNDLE9BQVAsR0FBaUI7RUFDZjlCO0FBRGUsQ0FBakIifQ==
