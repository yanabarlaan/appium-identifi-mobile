"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getProcessIds = getProcessIds;
exports.killProcess = killProcess;

require("source-map-support/register");

var _teen_process = require("teen_process");

async function getProcessIds(appName) {
  let pids;

  try {
    let {
      stdout
    } = await (0, _teen_process.exec)('pgrep', ['-x', appName]);
    pids = stdout.trim().split('\n').map(pid => parseInt(pid, 10));
  } catch (err) {
    if (parseInt(err.code, 10) !== 1) {
      throw new Error(`Error getting process ids for app '${appName}': ${err.message}`);
    }

    pids = [];
  }

  return pids;
}

async function killProcess(appName, force = false) {
  let pids = await getProcessIds(appName);

  if (pids.length === 0) {
    return;
  }

  try {
    let args = force ? ['-9'] : [];
    args.push('-x', appName);
    await (0, _teen_process.exec)('pkill', args);
  } catch (err) {
    if (parseInt(err.code, 10) !== 1) {
      throw new Error(`Error killing app '${appName}' with pkill: ${err.message}`);
    }
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJnZXRQcm9jZXNzSWRzIiwiYXBwTmFtZSIsInBpZHMiLCJzdGRvdXQiLCJ0cmltIiwic3BsaXQiLCJtYXAiLCJwaWQiLCJwYXJzZUludCIsImVyciIsImNvZGUiLCJFcnJvciIsIm1lc3NhZ2UiLCJraWxsUHJvY2VzcyIsImZvcmNlIiwibGVuZ3RoIiwiYXJncyIsInB1c2giXSwic291cmNlcyI6WyIuLi8uLi9saWIvcHJvY2Vzcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBleGVjIH0gZnJvbSAndGVlbl9wcm9jZXNzJztcblxuXG4vKlxuICogRXhpdCBTdGF0dXMgZm9yIHBncmVwIGFuZCBwa2lsbCAoYG1hbiBwa2lsbGApXG4gKiAgMC4gT25lIG9yIG1vcmUgcHJvY2Vzc2VzIG1hdGNoZWQgdGhlIGNyaXRlcmlhLlxuICogIDEuIE5vIHByb2Nlc3NlcyBtYXRjaGVkLlxuICogIDIuIFN5bnRheCBlcnJvciBpbiB0aGUgY29tbWFuZCBsaW5lLlxuICogIDMuIEZhdGFsIGVycm9yOiBvdXQgb2YgbWVtb3J5IGV0Yy5cbiAqL1xuXG5hc3luYyBmdW5jdGlvbiBnZXRQcm9jZXNzSWRzIChhcHBOYW1lKSB7XG4gIGxldCBwaWRzO1xuICB0cnkge1xuICAgIGxldCB7c3Rkb3V0fSA9IGF3YWl0IGV4ZWMoJ3BncmVwJywgWycteCcsIGFwcE5hbWVdKTtcbiAgICBwaWRzID0gc3Rkb3V0LnRyaW0oKS5zcGxpdCgnXFxuJykubWFwKChwaWQpID0+IHBhcnNlSW50KHBpZCwgMTApKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgaWYgKHBhcnNlSW50KGVyci5jb2RlLCAxMCkgIT09IDEpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRXJyb3IgZ2V0dGluZyBwcm9jZXNzIGlkcyBmb3IgYXBwICcke2FwcE5hbWV9JzogJHtlcnIubWVzc2FnZX1gKTtcbiAgICB9XG4gICAgcGlkcyA9IFtdO1xuICB9XG4gIHJldHVybiBwaWRzO1xufVxuXG5hc3luYyBmdW5jdGlvbiBraWxsUHJvY2VzcyAoYXBwTmFtZSwgZm9yY2UgPSBmYWxzZSkge1xuICBsZXQgcGlkcyA9IGF3YWl0IGdldFByb2Nlc3NJZHMoYXBwTmFtZSk7XG4gIGlmIChwaWRzLmxlbmd0aCA9PT0gMCkge1xuICAgIC8vIHRoZSBwcm9jZXNzIGlzIG5vdCBydW5uaW5nXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBsZXQgYXJncyA9IGZvcmNlID8gWyctOSddIDogW107XG4gICAgYXJncy5wdXNoKCcteCcsIGFwcE5hbWUpO1xuICAgIGF3YWl0IGV4ZWMoJ3BraWxsJywgYXJncyk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIGlmIChwYXJzZUludChlcnIuY29kZSwgMTApICE9PSAxKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEVycm9yIGtpbGxpbmcgYXBwICcke2FwcE5hbWV9JyB3aXRoIHBraWxsOiAke2Vyci5tZXNzYWdlfWApO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgeyBnZXRQcm9jZXNzSWRzLCBraWxsUHJvY2VzcyB9O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7O0FBV0EsZUFBZUEsYUFBZixDQUE4QkMsT0FBOUIsRUFBdUM7RUFDckMsSUFBSUMsSUFBSjs7RUFDQSxJQUFJO0lBQ0YsSUFBSTtNQUFDQztJQUFELElBQVcsTUFBTSx3QkFBSyxPQUFMLEVBQWMsQ0FBQyxJQUFELEVBQU9GLE9BQVAsQ0FBZCxDQUFyQjtJQUNBQyxJQUFJLEdBQUdDLE1BQU0sQ0FBQ0MsSUFBUCxHQUFjQyxLQUFkLENBQW9CLElBQXBCLEVBQTBCQyxHQUExQixDQUErQkMsR0FBRCxJQUFTQyxRQUFRLENBQUNELEdBQUQsRUFBTSxFQUFOLENBQS9DLENBQVA7RUFDRCxDQUhELENBR0UsT0FBT0UsR0FBUCxFQUFZO0lBQ1osSUFBSUQsUUFBUSxDQUFDQyxHQUFHLENBQUNDLElBQUwsRUFBVyxFQUFYLENBQVIsS0FBMkIsQ0FBL0IsRUFBa0M7TUFDaEMsTUFBTSxJQUFJQyxLQUFKLENBQVcsc0NBQXFDVixPQUFRLE1BQUtRLEdBQUcsQ0FBQ0csT0FBUSxFQUF6RSxDQUFOO0lBQ0Q7O0lBQ0RWLElBQUksR0FBRyxFQUFQO0VBQ0Q7O0VBQ0QsT0FBT0EsSUFBUDtBQUNEOztBQUVELGVBQWVXLFdBQWYsQ0FBNEJaLE9BQTVCLEVBQXFDYSxLQUFLLEdBQUcsS0FBN0MsRUFBb0Q7RUFDbEQsSUFBSVosSUFBSSxHQUFHLE1BQU1GLGFBQWEsQ0FBQ0MsT0FBRCxDQUE5Qjs7RUFDQSxJQUFJQyxJQUFJLENBQUNhLE1BQUwsS0FBZ0IsQ0FBcEIsRUFBdUI7SUFFckI7RUFDRDs7RUFFRCxJQUFJO0lBQ0YsSUFBSUMsSUFBSSxHQUFHRixLQUFLLEdBQUcsQ0FBQyxJQUFELENBQUgsR0FBWSxFQUE1QjtJQUNBRSxJQUFJLENBQUNDLElBQUwsQ0FBVSxJQUFWLEVBQWdCaEIsT0FBaEI7SUFDQSxNQUFNLHdCQUFLLE9BQUwsRUFBY2UsSUFBZCxDQUFOO0VBQ0QsQ0FKRCxDQUlFLE9BQU9QLEdBQVAsRUFBWTtJQUNaLElBQUlELFFBQVEsQ0FBQ0MsR0FBRyxDQUFDQyxJQUFMLEVBQVcsRUFBWCxDQUFSLEtBQTJCLENBQS9CLEVBQWtDO01BQ2hDLE1BQU0sSUFBSUMsS0FBSixDQUFXLHNCQUFxQlYsT0FBUSxpQkFBZ0JRLEdBQUcsQ0FBQ0csT0FBUSxFQUFwRSxDQUFOO0lBQ0Q7RUFDRjtBQUNGIn0=