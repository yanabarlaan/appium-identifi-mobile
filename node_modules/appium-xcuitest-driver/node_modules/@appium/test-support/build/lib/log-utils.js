"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.stubLog = stubLog;

require("source-map-support/register");

function stripColors(msg) {
  let code = /\u001b\[(\d+(;\d+)*)?m/g;
  msg = ('' + msg).replace(code, '');
  return msg;
}

class LogStub {
  constructor(opts = {}) {
    this.output = '';
    this.stripColors = opts.stripColors;
  }

  log(level, message) {
    if (this.stripColors) {
      message = stripColors(message);
    }

    if (this.output.length > 0) {
      this.output += '\n';
    }

    this.output = `${this.output}${level}: ${message}`;
  }

}

function stubLog(sandbox, log, opts = {}) {
  let logStub = new LogStub(opts);

  for (let l of log.levels) {
    sandbox.stub(log, l).callsFake(function doLogging(mess) {
      logStub.log(l, mess);
    });
  }

  return logStub;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzdHJpcENvbG9ycyIsIm1zZyIsImNvZGUiLCJyZXBsYWNlIiwiTG9nU3R1YiIsImNvbnN0cnVjdG9yIiwib3B0cyIsIm91dHB1dCIsImxvZyIsImxldmVsIiwibWVzc2FnZSIsImxlbmd0aCIsInN0dWJMb2ciLCJzYW5kYm94IiwibG9nU3R1YiIsImwiLCJsZXZlbHMiLCJzdHViIiwiY2FsbHNGYWtlIiwiZG9Mb2dnaW5nIiwibWVzcyJdLCJzb3VyY2VzIjpbIi4uLy4uL2xpYi9sb2ctdXRpbHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVE9ETyBtb3ZlIHRoYXQgdG8gQGFwcGl1bS9zdXBwb3J0XG5mdW5jdGlvbiBzdHJpcENvbG9ycyAobXNnKSB7XG4gIGxldCBjb2RlID0gL1xcdTAwMWJcXFsoXFxkKyg7XFxkKykqKT9tL2c7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgbm8tY29udHJvbC1yZWdleFxuICBtc2cgPSAoJycgKyBtc2cpLnJlcGxhY2UoY29kZSwgJycpO1xuICByZXR1cm4gbXNnO1xufVxuXG5jbGFzcyBMb2dTdHViIHtcbiAgY29uc3RydWN0b3IgKG9wdHMgPSB7fSkge1xuICAgIHRoaXMub3V0cHV0ID0gJyc7XG4gICAgdGhpcy5zdHJpcENvbG9ycyA9IG9wdHMuc3RyaXBDb2xvcnM7XG4gIH1cbiAgbG9nIChsZXZlbCwgbWVzc2FnZSkge1xuICAgIGlmICh0aGlzLnN0cmlwQ29sb3JzKSB7XG4gICAgICBtZXNzYWdlID0gc3RyaXBDb2xvcnMobWVzc2FnZSk7XG4gICAgfVxuICAgIGlmICh0aGlzLm91dHB1dC5sZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLm91dHB1dCArPSAnXFxuJztcbiAgICB9XG4gICAgdGhpcy5vdXRwdXQgPSBgJHt0aGlzLm91dHB1dH0ke2xldmVsfTogJHttZXNzYWdlfWA7XG4gIH1cbn1cblxuZnVuY3Rpb24gc3R1YkxvZyAoc2FuZGJveCwgbG9nLCBvcHRzID0ge30pIHtcbiAgbGV0IGxvZ1N0dWIgPSBuZXcgTG9nU3R1YihvcHRzKTtcbiAgZm9yIChsZXQgbCBvZiBsb2cubGV2ZWxzKSB7XG4gICAgc2FuZGJveC5zdHViKGxvZywgbCkuY2FsbHNGYWtlKGZ1bmN0aW9uIGRvTG9nZ2luZyAobWVzcykge1xuICAgICAgbG9nU3R1Yi5sb2cobCwgbWVzcyk7XG4gICAgfSk7XG4gIH1cbiAgcmV0dXJuIGxvZ1N0dWI7XG59XG5cbmV4cG9ydCB7IHN0dWJMb2cgfTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQ0EsU0FBU0EsV0FBVCxDQUFzQkMsR0FBdEIsRUFBMkI7RUFDekIsSUFBSUMsSUFBSSxHQUFHLHlCQUFYO0VBQ0FELEdBQUcsR0FBRyxDQUFDLEtBQUtBLEdBQU4sRUFBV0UsT0FBWCxDQUFtQkQsSUFBbkIsRUFBeUIsRUFBekIsQ0FBTjtFQUNBLE9BQU9ELEdBQVA7QUFDRDs7QUFFRCxNQUFNRyxPQUFOLENBQWM7RUFDWkMsV0FBVyxDQUFFQyxJQUFJLEdBQUcsRUFBVCxFQUFhO0lBQ3RCLEtBQUtDLE1BQUwsR0FBYyxFQUFkO0lBQ0EsS0FBS1AsV0FBTCxHQUFtQk0sSUFBSSxDQUFDTixXQUF4QjtFQUNEOztFQUNEUSxHQUFHLENBQUVDLEtBQUYsRUFBU0MsT0FBVCxFQUFrQjtJQUNuQixJQUFJLEtBQUtWLFdBQVQsRUFBc0I7TUFDcEJVLE9BQU8sR0FBR1YsV0FBVyxDQUFDVSxPQUFELENBQXJCO0lBQ0Q7O0lBQ0QsSUFBSSxLQUFLSCxNQUFMLENBQVlJLE1BQVosR0FBcUIsQ0FBekIsRUFBNEI7TUFDMUIsS0FBS0osTUFBTCxJQUFlLElBQWY7SUFDRDs7SUFDRCxLQUFLQSxNQUFMLEdBQWUsR0FBRSxLQUFLQSxNQUFPLEdBQUVFLEtBQU0sS0FBSUMsT0FBUSxFQUFqRDtFQUNEOztBQWJXOztBQWdCZCxTQUFTRSxPQUFULENBQWtCQyxPQUFsQixFQUEyQkwsR0FBM0IsRUFBZ0NGLElBQUksR0FBRyxFQUF2QyxFQUEyQztFQUN6QyxJQUFJUSxPQUFPLEdBQUcsSUFBSVYsT0FBSixDQUFZRSxJQUFaLENBQWQ7O0VBQ0EsS0FBSyxJQUFJUyxDQUFULElBQWNQLEdBQUcsQ0FBQ1EsTUFBbEIsRUFBMEI7SUFDeEJILE9BQU8sQ0FBQ0ksSUFBUixDQUFhVCxHQUFiLEVBQWtCTyxDQUFsQixFQUFxQkcsU0FBckIsQ0FBK0IsU0FBU0MsU0FBVCxDQUFvQkMsSUFBcEIsRUFBMEI7TUFDdkROLE9BQU8sQ0FBQ04sR0FBUixDQUFZTyxDQUFaLEVBQWVLLElBQWY7SUFDRCxDQUZEO0VBR0Q7O0VBQ0QsT0FBT04sT0FBUDtBQUNEIn0=