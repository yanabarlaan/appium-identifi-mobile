"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("source-map-support/register");

var _rimraf = _interopRequireDefault(require("rimraf"));

var _uuid = require("uuid");

var _path = _interopRequireDefault(require("path"));

var _os = _interopRequireDefault(require("os"));

var _fs = _interopRequireDefault(require("fs"));

var _bluebird = _interopRequireDefault(require("bluebird"));

const commands = {};

const rimrafAsync = _bluebird.default.promisify(_rimraf.default);

const writeFileAsync = _bluebird.default.promisify(_fs.default.writeFile);

commands.pushNotification = async function pushNotification(payload) {
  const dstPath = _path.default.resolve(_os.default.tmpdir(), `${(0, _uuid.v4)()}.json`);

  try {
    await writeFileAsync(dstPath, JSON.stringify(payload), 'utf8');
    await this.exec('push', {
      args: [this.requireUdid('push'), dstPath]
    });
  } finally {
    await rimrafAsync(dstPath);
  }
};

var _default = commands;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGliL3N1YmNvbW1hbmRzL3B1c2guanMiLCJuYW1lcyI6WyJjb21tYW5kcyIsInJpbXJhZkFzeW5jIiwiQiIsInByb21pc2lmeSIsInJpbXJhZiIsIndyaXRlRmlsZUFzeW5jIiwiZnMiLCJ3cml0ZUZpbGUiLCJwdXNoTm90aWZpY2F0aW9uIiwicGF5bG9hZCIsImRzdFBhdGgiLCJwYXRoIiwicmVzb2x2ZSIsIm9zIiwidG1wZGlyIiwiSlNPTiIsInN0cmluZ2lmeSIsImV4ZWMiLCJhcmdzIiwicmVxdWlyZVVkaWQiXSwic291cmNlUm9vdCI6Ii4uLy4uLy4uIiwic291cmNlcyI6WyJsaWIvc3ViY29tbWFuZHMvcHVzaC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgcmltcmFmIGZyb20gJ3JpbXJhZic7XG5pbXBvcnQgeyB2NCBhcyB1dWlkVjQgfSBmcm9tICd1dWlkJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IG9zIGZyb20gJ29zJztcbmltcG9ydCBmcyBmcm9tICdmcyc7XG5pbXBvcnQgQiBmcm9tICdibHVlYmlyZCc7XG5cbmNvbnN0IGNvbW1hbmRzID0ge307XG5jb25zdCByaW1yYWZBc3luYyA9IEIucHJvbWlzaWZ5KHJpbXJhZik7XG5jb25zdCB3cml0ZUZpbGVBc3luYyA9IEIucHJvbWlzaWZ5KGZzLndyaXRlRmlsZSk7XG5cbi8qKlxuICogU2VuZCBhIHNpbXVsYXRlZCBwdXNoIG5vdGlmaWNhdGlvblxuICpcbiAqIEBzaW5jZSBYY29kZSAxMS40IFNES1xuICogQHBhcmFtIHtPYmplY3R9IHBheWxvYWQgLSBUaGUgb2JqZWN0IHRoYXQgZGVzY3JpYmVzIEFwcGxlIHB1c2ggbm90aWZpY2F0aW9uIGNvbnRlbnQuXG4gKiBJdCBtdXN0IGNvbnRhaW4gYSB0b3AtbGV2ZWwgXCJTaW11bGF0b3IgVGFyZ2V0IEJ1bmRsZVwiIGtleSB3aXRoIGEgc3RyaW5nIHZhbHVlIG1hdGNoaW5nXG4gKiB0aGUgdGFyZ2V0IGFwcGxpY2F0aW9u4oCYcyBidW5kbGUgaWRlbnRpZmllciBhbmQgXCJhcHNcIiBrZXkgd2l0aCB2YWxpZCBBcHBsZSBQdXNoIE5vdGlmaWNhdGlvbiB2YWx1ZXMuXG4gKiBGb3IgZXhhbXBsZTpcbiAqIHtcbiAqICAgXCJTaW11bGF0b3IgVGFyZ2V0IEJ1bmRsZVwiOiBcImNvbS5hcHBsZS5QcmVmZXJlbmNlc1wiLFxuICogICBcImFwc1wiOiB7XG4gKiAgICAgXCJhbGVydFwiOiBcIlRoaXMgaXMgYSBzaW11bGF0ZWQgbm90aWZpY2F0aW9uIVwiLFxuICogICAgIFwiYmFkZ2VcIjogMyxcbiAqICAgICBcInNvdW5kXCI6IFwiZGVmYXVsdFwiXG4gKiAgIH1cbiAqIH1cbiAqIEB0aHJvd3Mge0Vycm9yfSBpZiB0aGUgY3VycmVudCBTREsgdmVyc2lvbiBkb2VzIG5vdCBzdXBwb3J0IHRoZSBjb21tYW5kXG4gKiBvciB0aGVyZSB3YXMgYW4gZXJyb3Igd2hpbGUgcHVzaGluZyB0aGUgbm90aWZpY2F0aW9uXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIGB1ZGlkYCBpbnN0YW5jZSBwcm9wZXJ0eSBpcyB1bnNldFxuICovXG5jb21tYW5kcy5wdXNoTm90aWZpY2F0aW9uID0gYXN5bmMgZnVuY3Rpb24gcHVzaE5vdGlmaWNhdGlvbiAocGF5bG9hZCkge1xuICBjb25zdCBkc3RQYXRoID0gcGF0aC5yZXNvbHZlKG9zLnRtcGRpcigpLCBgJHt1dWlkVjQoKX0uanNvbmApO1xuICB0cnkge1xuICAgIGF3YWl0IHdyaXRlRmlsZUFzeW5jKGRzdFBhdGgsIEpTT04uc3RyaW5naWZ5KHBheWxvYWQpLCAndXRmOCcpO1xuICAgIGF3YWl0IHRoaXMuZXhlYygncHVzaCcsIHtcbiAgICAgIGFyZ3M6IFt0aGlzLnJlcXVpcmVVZGlkKCdwdXNoJyksIGRzdFBhdGhdLFxuICAgIH0pO1xuICB9IGZpbmFsbHkge1xuICAgIGF3YWl0IHJpbXJhZkFzeW5jKGRzdFBhdGgpO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBjb21tYW5kcztcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQSxNQUFNQSxRQUFRLEdBQUcsRUFBakI7O0FBQ0EsTUFBTUMsV0FBVyxHQUFHQyxrQkFBRUMsU0FBRixDQUFZQyxlQUFaLENBQXBCOztBQUNBLE1BQU1DLGNBQWMsR0FBR0gsa0JBQUVDLFNBQUYsQ0FBWUcsWUFBR0MsU0FBZixDQUF2Qjs7QUFzQkFQLFFBQVEsQ0FBQ1EsZ0JBQVQsR0FBNEIsZUFBZUEsZ0JBQWYsQ0FBaUNDLE9BQWpDLEVBQTBDO0VBQ3BFLE1BQU1DLE9BQU8sR0FBR0MsY0FBS0MsT0FBTCxDQUFhQyxZQUFHQyxNQUFILEVBQWIsRUFBMkIsR0FBRSxlQUFTLE9BQXRDLENBQWhCOztFQUNBLElBQUk7SUFDRixNQUFNVCxjQUFjLENBQUNLLE9BQUQsRUFBVUssSUFBSSxDQUFDQyxTQUFMLENBQWVQLE9BQWYsQ0FBVixFQUFtQyxNQUFuQyxDQUFwQjtJQUNBLE1BQU0sS0FBS1EsSUFBTCxDQUFVLE1BQVYsRUFBa0I7TUFDdEJDLElBQUksRUFBRSxDQUFDLEtBQUtDLFdBQUwsQ0FBaUIsTUFBakIsQ0FBRCxFQUEyQlQsT0FBM0I7SUFEZ0IsQ0FBbEIsQ0FBTjtFQUdELENBTEQsU0FLVTtJQUNSLE1BQU1ULFdBQVcsQ0FBQ1MsT0FBRCxDQUFqQjtFQUNEO0FBQ0YsQ0FWRDs7ZUFZZVYsUSJ9
