"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.helpers = exports.extensions = exports.default = exports.commands = void 0;

require("source-map-support/register");

var _lodash = _interopRequireDefault(require("lodash"));

var _baseDriver = require("@appium/base-driver");

var _support = require("@appium/support");

var _momentTimezone = _interopRequireDefault(require("moment-timezone"));

var _appiumIosDevice = require("appium-ios-device");

var _teen_process = require("teen_process");

var _appUtils = require("../app-utils");

let commands = {},
    helpers = {},
    extensions = {};
exports.extensions = extensions;
exports.helpers = helpers;
exports.commands = commands;
const MOMENT_FORMAT_ISO8601 = 'YYYY-MM-DDTHH:mm:ssZ';

commands.active = async function active() {
  if (this.isWebContext()) {
    return this.cacheWebElements(await this.executeAtom('active_element', []));
  }

  return await this.proxyCommand(`/element/active`, 'GET');
};

commands.background = async function background(seconds) {
  const homescreen = '/wda/homescreen';
  const deactivateApp = '/wda/deactivateApp';
  let endpoint;
  let params = {};

  const selectEndpoint = timeoutSeconds => {
    if (!_support.util.hasValue(timeoutSeconds)) {
      endpoint = homescreen;
    } else if (!isNaN(timeoutSeconds)) {
      const duration = parseFloat(timeoutSeconds);

      if (duration >= 0) {
        params = {
          duration
        };
        endpoint = deactivateApp;
      } else {
        endpoint = homescreen;
      }
    }
  };

  if (_lodash.default.has(seconds, 'timeout')) {
    const {
      timeout
    } = seconds;
    selectEndpoint(isNaN(timeout) ? timeout : parseFloat(timeout) / 1000.0);
  } else {
    selectEndpoint(seconds);
  }

  if (!endpoint) {
    throw new _baseDriver.errors.InvalidArgumentError(`Argument value is expected to be a valid number. ` + `${JSON.stringify(seconds)} has been provided instead`);
  }

  return await this.proxyCommand(endpoint, 'POST', params, endpoint !== homescreen);
};

commands.touchId = async function touchId(match = true) {
  await this.mobileSendBiometricMatch({
    match
  });
};

commands.toggleEnrollTouchId = async function toggleEnrollTouchId(isEnabled = true) {
  await this.mobileEnrollBiometric({
    isEnabled
  });
};

helpers.getWindowSizeWeb = async function getWindowSizeWeb() {
  return await this.executeAtom('get_window_size', []);
};

helpers.getWindowSizeNative = async function getWindowSizeNative() {
  return await this.proxyCommand(`/window/size`, 'GET');
};

commands.getWindowSize = async function getWindowSize(windowHandle = 'current') {
  if (windowHandle !== 'current') {
    throw new _baseDriver.errors.NotYetImplementedError('Currently only getting current window size is supported.');
  }

  if (!this.isWebContext()) {
    return await this.getWindowSizeNative();
  } else {
    return await this.getWindowSizeWeb();
  }
};

commands.getDeviceTime = async function getDeviceTime(format = MOMENT_FORMAT_ISO8601) {
  this.log.info('Attempting to capture iOS device date and time');

  if (!this.isRealDevice()) {
    this.log.info('On simulator. Assuming device time is the same as host time');
    const cmd = 'date';
    const args = ['+%Y-%m-%dT%H:%M:%S%z'];
    const inputFormat = 'YYYY-MM-DDTHH:mm:ssZZ';
    const stdout = (await (0, _teen_process.exec)(cmd, args)).stdout.trim();
    this.log.debug(`Got the following output out of '${cmd} ${args.join(' ')}': ${stdout}`);

    const parsedTimestamp = _momentTimezone.default.utc(stdout, inputFormat);

    if (!parsedTimestamp.isValid()) {
      this.log.warn(`Cannot parse the timestamp '${stdout}' returned by '${cmd}' command. Returning it as is`);
      return stdout;
    }

    return parsedTimestamp.utcOffset(parsedTimestamp._tzm || 0).format(format);
  }

  const {
    timestamp,
    utcOffset,
    timeZone
  } = await _appiumIosDevice.utilities.getDeviceTime(this.opts.udid);
  this.log.debug(`timestamp: ${timestamp}, utcOffset: ${utcOffset}, timeZone: ${timeZone}`);

  const utc = _momentTimezone.default.unix(timestamp).utc();

  if (Math.abs(utcOffset) <= 12 * 60) {
    return utc.utcOffset(utcOffset).format(format);
  }

  if (_lodash.default.includes(timeZone, '/')) {
    return utc.tz(timeZone).format(format);
  }

  if (Math.abs(timeZone) <= 12 * 60 * 60) {
    return utc.utcOffset(timeZone / 60).format(format);
  }

  this.log.warn('Did not know how to apply the UTC offset. Returning the timestamp without it');
  return utc.format(format);
};

commands.mobileGetDeviceTime = async function mobileGetDeviceTime(opts = {}) {
  return await this.getDeviceTime(opts.format);
};

commands.getWindowRect = async function getWindowRect() {
  const {
    width,
    height
  } = await this.getWindowSize();
  return {
    width,
    height,
    x: 0,
    y: 0
  };
};

commands.hideKeyboard = async function hideKeyboard(strategy, ...possibleKeys) {
  const keyNames = _lodash.default.compact(possibleKeys.slice(0, -1)).map(x => `${x}`);

  if (!keyNames.includes('done')) {
    keyNames.push('done');
  }

  await this.proxyCommand('/wda/keyboard/dismiss', 'POST', {
    keyNames
  });
};

commands.getStrings = async function getStrings(language, stringFile = null) {
  this.log.debug(`Gettings strings for language '${language}' and string file '${stringFile}'`);
  return await (0, _appUtils.parseLocalizableStrings)(Object.assign({}, this.opts, {
    language,
    stringFile,
    strictMode: true
  }));
};

commands.removeApp = async function removeApp(bundleId) {
  return await this.mobileRemoveApp({
    bundleId
  });
};

commands.launchApp = async function launchApp() {
  const appName = this.opts.app || this.opts.bundleId;

  try {
    await this.start();
    this.log.info(`Successfully launched the '${appName}' app.`);
  } catch (err) {
    this.log.warn(`Something went wrong while launching the '${appName}' app.`);
    throw err;
  }
};

commands.closeApp = async function closeApp() {
  const appName = this.opts.app || this.opts.bundleId;

  try {
    await this.stop();
    this.log.info(`Successfully closed the '${appName}' app.`);
  } catch (err) {
    this.log.warn(`Something went wrong while closing the '${appName}' app.`);
    throw err;
  }
};

commands.keys = async function keys(keys) {
  if (!this.isWebContext()) {
    throw new _baseDriver.errors.UnknownError('Command should be proxied to WDA');
  }

  let el = _support.util.unwrapElement(await this.active());

  if (_lodash.default.isEmpty(el)) {
    throw new _baseDriver.errors.NoSuchElementError();
  }

  await this.setValue(keys, el);
};

commands.setUrl = async function setUrl(url) {
  this.log.debug(`Attempting to set url '${url}'`);

  if (this.isWebContext()) {
    this.setCurrentUrl(url);
    this.curWebFrames = [];
    await this.remote.navToUrl(url);
    return;
  }

  if (this.isRealDevice()) {
    await this.proxyCommand('/url', 'POST', {
      url
    });
  } else {
    await this.opts.device.simctl.openUrl(url);
  }
};

commands.getViewportRect = async function getViewportRect() {
  const scale = await this.getDevicePixelRatio();
  const statusBarHeight = Math.round((await this.getStatusBarHeight()) * scale);
  const windowSize = await this.getWindowSize();
  return {
    left: 0,
    top: statusBarHeight,
    width: windowSize.width * scale,
    height: windowSize.height * scale - statusBarHeight
  };
};

commands.getScreenInfo = async function getScreenInfo() {
  return await this.proxyCommand('/wda/screen', 'GET');
};

commands.getStatusBarHeight = async function getStatusBarHeight() {
  const {
    statusBarSize
  } = await this.getScreenInfo();
  return statusBarSize.height;
};

commands.getDevicePixelRatio = async function getDevicePixelRatio() {
  const {
    scale
  } = await this.getScreenInfo();
  return scale;
};

commands.mobilePressButton = async function mobilePressButton(opts = {}) {
  const {
    name,
    durationSeconds
  } = opts;

  if (!name) {
    throw new _baseDriver.errors.InvalidArgumentError('Button name is mandatory');
  }

  if (!_lodash.default.isNil(durationSeconds) && !_lodash.default.isNumber(durationSeconds)) {
    throw new _baseDriver.errors.InvalidArgumentError('durationSeconds should be a number');
  }

  return await this.proxyCommand('/wda/pressButton', 'POST', {
    name,
    duration: durationSeconds
  });
};

commands.mobileSiriCommand = async function mobileSiriCommand(opts = {}) {
  const {
    text
  } = opts;

  if (!_support.util.hasValue(text)) {
    throw new _baseDriver.errors.InvalidArgumentError('"text" argument is mandatory');
  }

  return await this.proxyCommand('/wda/siri/activate', 'POST', {
    text
  });
};

Object.assign(extensions, commands, helpers);
var _default = extensions;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGliL2NvbW1hbmRzL2dlbmVyYWwuanMiLCJuYW1lcyI6WyJjb21tYW5kcyIsImhlbHBlcnMiLCJleHRlbnNpb25zIiwiTU9NRU5UX0ZPUk1BVF9JU084NjAxIiwiYWN0aXZlIiwiaXNXZWJDb250ZXh0IiwiY2FjaGVXZWJFbGVtZW50cyIsImV4ZWN1dGVBdG9tIiwicHJveHlDb21tYW5kIiwiYmFja2dyb3VuZCIsInNlY29uZHMiLCJob21lc2NyZWVuIiwiZGVhY3RpdmF0ZUFwcCIsImVuZHBvaW50IiwicGFyYW1zIiwic2VsZWN0RW5kcG9pbnQiLCJ0aW1lb3V0U2Vjb25kcyIsInV0aWwiLCJoYXNWYWx1ZSIsImlzTmFOIiwiZHVyYXRpb24iLCJwYXJzZUZsb2F0IiwiXyIsImhhcyIsInRpbWVvdXQiLCJlcnJvcnMiLCJJbnZhbGlkQXJndW1lbnRFcnJvciIsIkpTT04iLCJzdHJpbmdpZnkiLCJ0b3VjaElkIiwibWF0Y2giLCJtb2JpbGVTZW5kQmlvbWV0cmljTWF0Y2giLCJ0b2dnbGVFbnJvbGxUb3VjaElkIiwiaXNFbmFibGVkIiwibW9iaWxlRW5yb2xsQmlvbWV0cmljIiwiZ2V0V2luZG93U2l6ZVdlYiIsImdldFdpbmRvd1NpemVOYXRpdmUiLCJnZXRXaW5kb3dTaXplIiwid2luZG93SGFuZGxlIiwiTm90WWV0SW1wbGVtZW50ZWRFcnJvciIsImdldERldmljZVRpbWUiLCJmb3JtYXQiLCJsb2ciLCJpbmZvIiwiaXNSZWFsRGV2aWNlIiwiY21kIiwiYXJncyIsImlucHV0Rm9ybWF0Iiwic3Rkb3V0IiwiZXhlYyIsInRyaW0iLCJkZWJ1ZyIsImpvaW4iLCJwYXJzZWRUaW1lc3RhbXAiLCJtb21lbnQiLCJ1dGMiLCJpc1ZhbGlkIiwid2FybiIsInV0Y09mZnNldCIsIl90em0iLCJ0aW1lc3RhbXAiLCJ0aW1lWm9uZSIsInV0aWxpdGllcyIsIm9wdHMiLCJ1ZGlkIiwidW5peCIsIk1hdGgiLCJhYnMiLCJpbmNsdWRlcyIsInR6IiwibW9iaWxlR2V0RGV2aWNlVGltZSIsImdldFdpbmRvd1JlY3QiLCJ3aWR0aCIsImhlaWdodCIsIngiLCJ5IiwiaGlkZUtleWJvYXJkIiwic3RyYXRlZ3kiLCJwb3NzaWJsZUtleXMiLCJrZXlOYW1lcyIsImNvbXBhY3QiLCJzbGljZSIsIm1hcCIsInB1c2giLCJnZXRTdHJpbmdzIiwibGFuZ3VhZ2UiLCJzdHJpbmdGaWxlIiwicGFyc2VMb2NhbGl6YWJsZVN0cmluZ3MiLCJPYmplY3QiLCJhc3NpZ24iLCJzdHJpY3RNb2RlIiwicmVtb3ZlQXBwIiwiYnVuZGxlSWQiLCJtb2JpbGVSZW1vdmVBcHAiLCJsYXVuY2hBcHAiLCJhcHBOYW1lIiwiYXBwIiwic3RhcnQiLCJlcnIiLCJjbG9zZUFwcCIsInN0b3AiLCJrZXlzIiwiVW5rbm93bkVycm9yIiwiZWwiLCJ1bndyYXBFbGVtZW50IiwiaXNFbXB0eSIsIk5vU3VjaEVsZW1lbnRFcnJvciIsInNldFZhbHVlIiwic2V0VXJsIiwidXJsIiwic2V0Q3VycmVudFVybCIsImN1cldlYkZyYW1lcyIsInJlbW90ZSIsIm5hdlRvVXJsIiwiZGV2aWNlIiwic2ltY3RsIiwib3BlblVybCIsImdldFZpZXdwb3J0UmVjdCIsInNjYWxlIiwiZ2V0RGV2aWNlUGl4ZWxSYXRpbyIsInN0YXR1c0JhckhlaWdodCIsInJvdW5kIiwiZ2V0U3RhdHVzQmFySGVpZ2h0Iiwid2luZG93U2l6ZSIsImxlZnQiLCJ0b3AiLCJnZXRTY3JlZW5JbmZvIiwic3RhdHVzQmFyU2l6ZSIsIm1vYmlsZVByZXNzQnV0dG9uIiwibmFtZSIsImR1cmF0aW9uU2Vjb25kcyIsImlzTmlsIiwiaXNOdW1iZXIiLCJtb2JpbGVTaXJpQ29tbWFuZCIsInRleHQiXSwic291cmNlUm9vdCI6Ii4uLy4uLy4uIiwic291cmNlcyI6WyJsaWIvY29tbWFuZHMvZ2VuZXJhbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXyBmcm9tICdsb2Rhc2gnO1xuaW1wb3J0IHsgZXJyb3JzIH0gZnJvbSAnQGFwcGl1bS9iYXNlLWRyaXZlcic7XG5pbXBvcnQgeyB1dGlsIH0gZnJvbSAnQGFwcGl1bS9zdXBwb3J0JztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50LXRpbWV6b25lJztcbmltcG9ydCB7IHV0aWxpdGllcyB9IGZyb20gJ2FwcGl1bS1pb3MtZGV2aWNlJztcbmltcG9ydCB7IGV4ZWMgfSBmcm9tICd0ZWVuX3Byb2Nlc3MnO1xuaW1wb3J0IHsgcGFyc2VMb2NhbGl6YWJsZVN0cmluZ3MgfSBmcm9tICcuLi9hcHAtdXRpbHMnO1xuXG5sZXQgY29tbWFuZHMgPSB7fSwgaGVscGVycyA9IHt9LCBleHRlbnNpb25zID0ge307XG5cbmNvbnN0IE1PTUVOVF9GT1JNQVRfSVNPODYwMSA9ICdZWVlZLU1NLUREVEhIOm1tOnNzWic7XG5cblxuY29tbWFuZHMuYWN0aXZlID0gYXN5bmMgZnVuY3Rpb24gYWN0aXZlICgpIHtcbiAgaWYgKHRoaXMuaXNXZWJDb250ZXh0KCkpIHtcbiAgICByZXR1cm4gdGhpcy5jYWNoZVdlYkVsZW1lbnRzKGF3YWl0IHRoaXMuZXhlY3V0ZUF0b20oJ2FjdGl2ZV9lbGVtZW50JywgW10pKTtcbiAgfVxuICByZXR1cm4gYXdhaXQgdGhpcy5wcm94eUNvbW1hbmQoYC9lbGVtZW50L2FjdGl2ZWAsICdHRVQnKTtcbn07XG5cbi8qKlxuICogQ2xvc2UgYXBwIChzaW11bGF0ZSBkZXZpY2UgaG9tZSBidXR0b24pLiBJdCBpcyBwb3NzaWJsZSB0byByZXN0b3JlXG4gKiB0aGUgYXBwIGFmdGVyIHRoZSB0aW1lb3V0IG9yIGtlZXAgaXQgbWluaW1pemVkIGJhc2VkIG9uIHRoZSBwYXJhbWV0ZXIgdmFsdWUuXG4gKlxuICogQHBhcmFtIHs/bnVtYmVyfE9iamVjdH0gc2Vjb25kc1xuICogLSBhbnkgcG9zaXRpdmUgbnVtYmVyIG9mIHNlY29uZHM6IGNvbWUgYmFjayBhZnRlciBYIHNlY29uZHNcbiAqIC0gYW55IG5lZ2F0aXZlIG51bWJlciBvZiBzZWNvbmRzIG9yIHplcm86IG5ldmVyIGNvbWUgYmFja1xuICogLSB1bmRlZmluZWQvbnVsbDogbmV2ZXIgY29tZSBiYWNrXG4gKiAtIHt0aW1lb3V0OiA1MDAwfTogY29tZSBiYWNrIGFmdGVyIDUgc2Vjb25kc1xuICogLSB7dGltZW91dDogbnVsbH0sIHt0aW1lb3V0OiAtMn06IG5ldmVyIGNvbWUgYmFja1xuICovXG5jb21tYW5kcy5iYWNrZ3JvdW5kID0gYXN5bmMgZnVuY3Rpb24gYmFja2dyb3VuZCAoc2Vjb25kcykge1xuICBjb25zdCBob21lc2NyZWVuID0gJy93ZGEvaG9tZXNjcmVlbic7XG4gIGNvbnN0IGRlYWN0aXZhdGVBcHAgPSAnL3dkYS9kZWFjdGl2YXRlQXBwJztcblxuICBsZXQgZW5kcG9pbnQ7XG4gIGxldCBwYXJhbXMgPSB7fTtcbiAgY29uc3Qgc2VsZWN0RW5kcG9pbnQgPSAodGltZW91dFNlY29uZHMpID0+IHtcbiAgICBpZiAoIXV0aWwuaGFzVmFsdWUodGltZW91dFNlY29uZHMpKSB7XG4gICAgICBlbmRwb2ludCA9IGhvbWVzY3JlZW47XG4gICAgfSBlbHNlIGlmICghaXNOYU4odGltZW91dFNlY29uZHMpKSB7XG4gICAgICBjb25zdCBkdXJhdGlvbiA9IHBhcnNlRmxvYXQodGltZW91dFNlY29uZHMpO1xuICAgICAgaWYgKGR1cmF0aW9uID49IDApIHtcbiAgICAgICAgcGFyYW1zID0ge2R1cmF0aW9ufTtcbiAgICAgICAgZW5kcG9pbnQgPSBkZWFjdGl2YXRlQXBwO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZW5kcG9pbnQgPSBob21lc2NyZWVuO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgaWYgKF8uaGFzKHNlY29uZHMsICd0aW1lb3V0JykpIHtcbiAgICBjb25zdCB7dGltZW91dH0gPSBzZWNvbmRzO1xuICAgIHNlbGVjdEVuZHBvaW50KGlzTmFOKHRpbWVvdXQpID8gdGltZW91dCA6IHBhcnNlRmxvYXQodGltZW91dCkgLyAxMDAwLjApO1xuICB9IGVsc2Uge1xuICAgIHNlbGVjdEVuZHBvaW50KHNlY29uZHMpO1xuICB9XG4gIGlmICghZW5kcG9pbnQpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLkludmFsaWRBcmd1bWVudEVycm9yKGBBcmd1bWVudCB2YWx1ZSBpcyBleHBlY3RlZCB0byBiZSBhIHZhbGlkIG51bWJlci4gYCArXG4gICAgICBgJHtKU09OLnN0cmluZ2lmeShzZWNvbmRzKX0gaGFzIGJlZW4gcHJvdmlkZWQgaW5zdGVhZGApO1xuICB9XG4gIHJldHVybiBhd2FpdCB0aGlzLnByb3h5Q29tbWFuZChlbmRwb2ludCwgJ1BPU1QnLCBwYXJhbXMsIGVuZHBvaW50ICE9PSBob21lc2NyZWVuKTtcbn07XG5cbmNvbW1hbmRzLnRvdWNoSWQgPSBhc3luYyBmdW5jdGlvbiB0b3VjaElkIChtYXRjaCA9IHRydWUpIHtcbiAgYXdhaXQgdGhpcy5tb2JpbGVTZW5kQmlvbWV0cmljTWF0Y2goe21hdGNofSk7XG59O1xuXG5jb21tYW5kcy50b2dnbGVFbnJvbGxUb3VjaElkID0gYXN5bmMgZnVuY3Rpb24gdG9nZ2xlRW5yb2xsVG91Y2hJZCAoaXNFbmFibGVkID0gdHJ1ZSkge1xuICBhd2FpdCB0aGlzLm1vYmlsZUVucm9sbEJpb21ldHJpYyh7aXNFbmFibGVkfSk7XG59O1xuXG5oZWxwZXJzLmdldFdpbmRvd1NpemVXZWIgPSBhc3luYyBmdW5jdGlvbiBnZXRXaW5kb3dTaXplV2ViICgpIHtcbiAgcmV0dXJuIGF3YWl0IHRoaXMuZXhlY3V0ZUF0b20oJ2dldF93aW5kb3dfc2l6ZScsIFtdKTtcbn07XG5cbmhlbHBlcnMuZ2V0V2luZG93U2l6ZU5hdGl2ZSA9IGFzeW5jIGZ1bmN0aW9uIGdldFdpbmRvd1NpemVOYXRpdmUgKCkge1xuICByZXR1cm4gYXdhaXQgdGhpcy5wcm94eUNvbW1hbmQoYC93aW5kb3cvc2l6ZWAsICdHRVQnKTtcbn07XG5cbmNvbW1hbmRzLmdldFdpbmRvd1NpemUgPSBhc3luYyBmdW5jdGlvbiBnZXRXaW5kb3dTaXplICh3aW5kb3dIYW5kbGUgPSAnY3VycmVudCcpIHtcbiAgaWYgKHdpbmRvd0hhbmRsZSAhPT0gJ2N1cnJlbnQnKSB7XG4gICAgdGhyb3cgbmV3IGVycm9ycy5Ob3RZZXRJbXBsZW1lbnRlZEVycm9yKCdDdXJyZW50bHkgb25seSBnZXR0aW5nIGN1cnJlbnQgd2luZG93IHNpemUgaXMgc3VwcG9ydGVkLicpO1xuICB9XG5cbiAgaWYgKCF0aGlzLmlzV2ViQ29udGV4dCgpKSB7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuZ2V0V2luZG93U2l6ZU5hdGl2ZSgpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBhd2FpdCB0aGlzLmdldFdpbmRvd1NpemVXZWIoKTtcbiAgfVxufTtcblxuLyoqXG4gKiBSZXRyaWV2ZXMgdGhlIGN1cnJlbnQgZGV2aWNlJ3MgdGltZXN0YW1wLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBmb3JtYXQgLSBUaGUgc2V0IG9mIGZvcm1hdCBzcGVjaWZpZXJzLiBSZWFkXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgaHR0cHM6Ly9tb21lbnRqcy5jb20vZG9jcy8gdG8gZ2V0IHRoZSBmdWxsIGxpc3Qgb2Ygc3VwcG9ydGVkXG4gKiAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZXRpbWUgZm9ybWF0IHNwZWNpZmllcnMuIFRoZSBkZWZhdWx0IGZvcm1hdCBpc1xuICogICAgICAgICAgICAgICAgICAgICAgICAgIGBZWVlZLU1NLUREVEhIOm1tOnNzWmAsIHdoaWNoIGNvbXBsaWVzIHRvIElTTy04NjAxXG4gKiBAcmV0dXJucyBGb3JtYXR0ZWQgZGF0ZXRpbWUgc3RyaW5nIG9yIHRoZSByYXcgY29tbWFuZCBvdXRwdXQgaWYgZm9ybWF0dGluZyBmYWlsc1xuICovXG5jb21tYW5kcy5nZXREZXZpY2VUaW1lID0gYXN5bmMgZnVuY3Rpb24gZ2V0RGV2aWNlVGltZSAoZm9ybWF0ID0gTU9NRU5UX0ZPUk1BVF9JU084NjAxKSB7XG4gIHRoaXMubG9nLmluZm8oJ0F0dGVtcHRpbmcgdG8gY2FwdHVyZSBpT1MgZGV2aWNlIGRhdGUgYW5kIHRpbWUnKTtcbiAgaWYgKCF0aGlzLmlzUmVhbERldmljZSgpKSB7XG4gICAgdGhpcy5sb2cuaW5mbygnT24gc2ltdWxhdG9yLiBBc3N1bWluZyBkZXZpY2UgdGltZSBpcyB0aGUgc2FtZSBhcyBob3N0IHRpbWUnKTtcbiAgICBjb25zdCBjbWQgPSAnZGF0ZSc7XG4gICAgY29uc3QgYXJncyA9IFsnKyVZLSVtLSVkVCVIOiVNOiVTJXonXTtcbiAgICBjb25zdCBpbnB1dEZvcm1hdCA9ICdZWVlZLU1NLUREVEhIOm1tOnNzWlonO1xuICAgIGNvbnN0IHN0ZG91dCA9IChhd2FpdCBleGVjKGNtZCwgYXJncykpLnN0ZG91dC50cmltKCk7XG4gICAgdGhpcy5sb2cuZGVidWcoYEdvdCB0aGUgZm9sbG93aW5nIG91dHB1dCBvdXQgb2YgJyR7Y21kfSAke2FyZ3Muam9pbignICcpfSc6ICR7c3Rkb3V0fWApO1xuICAgIGNvbnN0IHBhcnNlZFRpbWVzdGFtcCA9IG1vbWVudC51dGMoc3Rkb3V0LCBpbnB1dEZvcm1hdCk7XG4gICAgaWYgKCFwYXJzZWRUaW1lc3RhbXAuaXNWYWxpZCgpKSB7XG4gICAgICB0aGlzLmxvZy53YXJuKGBDYW5ub3QgcGFyc2UgdGhlIHRpbWVzdGFtcCAnJHtzdGRvdXR9JyByZXR1cm5lZCBieSAnJHtjbWR9JyBjb21tYW5kLiBSZXR1cm5pbmcgaXQgYXMgaXNgKTtcbiAgICAgIHJldHVybiBzdGRvdXQ7XG4gICAgfVxuICAgIHJldHVybiBwYXJzZWRUaW1lc3RhbXAudXRjT2Zmc2V0KHBhcnNlZFRpbWVzdGFtcC5fdHptIHx8IDApLmZvcm1hdChmb3JtYXQpO1xuICB9XG5cbiAgY29uc3Qge1xuICAgIHRpbWVzdGFtcCxcbiAgICB1dGNPZmZzZXQsXG4gICAgdGltZVpvbmUsXG4gIH0gPSBhd2FpdCB1dGlsaXRpZXMuZ2V0RGV2aWNlVGltZSh0aGlzLm9wdHMudWRpZCk7XG4gIHRoaXMubG9nLmRlYnVnKGB0aW1lc3RhbXA6ICR7dGltZXN0YW1wfSwgdXRjT2Zmc2V0OiAke3V0Y09mZnNldH0sIHRpbWVab25lOiAke3RpbWVab25lfWApO1xuICBjb25zdCB1dGMgPSBtb21lbnQudW5peCh0aW1lc3RhbXApLnV0YygpO1xuICAvLyBhdCBzb21lIHBvaW50IG9mIHRpbWUgQXBwbGUgc3RhcnRlZCB0byByZXR1cm4gdGltZXN0YW1wc1xuICAvLyBpbiB1dGNPZmZzZXQgaW5zdGVhZCBvZiBhY3R1YWwgVVRDIG9mZnNldHNcbiAgaWYgKE1hdGguYWJzKHV0Y09mZnNldCkgPD0gMTIgKiA2MCkge1xuICAgIHJldHVybiB1dGMudXRjT2Zmc2V0KHV0Y09mZnNldCkuZm9ybWF0KGZvcm1hdCk7XG4gIH1cbiAgLy8gdGltZVpvbmUgY291bGQgZWl0aGVyIGJlIGEgdGltZSB6b25lIG5hbWUgb3JcbiAgLy8gYW4gVVRDIG9mZnNldCBpbiBzZWNvbmRzXG4gIGlmIChfLmluY2x1ZGVzKHRpbWVab25lLCAnLycpKSB7XG4gICAgcmV0dXJuIHV0Yy50eih0aW1lWm9uZSkuZm9ybWF0KGZvcm1hdCk7XG4gIH1cbiAgaWYgKE1hdGguYWJzKHRpbWVab25lKSA8PSAxMiAqIDYwICogNjApIHtcbiAgICByZXR1cm4gdXRjLnV0Y09mZnNldCh0aW1lWm9uZSAvIDYwKS5mb3JtYXQoZm9ybWF0KTtcbiAgfVxuICB0aGlzLmxvZy53YXJuKCdEaWQgbm90IGtub3cgaG93IHRvIGFwcGx5IHRoZSBVVEMgb2Zmc2V0LiBSZXR1cm5pbmcgdGhlIHRpbWVzdGFtcCB3aXRob3V0IGl0Jyk7XG4gIHJldHVybiB1dGMuZm9ybWF0KGZvcm1hdCk7XG59O1xuXG4vKipcbiAqIEB0eXBlZGVmIHtPYmplY3R9IERldmljZVRpbWVPcHRpb25zXG4gKiBAcHJvcGVydHkge3N0cmluZ30gZm9ybWF0IFtZWVlZLU1NLUREVEhIOm1tOnNzWl0gLSBTZWUgZ2V0RGV2aWNlVGltZSNmb3JtYXRcbiAqL1xuXG4vKipcbiAqIFJldHJpZXZlcyB0aGUgY3VycmVudCBkZXZpY2UgdGltZVxuICpcbiAqIEBwYXJhbSB7RGV2aWNlVGltZU9wdGlvbnN9IG9wdHNcbiAqIEByZXR1cm4ge3N0cmluZ30gRm9ybWF0dGVkIGRhdGV0aW1lIHN0cmluZyBvciB0aGUgcmF3IGNvbW1hbmQgb3V0cHV0IGlmIGZvcm1hdHRpbmcgZmFpbHNcbiAqL1xuY29tbWFuZHMubW9iaWxlR2V0RGV2aWNlVGltZSA9IGFzeW5jIGZ1bmN0aW9uIG1vYmlsZUdldERldmljZVRpbWUgKG9wdHMgPSB7fSkge1xuICByZXR1cm4gYXdhaXQgdGhpcy5nZXREZXZpY2VUaW1lKG9wdHMuZm9ybWF0KTtcbn07XG5cbi8vIEZvciBXM0NcbmNvbW1hbmRzLmdldFdpbmRvd1JlY3QgPSBhc3luYyBmdW5jdGlvbiBnZXRXaW5kb3dSZWN0ICgpIHtcbiAgY29uc3Qge3dpZHRoLCBoZWlnaHR9ID0gYXdhaXQgdGhpcy5nZXRXaW5kb3dTaXplKCk7XG4gIHJldHVybiB7XG4gICAgd2lkdGgsXG4gICAgaGVpZ2h0LFxuICAgIHg6IDAsXG4gICAgeTogMFxuICB9O1xufTtcblxuY29tbWFuZHMuaGlkZUtleWJvYXJkID0gYXN5bmMgZnVuY3Rpb24gaGlkZUtleWJvYXJkIChzdHJhdGVneSwgLi4ucG9zc2libGVLZXlzKSB7XG4gIC8vIGxhc3QgcGFyYW1ldGVyIGlzIHRoZSBzZXNzaW9uIGlkXG4gIGNvbnN0IGtleU5hbWVzID0gXy5jb21wYWN0KHBvc3NpYmxlS2V5cy5zbGljZSgwLCAtMSkpLm1hcCgoeCkgPT4gYCR7eH1gKTtcbiAgaWYgKCFrZXlOYW1lcy5pbmNsdWRlcygnZG9uZScpKSB7XG4gICAga2V5TmFtZXMucHVzaCgnZG9uZScpO1xuICB9XG4gIGF3YWl0IHRoaXMucHJveHlDb21tYW5kKCcvd2RhL2tleWJvYXJkL2Rpc21pc3MnLCAnUE9TVCcsIHtrZXlOYW1lc30pO1xufTtcblxuY29tbWFuZHMuZ2V0U3RyaW5ncyA9IGFzeW5jIGZ1bmN0aW9uIGdldFN0cmluZ3MgKGxhbmd1YWdlLCBzdHJpbmdGaWxlID0gbnVsbCkge1xuICB0aGlzLmxvZy5kZWJ1ZyhgR2V0dGluZ3Mgc3RyaW5ncyBmb3IgbGFuZ3VhZ2UgJyR7bGFuZ3VhZ2V9JyBhbmQgc3RyaW5nIGZpbGUgJyR7c3RyaW5nRmlsZX0nYCk7XG4gIHJldHVybiBhd2FpdCBwYXJzZUxvY2FsaXphYmxlU3RyaW5ncyhPYmplY3QuYXNzaWduKHt9LCB0aGlzLm9wdHMsIHtcbiAgICBsYW5ndWFnZSxcbiAgICBzdHJpbmdGaWxlLFxuICAgIHN0cmljdE1vZGU6IHRydWUsXG4gIH0pKTtcbn07XG5cbmNvbW1hbmRzLnJlbW92ZUFwcCA9IGFzeW5jIGZ1bmN0aW9uIHJlbW92ZUFwcCAoYnVuZGxlSWQpIHtcbiAgcmV0dXJuIGF3YWl0IHRoaXMubW9iaWxlUmVtb3ZlQXBwKHtidW5kbGVJZH0pO1xufTtcblxuY29tbWFuZHMubGF1bmNoQXBwID0gYXN5bmMgZnVuY3Rpb24gbGF1bmNoQXBwICgpIHtcbiAgY29uc3QgYXBwTmFtZSA9IHRoaXMub3B0cy5hcHAgfHwgdGhpcy5vcHRzLmJ1bmRsZUlkO1xuICB0cnkge1xuICAgIGF3YWl0IHRoaXMuc3RhcnQoKTtcbiAgICB0aGlzLmxvZy5pbmZvKGBTdWNjZXNzZnVsbHkgbGF1bmNoZWQgdGhlICcke2FwcE5hbWV9JyBhcHAuYCk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHRoaXMubG9nLndhcm4oYFNvbWV0aGluZyB3ZW50IHdyb25nIHdoaWxlIGxhdW5jaGluZyB0aGUgJyR7YXBwTmFtZX0nIGFwcC5gKTtcbiAgICB0aHJvdyBlcnI7XG4gIH1cbn07XG5cbmNvbW1hbmRzLmNsb3NlQXBwID0gYXN5bmMgZnVuY3Rpb24gY2xvc2VBcHAgKCkge1xuICBjb25zdCBhcHBOYW1lID0gdGhpcy5vcHRzLmFwcCB8fCB0aGlzLm9wdHMuYnVuZGxlSWQ7XG4gIHRyeSB7XG4gICAgYXdhaXQgdGhpcy5zdG9wKCk7XG4gICAgdGhpcy5sb2cuaW5mbyhgU3VjY2Vzc2Z1bGx5IGNsb3NlZCB0aGUgJyR7YXBwTmFtZX0nIGFwcC5gKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgdGhpcy5sb2cud2FybihgU29tZXRoaW5nIHdlbnQgd3Jvbmcgd2hpbGUgY2xvc2luZyB0aGUgJyR7YXBwTmFtZX0nIGFwcC5gKTtcbiAgICB0aHJvdyBlcnI7XG4gIH1cbn07XG5cbmNvbW1hbmRzLmtleXMgPSBhc3luYyBmdW5jdGlvbiBrZXlzIChrZXlzKSB7XG4gIGlmICghdGhpcy5pc1dlYkNvbnRleHQoKSkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuVW5rbm93bkVycm9yKCdDb21tYW5kIHNob3VsZCBiZSBwcm94aWVkIHRvIFdEQScpO1xuICB9XG4gIGxldCBlbCA9IHV0aWwudW53cmFwRWxlbWVudChhd2FpdCB0aGlzLmFjdGl2ZSgpKTtcbiAgaWYgKF8uaXNFbXB0eShlbCkpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLk5vU3VjaEVsZW1lbnRFcnJvcigpO1xuICB9XG4gIGF3YWl0IHRoaXMuc2V0VmFsdWUoa2V5cywgZWwpO1xufTtcblxuY29tbWFuZHMuc2V0VXJsID0gYXN5bmMgZnVuY3Rpb24gc2V0VXJsICh1cmwpIHtcbiAgdGhpcy5sb2cuZGVidWcoYEF0dGVtcHRpbmcgdG8gc2V0IHVybCAnJHt1cmx9J2ApO1xuXG4gIGlmICh0aGlzLmlzV2ViQ29udGV4dCgpKSB7XG4gICAgdGhpcy5zZXRDdXJyZW50VXJsKHVybCk7XG4gICAgLy8gbWFrZSBzdXJlIHRvIGNsZWFyIG91dCBhbnkgbGVmdG92ZXIgd2ViIGZyYW1lc1xuICAgIHRoaXMuY3VyV2ViRnJhbWVzID0gW107XG4gICAgYXdhaXQgdGhpcy5yZW1vdGUubmF2VG9VcmwodXJsKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAodGhpcy5pc1JlYWxEZXZpY2UoKSkge1xuICAgIGF3YWl0IHRoaXMucHJveHlDb21tYW5kKCcvdXJsJywgJ1BPU1QnLCB7dXJsfSk7XG4gIH0gZWxzZSB7XG4gICAgYXdhaXQgdGhpcy5vcHRzLmRldmljZS5zaW1jdGwub3BlblVybCh1cmwpO1xuICB9XG59O1xuXG5jb21tYW5kcy5nZXRWaWV3cG9ydFJlY3QgPSBhc3luYyBmdW5jdGlvbiBnZXRWaWV3cG9ydFJlY3QgKCkge1xuICBjb25zdCBzY2FsZSA9IGF3YWl0IHRoaXMuZ2V0RGV2aWNlUGl4ZWxSYXRpbygpO1xuICAvLyBzdGF0dXMgYmFyIGhlaWdodCBjb21lcyBpbiB1bnNjYWxlZCwgc28gc2NhbGUgaXRcbiAgY29uc3Qgc3RhdHVzQmFySGVpZ2h0ID0gTWF0aC5yb3VuZChhd2FpdCB0aGlzLmdldFN0YXR1c0JhckhlaWdodCgpICogc2NhbGUpO1xuICBjb25zdCB3aW5kb3dTaXplID0gYXdhaXQgdGhpcy5nZXRXaW5kb3dTaXplKCk7XG5cbiAgLy8gaW9zIHJldHVybnMgY29vcmRpbmF0ZXMvZGltZW5zaW9ucyBpbiBsb2dpY2FsIHBpeGVscywgbm90IGRldmljZSBwaXhlbHMsXG4gIC8vIHNvIHNjYWxlIHVwIHRvIGRldmljZSBwaXhlbHMuIHN0YXR1cyBiYXIgaGVpZ2h0IGlzIGFscmVhZHkgc2NhbGVkLlxuICByZXR1cm4ge1xuICAgIGxlZnQ6IDAsXG4gICAgdG9wOiBzdGF0dXNCYXJIZWlnaHQsXG4gICAgd2lkdGg6IHdpbmRvd1NpemUud2lkdGggKiBzY2FsZSxcbiAgICBoZWlnaHQ6ICgod2luZG93U2l6ZS5oZWlnaHQgKiBzY2FsZSkgLSBzdGF0dXNCYXJIZWlnaHQpLFxuICB9O1xufTtcblxuLy8gbWVtb2l6ZWQgaW4gY29uc3RydWN0b3JcbmNvbW1hbmRzLmdldFNjcmVlbkluZm8gPSBhc3luYyBmdW5jdGlvbiBnZXRTY3JlZW5JbmZvICgpIHtcbiAgcmV0dXJuIGF3YWl0IHRoaXMucHJveHlDb21tYW5kKCcvd2RhL3NjcmVlbicsICdHRVQnKTtcbn07XG5cbmNvbW1hbmRzLmdldFN0YXR1c0JhckhlaWdodCA9IGFzeW5jIGZ1bmN0aW9uIGdldFN0YXR1c0JhckhlaWdodCAoKSB7XG4gIGNvbnN0IHtzdGF0dXNCYXJTaXplfSA9IGF3YWl0IHRoaXMuZ2V0U2NyZWVuSW5mbygpO1xuICByZXR1cm4gc3RhdHVzQmFyU2l6ZS5oZWlnaHQ7XG59O1xuXG4vLyBtZW1vaXplZCBpbiBjb25zdHJ1Y3RvclxuY29tbWFuZHMuZ2V0RGV2aWNlUGl4ZWxSYXRpbyA9IGFzeW5jIGZ1bmN0aW9uIGdldERldmljZVBpeGVsUmF0aW8gKCkge1xuICBjb25zdCB7c2NhbGV9ID0gYXdhaXQgdGhpcy5nZXRTY3JlZW5JbmZvKCk7XG4gIHJldHVybiBzY2FsZTtcbn07XG5cbi8qKlxuICogQHR5cGVkZWYge09iamVjdH0gUHJlc3NCdXR0b25PcHRpb25zXG4gKiBAcHJvcGVydHkge3N0cmluZ30gbmFtZSAtIFRoZSBuYW1lIG9mIHRoZSBidXR0b24gdG8gYmUgcHJlc3NlZC5cbiAqIEBwcm9wZXJ0eSB7P251bWJlcn0gZHVyYXRpb25TZWNvbmRzIC0gRHVyYXRpb24gaW4gZmxvYXQgc2Vjb25kcy5cbiAqL1xuXG4vKipcbiAqIEVtdWxhdGVzIHByZXNzIHRoZSBnaXZlbiBkZXZpdmUgYnV0dG9uIG5hbWUuXG4gKlxuICogQHBhcmFtIHtQcmVzc0J1dHRvbk9wdGlvbnN9IG9wdHNcbiAqL1xuY29tbWFuZHMubW9iaWxlUHJlc3NCdXR0b24gPSBhc3luYyBmdW5jdGlvbiBtb2JpbGVQcmVzc0J1dHRvbiAob3B0cyA9IHt9KSB7XG4gIGNvbnN0IHtuYW1lLCBkdXJhdGlvblNlY29uZHN9ID0gb3B0cztcbiAgaWYgKCFuYW1lKSB7XG4gICAgdGhyb3cgbmV3IGVycm9ycy5JbnZhbGlkQXJndW1lbnRFcnJvcignQnV0dG9uIG5hbWUgaXMgbWFuZGF0b3J5Jyk7XG4gIH1cbiAgaWYgKCFfLmlzTmlsKGR1cmF0aW9uU2Vjb25kcykgJiYgIV8uaXNOdW1iZXIoZHVyYXRpb25TZWNvbmRzKSkge1xuICAgIHRocm93IG5ldyBlcnJvcnMuSW52YWxpZEFyZ3VtZW50RXJyb3IoJ2R1cmF0aW9uU2Vjb25kcyBzaG91bGQgYmUgYSBudW1iZXInKTtcbiAgfVxuICByZXR1cm4gYXdhaXQgdGhpcy5wcm94eUNvbW1hbmQoJy93ZGEvcHJlc3NCdXR0b24nLCAnUE9TVCcsXG4gICAge25hbWUsIGR1cmF0aW9uOiBkdXJhdGlvblNlY29uZHN9KTtcbn07XG5cbmNvbW1hbmRzLm1vYmlsZVNpcmlDb21tYW5kID0gYXN5bmMgZnVuY3Rpb24gbW9iaWxlU2lyaUNvbW1hbmQgKG9wdHMgPSB7fSkge1xuICBjb25zdCB7dGV4dH0gPSBvcHRzO1xuICBpZiAoIXV0aWwuaGFzVmFsdWUodGV4dCkpIHtcbiAgICB0aHJvdyBuZXcgZXJyb3JzLkludmFsaWRBcmd1bWVudEVycm9yKCdcInRleHRcIiBhcmd1bWVudCBpcyBtYW5kYXRvcnknKTtcbiAgfVxuICByZXR1cm4gYXdhaXQgdGhpcy5wcm94eUNvbW1hbmQoJy93ZGEvc2lyaS9hY3RpdmF0ZScsICdQT1NUJywge3RleHR9KTtcbn07XG5cbk9iamVjdC5hc3NpZ24oZXh0ZW5zaW9ucywgY29tbWFuZHMsIGhlbHBlcnMpO1xuXG5leHBvcnQgeyBjb21tYW5kcywgaGVscGVycywgZXh0ZW5zaW9ucyB9O1xuZXhwb3J0IGRlZmF1bHQgZXh0ZW5zaW9ucztcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFDQTs7QUFFQSxJQUFJQSxRQUFRLEdBQUcsRUFBZjtBQUFBLElBQW1CQyxPQUFPLEdBQUcsRUFBN0I7QUFBQSxJQUFpQ0MsVUFBVSxHQUFHLEVBQTlDOzs7O0FBRUEsTUFBTUMscUJBQXFCLEdBQUcsc0JBQTlCOztBQUdBSCxRQUFRLENBQUNJLE1BQVQsR0FBa0IsZUFBZUEsTUFBZixHQUF5QjtFQUN6QyxJQUFJLEtBQUtDLFlBQUwsRUFBSixFQUF5QjtJQUN2QixPQUFPLEtBQUtDLGdCQUFMLENBQXNCLE1BQU0sS0FBS0MsV0FBTCxDQUFpQixnQkFBakIsRUFBbUMsRUFBbkMsQ0FBNUIsQ0FBUDtFQUNEOztFQUNELE9BQU8sTUFBTSxLQUFLQyxZQUFMLENBQW1CLGlCQUFuQixFQUFxQyxLQUFyQyxDQUFiO0FBQ0QsQ0FMRDs7QUFrQkFSLFFBQVEsQ0FBQ1MsVUFBVCxHQUFzQixlQUFlQSxVQUFmLENBQTJCQyxPQUEzQixFQUFvQztFQUN4RCxNQUFNQyxVQUFVLEdBQUcsaUJBQW5CO0VBQ0EsTUFBTUMsYUFBYSxHQUFHLG9CQUF0QjtFQUVBLElBQUlDLFFBQUo7RUFDQSxJQUFJQyxNQUFNLEdBQUcsRUFBYjs7RUFDQSxNQUFNQyxjQUFjLEdBQUlDLGNBQUQsSUFBb0I7SUFDekMsSUFBSSxDQUFDQyxhQUFBLENBQUtDLFFBQUwsQ0FBY0YsY0FBZCxDQUFMLEVBQW9DO01BQ2xDSCxRQUFRLEdBQUdGLFVBQVg7SUFDRCxDQUZELE1BRU8sSUFBSSxDQUFDUSxLQUFLLENBQUNILGNBQUQsQ0FBVixFQUE0QjtNQUNqQyxNQUFNSSxRQUFRLEdBQUdDLFVBQVUsQ0FBQ0wsY0FBRCxDQUEzQjs7TUFDQSxJQUFJSSxRQUFRLElBQUksQ0FBaEIsRUFBbUI7UUFDakJOLE1BQU0sR0FBRztVQUFDTTtRQUFELENBQVQ7UUFDQVAsUUFBUSxHQUFHRCxhQUFYO01BQ0QsQ0FIRCxNQUdPO1FBQ0xDLFFBQVEsR0FBR0YsVUFBWDtNQUNEO0lBQ0Y7RUFDRixDQVpEOztFQWFBLElBQUlXLGVBQUEsQ0FBRUMsR0FBRixDQUFNYixPQUFOLEVBQWUsU0FBZixDQUFKLEVBQStCO0lBQzdCLE1BQU07TUFBQ2M7SUFBRCxJQUFZZCxPQUFsQjtJQUNBSyxjQUFjLENBQUNJLEtBQUssQ0FBQ0ssT0FBRCxDQUFMLEdBQWlCQSxPQUFqQixHQUEyQkgsVUFBVSxDQUFDRyxPQUFELENBQVYsR0FBc0IsTUFBbEQsQ0FBZDtFQUNELENBSEQsTUFHTztJQUNMVCxjQUFjLENBQUNMLE9BQUQsQ0FBZDtFQUNEOztFQUNELElBQUksQ0FBQ0csUUFBTCxFQUFlO0lBQ2IsTUFBTSxJQUFJWSxrQkFBQSxDQUFPQyxvQkFBWCxDQUFpQyxtREFBRCxHQUNuQyxHQUFFQyxJQUFJLENBQUNDLFNBQUwsQ0FBZWxCLE9BQWYsQ0FBd0IsNEJBRHZCLENBQU47RUFFRDs7RUFDRCxPQUFPLE1BQU0sS0FBS0YsWUFBTCxDQUFrQkssUUFBbEIsRUFBNEIsTUFBNUIsRUFBb0NDLE1BQXBDLEVBQTRDRCxRQUFRLEtBQUtGLFVBQXpELENBQWI7QUFDRCxDQTlCRDs7QUFnQ0FYLFFBQVEsQ0FBQzZCLE9BQVQsR0FBbUIsZUFBZUEsT0FBZixDQUF3QkMsS0FBSyxHQUFHLElBQWhDLEVBQXNDO0VBQ3ZELE1BQU0sS0FBS0Msd0JBQUwsQ0FBOEI7SUFBQ0Q7RUFBRCxDQUE5QixDQUFOO0FBQ0QsQ0FGRDs7QUFJQTlCLFFBQVEsQ0FBQ2dDLG1CQUFULEdBQStCLGVBQWVBLG1CQUFmLENBQW9DQyxTQUFTLEdBQUcsSUFBaEQsRUFBc0Q7RUFDbkYsTUFBTSxLQUFLQyxxQkFBTCxDQUEyQjtJQUFDRDtFQUFELENBQTNCLENBQU47QUFDRCxDQUZEOztBQUlBaEMsT0FBTyxDQUFDa0MsZ0JBQVIsR0FBMkIsZUFBZUEsZ0JBQWYsR0FBbUM7RUFDNUQsT0FBTyxNQUFNLEtBQUs1QixXQUFMLENBQWlCLGlCQUFqQixFQUFvQyxFQUFwQyxDQUFiO0FBQ0QsQ0FGRDs7QUFJQU4sT0FBTyxDQUFDbUMsbUJBQVIsR0FBOEIsZUFBZUEsbUJBQWYsR0FBc0M7RUFDbEUsT0FBTyxNQUFNLEtBQUs1QixZQUFMLENBQW1CLGNBQW5CLEVBQWtDLEtBQWxDLENBQWI7QUFDRCxDQUZEOztBQUlBUixRQUFRLENBQUNxQyxhQUFULEdBQXlCLGVBQWVBLGFBQWYsQ0FBOEJDLFlBQVksR0FBRyxTQUE3QyxFQUF3RDtFQUMvRSxJQUFJQSxZQUFZLEtBQUssU0FBckIsRUFBZ0M7SUFDOUIsTUFBTSxJQUFJYixrQkFBQSxDQUFPYyxzQkFBWCxDQUFrQywwREFBbEMsQ0FBTjtFQUNEOztFQUVELElBQUksQ0FBQyxLQUFLbEMsWUFBTCxFQUFMLEVBQTBCO0lBQ3hCLE9BQU8sTUFBTSxLQUFLK0IsbUJBQUwsRUFBYjtFQUNELENBRkQsTUFFTztJQUNMLE9BQU8sTUFBTSxLQUFLRCxnQkFBTCxFQUFiO0VBQ0Q7QUFDRixDQVZEOztBQXFCQW5DLFFBQVEsQ0FBQ3dDLGFBQVQsR0FBeUIsZUFBZUEsYUFBZixDQUE4QkMsTUFBTSxHQUFHdEMscUJBQXZDLEVBQThEO0VBQ3JGLEtBQUt1QyxHQUFMLENBQVNDLElBQVQsQ0FBYyxnREFBZDs7RUFDQSxJQUFJLENBQUMsS0FBS0MsWUFBTCxFQUFMLEVBQTBCO0lBQ3hCLEtBQUtGLEdBQUwsQ0FBU0MsSUFBVCxDQUFjLDZEQUFkO0lBQ0EsTUFBTUUsR0FBRyxHQUFHLE1BQVo7SUFDQSxNQUFNQyxJQUFJLEdBQUcsQ0FBQyxzQkFBRCxDQUFiO0lBQ0EsTUFBTUMsV0FBVyxHQUFHLHVCQUFwQjtJQUNBLE1BQU1DLE1BQU0sR0FBRyxDQUFDLE1BQU0sSUFBQUMsa0JBQUEsRUFBS0osR0FBTCxFQUFVQyxJQUFWLENBQVAsRUFBd0JFLE1BQXhCLENBQStCRSxJQUEvQixFQUFmO0lBQ0EsS0FBS1IsR0FBTCxDQUFTUyxLQUFULENBQWdCLG9DQUFtQ04sR0FBSSxJQUFHQyxJQUFJLENBQUNNLElBQUwsQ0FBVSxHQUFWLENBQWUsTUFBS0osTUFBTyxFQUFyRjs7SUFDQSxNQUFNSyxlQUFlLEdBQUdDLHVCQUFBLENBQU9DLEdBQVAsQ0FBV1AsTUFBWCxFQUFtQkQsV0FBbkIsQ0FBeEI7O0lBQ0EsSUFBSSxDQUFDTSxlQUFlLENBQUNHLE9BQWhCLEVBQUwsRUFBZ0M7TUFDOUIsS0FBS2QsR0FBTCxDQUFTZSxJQUFULENBQWUsK0JBQThCVCxNQUFPLGtCQUFpQkgsR0FBSSwrQkFBekU7TUFDQSxPQUFPRyxNQUFQO0lBQ0Q7O0lBQ0QsT0FBT0ssZUFBZSxDQUFDSyxTQUFoQixDQUEwQkwsZUFBZSxDQUFDTSxJQUFoQixJQUF3QixDQUFsRCxFQUFxRGxCLE1BQXJELENBQTREQSxNQUE1RCxDQUFQO0VBQ0Q7O0VBRUQsTUFBTTtJQUNKbUIsU0FESTtJQUVKRixTQUZJO0lBR0pHO0VBSEksSUFJRixNQUFNQywwQkFBQSxDQUFVdEIsYUFBVixDQUF3QixLQUFLdUIsSUFBTCxDQUFVQyxJQUFsQyxDQUpWO0VBS0EsS0FBS3RCLEdBQUwsQ0FBU1MsS0FBVCxDQUFnQixjQUFhUyxTQUFVLGdCQUFlRixTQUFVLGVBQWNHLFFBQVMsRUFBdkY7O0VBQ0EsTUFBTU4sR0FBRyxHQUFHRCx1QkFBQSxDQUFPVyxJQUFQLENBQVlMLFNBQVosRUFBdUJMLEdBQXZCLEVBQVo7O0VBR0EsSUFBSVcsSUFBSSxDQUFDQyxHQUFMLENBQVNULFNBQVQsS0FBdUIsS0FBSyxFQUFoQyxFQUFvQztJQUNsQyxPQUFPSCxHQUFHLENBQUNHLFNBQUosQ0FBY0EsU0FBZCxFQUF5QmpCLE1BQXpCLENBQWdDQSxNQUFoQyxDQUFQO0VBQ0Q7O0VBR0QsSUFBSW5CLGVBQUEsQ0FBRThDLFFBQUYsQ0FBV1AsUUFBWCxFQUFxQixHQUFyQixDQUFKLEVBQStCO0lBQzdCLE9BQU9OLEdBQUcsQ0FBQ2MsRUFBSixDQUFPUixRQUFQLEVBQWlCcEIsTUFBakIsQ0FBd0JBLE1BQXhCLENBQVA7RUFDRDs7RUFDRCxJQUFJeUIsSUFBSSxDQUFDQyxHQUFMLENBQVNOLFFBQVQsS0FBc0IsS0FBSyxFQUFMLEdBQVUsRUFBcEMsRUFBd0M7SUFDdEMsT0FBT04sR0FBRyxDQUFDRyxTQUFKLENBQWNHLFFBQVEsR0FBRyxFQUF6QixFQUE2QnBCLE1BQTdCLENBQW9DQSxNQUFwQyxDQUFQO0VBQ0Q7O0VBQ0QsS0FBS0MsR0FBTCxDQUFTZSxJQUFULENBQWMsOEVBQWQ7RUFDQSxPQUFPRixHQUFHLENBQUNkLE1BQUosQ0FBV0EsTUFBWCxDQUFQO0FBQ0QsQ0F2Q0Q7O0FBb0RBekMsUUFBUSxDQUFDc0UsbUJBQVQsR0FBK0IsZUFBZUEsbUJBQWYsQ0FBb0NQLElBQUksR0FBRyxFQUEzQyxFQUErQztFQUM1RSxPQUFPLE1BQU0sS0FBS3ZCLGFBQUwsQ0FBbUJ1QixJQUFJLENBQUN0QixNQUF4QixDQUFiO0FBQ0QsQ0FGRDs7QUFLQXpDLFFBQVEsQ0FBQ3VFLGFBQVQsR0FBeUIsZUFBZUEsYUFBZixHQUFnQztFQUN2RCxNQUFNO0lBQUNDLEtBQUQ7SUFBUUM7RUFBUixJQUFrQixNQUFNLEtBQUtwQyxhQUFMLEVBQTlCO0VBQ0EsT0FBTztJQUNMbUMsS0FESztJQUVMQyxNQUZLO0lBR0xDLENBQUMsRUFBRSxDQUhFO0lBSUxDLENBQUMsRUFBRTtFQUpFLENBQVA7QUFNRCxDQVJEOztBQVVBM0UsUUFBUSxDQUFDNEUsWUFBVCxHQUF3QixlQUFlQSxZQUFmLENBQTZCQyxRQUE3QixFQUF1QyxHQUFHQyxZQUExQyxFQUF3RDtFQUU5RSxNQUFNQyxRQUFRLEdBQUd6RCxlQUFBLENBQUUwRCxPQUFGLENBQVVGLFlBQVksQ0FBQ0csS0FBYixDQUFtQixDQUFuQixFQUFzQixDQUFDLENBQXZCLENBQVYsRUFBcUNDLEdBQXJDLENBQTBDUixDQUFELElBQVEsR0FBRUEsQ0FBRSxFQUFyRCxDQUFqQjs7RUFDQSxJQUFJLENBQUNLLFFBQVEsQ0FBQ1gsUUFBVCxDQUFrQixNQUFsQixDQUFMLEVBQWdDO0lBQzlCVyxRQUFRLENBQUNJLElBQVQsQ0FBYyxNQUFkO0VBQ0Q7O0VBQ0QsTUFBTSxLQUFLM0UsWUFBTCxDQUFrQix1QkFBbEIsRUFBMkMsTUFBM0MsRUFBbUQ7SUFBQ3VFO0VBQUQsQ0FBbkQsQ0FBTjtBQUNELENBUEQ7O0FBU0EvRSxRQUFRLENBQUNvRixVQUFULEdBQXNCLGVBQWVBLFVBQWYsQ0FBMkJDLFFBQTNCLEVBQXFDQyxVQUFVLEdBQUcsSUFBbEQsRUFBd0Q7RUFDNUUsS0FBSzVDLEdBQUwsQ0FBU1MsS0FBVCxDQUFnQixrQ0FBaUNrQyxRQUFTLHNCQUFxQkMsVUFBVyxHQUExRjtFQUNBLE9BQU8sTUFBTSxJQUFBQyxpQ0FBQSxFQUF3QkMsTUFBTSxDQUFDQyxNQUFQLENBQWMsRUFBZCxFQUFrQixLQUFLMUIsSUFBdkIsRUFBNkI7SUFDaEVzQixRQURnRTtJQUVoRUMsVUFGZ0U7SUFHaEVJLFVBQVUsRUFBRTtFQUhvRCxDQUE3QixDQUF4QixDQUFiO0FBS0QsQ0FQRDs7QUFTQTFGLFFBQVEsQ0FBQzJGLFNBQVQsR0FBcUIsZUFBZUEsU0FBZixDQUEwQkMsUUFBMUIsRUFBb0M7RUFDdkQsT0FBTyxNQUFNLEtBQUtDLGVBQUwsQ0FBcUI7SUFBQ0Q7RUFBRCxDQUFyQixDQUFiO0FBQ0QsQ0FGRDs7QUFJQTVGLFFBQVEsQ0FBQzhGLFNBQVQsR0FBcUIsZUFBZUEsU0FBZixHQUE0QjtFQUMvQyxNQUFNQyxPQUFPLEdBQUcsS0FBS2hDLElBQUwsQ0FBVWlDLEdBQVYsSUFBaUIsS0FBS2pDLElBQUwsQ0FBVTZCLFFBQTNDOztFQUNBLElBQUk7SUFDRixNQUFNLEtBQUtLLEtBQUwsRUFBTjtJQUNBLEtBQUt2RCxHQUFMLENBQVNDLElBQVQsQ0FBZSw4QkFBNkJvRCxPQUFRLFFBQXBEO0VBQ0QsQ0FIRCxDQUdFLE9BQU9HLEdBQVAsRUFBWTtJQUNaLEtBQUt4RCxHQUFMLENBQVNlLElBQVQsQ0FBZSw2Q0FBNENzQyxPQUFRLFFBQW5FO0lBQ0EsTUFBTUcsR0FBTjtFQUNEO0FBQ0YsQ0FURDs7QUFXQWxHLFFBQVEsQ0FBQ21HLFFBQVQsR0FBb0IsZUFBZUEsUUFBZixHQUEyQjtFQUM3QyxNQUFNSixPQUFPLEdBQUcsS0FBS2hDLElBQUwsQ0FBVWlDLEdBQVYsSUFBaUIsS0FBS2pDLElBQUwsQ0FBVTZCLFFBQTNDOztFQUNBLElBQUk7SUFDRixNQUFNLEtBQUtRLElBQUwsRUFBTjtJQUNBLEtBQUsxRCxHQUFMLENBQVNDLElBQVQsQ0FBZSw0QkFBMkJvRCxPQUFRLFFBQWxEO0VBQ0QsQ0FIRCxDQUdFLE9BQU9HLEdBQVAsRUFBWTtJQUNaLEtBQUt4RCxHQUFMLENBQVNlLElBQVQsQ0FBZSwyQ0FBMENzQyxPQUFRLFFBQWpFO0lBQ0EsTUFBTUcsR0FBTjtFQUNEO0FBQ0YsQ0FURDs7QUFXQWxHLFFBQVEsQ0FBQ3FHLElBQVQsR0FBZ0IsZUFBZUEsSUFBZixDQUFxQkEsSUFBckIsRUFBMkI7RUFDekMsSUFBSSxDQUFDLEtBQUtoRyxZQUFMLEVBQUwsRUFBMEI7SUFDeEIsTUFBTSxJQUFJb0Isa0JBQUEsQ0FBTzZFLFlBQVgsQ0FBd0Isa0NBQXhCLENBQU47RUFDRDs7RUFDRCxJQUFJQyxFQUFFLEdBQUd0RixhQUFBLENBQUt1RixhQUFMLENBQW1CLE1BQU0sS0FBS3BHLE1BQUwsRUFBekIsQ0FBVDs7RUFDQSxJQUFJa0IsZUFBQSxDQUFFbUYsT0FBRixDQUFVRixFQUFWLENBQUosRUFBbUI7SUFDakIsTUFBTSxJQUFJOUUsa0JBQUEsQ0FBT2lGLGtCQUFYLEVBQU47RUFDRDs7RUFDRCxNQUFNLEtBQUtDLFFBQUwsQ0FBY04sSUFBZCxFQUFvQkUsRUFBcEIsQ0FBTjtBQUNELENBVEQ7O0FBV0F2RyxRQUFRLENBQUM0RyxNQUFULEdBQWtCLGVBQWVBLE1BQWYsQ0FBdUJDLEdBQXZCLEVBQTRCO0VBQzVDLEtBQUtuRSxHQUFMLENBQVNTLEtBQVQsQ0FBZ0IsMEJBQXlCMEQsR0FBSSxHQUE3Qzs7RUFFQSxJQUFJLEtBQUt4RyxZQUFMLEVBQUosRUFBeUI7SUFDdkIsS0FBS3lHLGFBQUwsQ0FBbUJELEdBQW5CO0lBRUEsS0FBS0UsWUFBTCxHQUFvQixFQUFwQjtJQUNBLE1BQU0sS0FBS0MsTUFBTCxDQUFZQyxRQUFaLENBQXFCSixHQUFyQixDQUFOO0lBQ0E7RUFDRDs7RUFFRCxJQUFJLEtBQUtqRSxZQUFMLEVBQUosRUFBeUI7SUFDdkIsTUFBTSxLQUFLcEMsWUFBTCxDQUFrQixNQUFsQixFQUEwQixNQUExQixFQUFrQztNQUFDcUc7SUFBRCxDQUFsQyxDQUFOO0VBQ0QsQ0FGRCxNQUVPO0lBQ0wsTUFBTSxLQUFLOUMsSUFBTCxDQUFVbUQsTUFBVixDQUFpQkMsTUFBakIsQ0FBd0JDLE9BQXhCLENBQWdDUCxHQUFoQyxDQUFOO0VBQ0Q7QUFDRixDQWhCRDs7QUFrQkE3RyxRQUFRLENBQUNxSCxlQUFULEdBQTJCLGVBQWVBLGVBQWYsR0FBa0M7RUFDM0QsTUFBTUMsS0FBSyxHQUFHLE1BQU0sS0FBS0MsbUJBQUwsRUFBcEI7RUFFQSxNQUFNQyxlQUFlLEdBQUd0RCxJQUFJLENBQUN1RCxLQUFMLENBQVcsT0FBTSxLQUFLQyxrQkFBTCxFQUFOLElBQWtDSixLQUE3QyxDQUF4QjtFQUNBLE1BQU1LLFVBQVUsR0FBRyxNQUFNLEtBQUt0RixhQUFMLEVBQXpCO0VBSUEsT0FBTztJQUNMdUYsSUFBSSxFQUFFLENBREQ7SUFFTEMsR0FBRyxFQUFFTCxlQUZBO0lBR0xoRCxLQUFLLEVBQUVtRCxVQUFVLENBQUNuRCxLQUFYLEdBQW1COEMsS0FIckI7SUFJTDdDLE1BQU0sRUFBSWtELFVBQVUsQ0FBQ2xELE1BQVgsR0FBb0I2QyxLQUFyQixHQUE4QkU7RUFKbEMsQ0FBUDtBQU1ELENBZEQ7O0FBaUJBeEgsUUFBUSxDQUFDOEgsYUFBVCxHQUF5QixlQUFlQSxhQUFmLEdBQWdDO0VBQ3ZELE9BQU8sTUFBTSxLQUFLdEgsWUFBTCxDQUFrQixhQUFsQixFQUFpQyxLQUFqQyxDQUFiO0FBQ0QsQ0FGRDs7QUFJQVIsUUFBUSxDQUFDMEgsa0JBQVQsR0FBOEIsZUFBZUEsa0JBQWYsR0FBcUM7RUFDakUsTUFBTTtJQUFDSztFQUFELElBQWtCLE1BQU0sS0FBS0QsYUFBTCxFQUE5QjtFQUNBLE9BQU9DLGFBQWEsQ0FBQ3RELE1BQXJCO0FBQ0QsQ0FIRDs7QUFNQXpFLFFBQVEsQ0FBQ3VILG1CQUFULEdBQStCLGVBQWVBLG1CQUFmLEdBQXNDO0VBQ25FLE1BQU07SUFBQ0Q7RUFBRCxJQUFVLE1BQU0sS0FBS1EsYUFBTCxFQUF0QjtFQUNBLE9BQU9SLEtBQVA7QUFDRCxDQUhEOztBQWdCQXRILFFBQVEsQ0FBQ2dJLGlCQUFULEdBQTZCLGVBQWVBLGlCQUFmLENBQWtDakUsSUFBSSxHQUFHLEVBQXpDLEVBQTZDO0VBQ3hFLE1BQU07SUFBQ2tFLElBQUQ7SUFBT0M7RUFBUCxJQUEwQm5FLElBQWhDOztFQUNBLElBQUksQ0FBQ2tFLElBQUwsRUFBVztJQUNULE1BQU0sSUFBSXhHLGtCQUFBLENBQU9DLG9CQUFYLENBQWdDLDBCQUFoQyxDQUFOO0VBQ0Q7O0VBQ0QsSUFBSSxDQUFDSixlQUFBLENBQUU2RyxLQUFGLENBQVFELGVBQVIsQ0FBRCxJQUE2QixDQUFDNUcsZUFBQSxDQUFFOEcsUUFBRixDQUFXRixlQUFYLENBQWxDLEVBQStEO0lBQzdELE1BQU0sSUFBSXpHLGtCQUFBLENBQU9DLG9CQUFYLENBQWdDLG9DQUFoQyxDQUFOO0VBQ0Q7O0VBQ0QsT0FBTyxNQUFNLEtBQUtsQixZQUFMLENBQWtCLGtCQUFsQixFQUFzQyxNQUF0QyxFQUNYO0lBQUN5SCxJQUFEO0lBQU83RyxRQUFRLEVBQUU4RztFQUFqQixDQURXLENBQWI7QUFFRCxDQVZEOztBQVlBbEksUUFBUSxDQUFDcUksaUJBQVQsR0FBNkIsZUFBZUEsaUJBQWYsQ0FBa0N0RSxJQUFJLEdBQUcsRUFBekMsRUFBNkM7RUFDeEUsTUFBTTtJQUFDdUU7RUFBRCxJQUFTdkUsSUFBZjs7RUFDQSxJQUFJLENBQUM5QyxhQUFBLENBQUtDLFFBQUwsQ0FBY29ILElBQWQsQ0FBTCxFQUEwQjtJQUN4QixNQUFNLElBQUk3RyxrQkFBQSxDQUFPQyxvQkFBWCxDQUFnQyw4QkFBaEMsQ0FBTjtFQUNEOztFQUNELE9BQU8sTUFBTSxLQUFLbEIsWUFBTCxDQUFrQixvQkFBbEIsRUFBd0MsTUFBeEMsRUFBZ0Q7SUFBQzhIO0VBQUQsQ0FBaEQsQ0FBYjtBQUNELENBTkQ7O0FBUUE5QyxNQUFNLENBQUNDLE1BQVAsQ0FBY3ZGLFVBQWQsRUFBMEJGLFFBQTFCLEVBQW9DQyxPQUFwQztlQUdlQyxVIn0=
