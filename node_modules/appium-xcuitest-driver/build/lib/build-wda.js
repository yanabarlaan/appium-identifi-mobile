"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("source-map-support/register");

var _appiumWebdriveragent = require("appium-webdriveragent");

var _utils = require("./utils");

var _simulatorManagement = require("./simulator-management");

var _asyncbox = require("asyncbox");

const DEFAULT_SIM_NAME = 'iPhone 12';

async function build() {
  const xcodeVersion = await (0, _utils.getAndCheckXcodeVersion)();
  const iosVersion = await (0, _utils.getAndCheckIosSdkVersion)();
  const deviceName = (0, _utils.translateDeviceName)(iosVersion, DEFAULT_SIM_NAME);
  const device = await (0, _simulatorManagement.getExistingSim)({
    platformVersion: iosVersion,
    deviceName
  });
  const wda = new _appiumWebdriveragent.WebDriverAgent(xcodeVersion, {
    iosSdkVersion: iosVersion,
    platformVersion: iosVersion,
    showXcodeLog: true,
    device
  });
  await wda.xcodebuild.start(true);
}

if (require.main === module) {
  (0, _asyncbox.asyncify)(build);
}

var _default = build;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGliL2J1aWxkLXdkYS5qcyIsIm5hbWVzIjpbIkRFRkFVTFRfU0lNX05BTUUiLCJidWlsZCIsInhjb2RlVmVyc2lvbiIsImdldEFuZENoZWNrWGNvZGVWZXJzaW9uIiwiaW9zVmVyc2lvbiIsImdldEFuZENoZWNrSW9zU2RrVmVyc2lvbiIsImRldmljZU5hbWUiLCJ0cmFuc2xhdGVEZXZpY2VOYW1lIiwiZGV2aWNlIiwiZ2V0RXhpc3RpbmdTaW0iLCJwbGF0Zm9ybVZlcnNpb24iLCJ3ZGEiLCJXZWJEcml2ZXJBZ2VudCIsImlvc1Nka1ZlcnNpb24iLCJzaG93WGNvZGVMb2ciLCJ4Y29kZWJ1aWxkIiwic3RhcnQiLCJyZXF1aXJlIiwibWFpbiIsIm1vZHVsZSIsImFzeW5jaWZ5Il0sInNvdXJjZVJvb3QiOiIuLi8uLiIsInNvdXJjZXMiOlsibGliL2J1aWxkLXdkYS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBXZWJEcml2ZXJBZ2VudCB9IGZyb20gJ2FwcGl1bS13ZWJkcml2ZXJhZ2VudCc7XG5pbXBvcnQgeyB0cmFuc2xhdGVEZXZpY2VOYW1lLCBnZXRBbmRDaGVja1hjb2RlVmVyc2lvbiwgZ2V0QW5kQ2hlY2tJb3NTZGtWZXJzaW9uIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyBnZXRFeGlzdGluZ1NpbSB9IGZyb20gJy4vc2ltdWxhdG9yLW1hbmFnZW1lbnQnO1xuaW1wb3J0IHsgYXN5bmNpZnkgfSBmcm9tICdhc3luY2JveCc7XG5cbmNvbnN0IERFRkFVTFRfU0lNX05BTUUgPSAnaVBob25lIDEyJztcblxuLy8gVE9ETzogYWxsb3cgcGFzc2luZyBpbiBhbGwgdGhlIHZhcmlvdXMgYnVpbGQgcGFyYW1zIGFzIENMSSBhcmdzXG5hc3luYyBmdW5jdGlvbiBidWlsZCAoKSB7XG4gIGNvbnN0IHhjb2RlVmVyc2lvbiA9IGF3YWl0IGdldEFuZENoZWNrWGNvZGVWZXJzaW9uKCk7XG4gIGNvbnN0IGlvc1ZlcnNpb24gPSBhd2FpdCBnZXRBbmRDaGVja0lvc1Nka1ZlcnNpb24oKTtcbiAgY29uc3QgZGV2aWNlTmFtZSA9IHRyYW5zbGF0ZURldmljZU5hbWUoaW9zVmVyc2lvbiwgREVGQVVMVF9TSU1fTkFNRSk7XG4gIGNvbnN0IGRldmljZSA9IGF3YWl0IGdldEV4aXN0aW5nU2ltKHtcbiAgICBwbGF0Zm9ybVZlcnNpb246IGlvc1ZlcnNpb24sXG4gICAgZGV2aWNlTmFtZVxuICB9KTtcbiAgY29uc3Qgd2RhID0gbmV3IFdlYkRyaXZlckFnZW50KHhjb2RlVmVyc2lvbiwge1xuICAgIGlvc1Nka1ZlcnNpb246IGlvc1ZlcnNpb24sXG4gICAgcGxhdGZvcm1WZXJzaW9uOiBpb3NWZXJzaW9uLFxuICAgIHNob3dYY29kZUxvZzogdHJ1ZSxcbiAgICBkZXZpY2UsXG4gIH0pO1xuICBhd2FpdCB3ZGEueGNvZGVidWlsZC5zdGFydCh0cnVlKTtcbn1cblxuaWYgKHJlcXVpcmUubWFpbiA9PT0gbW9kdWxlKSB7XG4gIGFzeW5jaWZ5KGJ1aWxkKTtcbn1cblxuZXhwb3J0IGRlZmF1bHQgYnVpbGQ7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUVBLE1BQU1BLGdCQUFnQixHQUFHLFdBQXpCOztBQUdBLGVBQWVDLEtBQWYsR0FBd0I7RUFDdEIsTUFBTUMsWUFBWSxHQUFHLE1BQU0sSUFBQUMsOEJBQUEsR0FBM0I7RUFDQSxNQUFNQyxVQUFVLEdBQUcsTUFBTSxJQUFBQywrQkFBQSxHQUF6QjtFQUNBLE1BQU1DLFVBQVUsR0FBRyxJQUFBQywwQkFBQSxFQUFvQkgsVUFBcEIsRUFBZ0NKLGdCQUFoQyxDQUFuQjtFQUNBLE1BQU1RLE1BQU0sR0FBRyxNQUFNLElBQUFDLG1DQUFBLEVBQWU7SUFDbENDLGVBQWUsRUFBRU4sVUFEaUI7SUFFbENFO0VBRmtDLENBQWYsQ0FBckI7RUFJQSxNQUFNSyxHQUFHLEdBQUcsSUFBSUMsb0NBQUosQ0FBbUJWLFlBQW5CLEVBQWlDO0lBQzNDVyxhQUFhLEVBQUVULFVBRDRCO0lBRTNDTSxlQUFlLEVBQUVOLFVBRjBCO0lBRzNDVSxZQUFZLEVBQUUsSUFINkI7SUFJM0NOO0VBSjJDLENBQWpDLENBQVo7RUFNQSxNQUFNRyxHQUFHLENBQUNJLFVBQUosQ0FBZUMsS0FBZixDQUFxQixJQUFyQixDQUFOO0FBQ0Q7O0FBRUQsSUFBSUMsT0FBTyxDQUFDQyxJQUFSLEtBQWlCQyxNQUFyQixFQUE2QjtFQUMzQixJQUFBQyxrQkFBQSxFQUFTbkIsS0FBVDtBQUNEOztlQUVjQSxLIn0=
